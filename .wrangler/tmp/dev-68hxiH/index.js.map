{
  "version": 3,
  "sources": ["../../../src/helpers.js", "../../../src/dataSources/newsAggregator.js", "../../../src/chatapi.js", "../../../src/dataSources/github-trending.js", "../../../src/dataSources/papers.js", "../../../src/dataSources/twitter.js", "../../../src/dataSources/reddit.js", "../../../src/dataFetchers.js", "../../../src/kv.js", "../../../src/handlers/writeData.js", "../../../src/handlers/getContent.js", "../../../src/marked.esm.js", "../../../src/htmlGenerators.js", "../../../src/handlers/getContentHtml.js", "../../../src/prompt/summarizationPromptStepZero.js", "../../../src/prompt/summarizationPromptStepThree.js", "../../../src/prompt/podcastFormattingPrompt.js", "../../../src/prompt/dailyAnalysisPrompt.js", "../../../src/foot.js", "../../../src/ad.js", "../../../src/github.js", "../../../src/handlers/genAIContent.js", "../../../src/handlers/genAIDailyPage.js", "../../../src/handlers/commitToGitHub.js", "../../../src/handlers/getRss.js", "../../../src/prompt/summarizationSimplifyPrompt.js", "../../../src/appUrl.js", "../../../src/handlers/writeRssData.js", "../../../src/auth.js", "../../../src/index.js", "file:///C:/Users/%E5%93%87%E5%93%88%E5%93%88/AppData/Roaming/npm/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "file:///C:/Users/%E5%93%87%E5%93%88%E5%93%88/AppData/Roaming/npm/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-kIio6R/middleware-insertion-facade.js", "file:///C:/Users/%E5%93%87%E5%93%88%E5%93%88/AppData/Roaming/npm/node_modules/wrangler/templates/middleware/common.ts", "../bundle-kIio6R/middleware-loader.entry.ts"],
  "sourceRoot": "E:\\IdeaProjects\\CloudFlare-AI-Insight-Daily\\.wrangler\\tmp\\dev-68hxiH",
  "sourcesContent": ["// src/helpers.js\r\n\r\n/**\r\n * \u5168\u57DF\u53C3\u6578\uFF0C\u7528\u65BC\u6307\u5B9A\u8CC7\u6599\u6293\u53D6\u7684\u65E5\u671F\u3002\r\n * \u9810\u8A2D\u70BA\u7576\u524D\u65E5\u671F\uFF0C\u683C\u5F0F\u70BA YYYY-MM-DD\u3002\r\n */\r\nexport let fetchDate = getISODate();\r\n\r\nexport function setFetchDate(date) {\r\n    fetchDate = date;\r\n}\r\n\r\nexport function getFetchDate() {\r\n    return fetchDate;\r\n}\r\n\r\n/**\r\n * Gets the current date or a specified date in YYYY-MM-DD format.\r\n * @param {Date} [dateObj] - Optional Date object. Defaults to current date.\r\n * @returns {string} Date string in YYYY-MM-DD format.\r\n */\r\nexport function getISODate(dateObj = new Date()) {\r\n    const options = {\r\n        year: 'numeric',\r\n        month: '2-digit',\r\n        day: '2-digit',\r\n        timeZone: 'Asia/Shanghai'\r\n    };\r\n    // \u4F7F\u7528 'en-CA' \u8A9E\u8A00\u74B0\u5883\uFF0C\u56E0\u70BA\u5B83\u901A\u5E38\u6703\u7522\u751F YYYY-MM-DD \u683C\u5F0F\u7684\u65E5\u671F\u5B57\u4E32\r\n    const dateString = dateObj.toLocaleDateString('en-CA', options);\r\n    return dateString;\r\n}\r\n\r\n/**\r\n * Escapes HTML special characters in a string.\r\n * @param {*} unsafe The input to escape. If not a string, it's converted. Null/undefined become empty string.\r\n * @returns {string} The escaped string.\r\n */\r\nexport function escapeHtml(unsafe) {\r\n    if (unsafe === null || typeof unsafe === 'undefined') {\r\n        return '';\r\n    }\r\n    const str = String(unsafe);\r\n    const map = {\r\n        '&': '&',\r\n        '<': '<',\r\n        '>': '>',\r\n        '\"': '\"',\r\n        \"'\": '&#039;'\r\n    };\r\n    return str.replace(/[&<>\"']/g, (m) => map[m]);\r\n}\r\n\r\n/**\r\n * Generic fetch wrapper with JSON parsing and error handling.\r\n * @param {string} url - The URL to fetch.\r\n * @param {object} [options] - Fetch options.\r\n * @returns {Promise<object>} The JSON response or text for non-JSON.\r\n * @throws {Error} If the fetch fails or response is not ok.\r\n */\r\nexport async function fetchData(url, options = {}) {\r\n    const response = await fetch(url, options);\r\n    if (!response.ok) {\r\n        const errorText = await response.text();\r\n        throw new Error(`HTTP error! status: ${response.status}, message: ${errorText}, url: ${url}`);\r\n    }\r\n    return response.json();\r\n}\r\n\r\n/**\r\n * Removes markdown code block fences (```json or ```) from a string.\r\n * @param {string} text - The input string potentially containing markdown code fences.\r\n * @returns {string} The string with markdown code fences removed.\r\n */\r\nexport function removeMarkdownCodeBlock(text) {\r\n    if (!text) return '';\r\n    let cleanedText = text.trim();\r\n\r\n    const jsonFence = \"```json\";\r\n    const genericFence = \"```\";\r\n\r\n    if (cleanedText.startsWith(jsonFence)) {\r\n        cleanedText = cleanedText.substring(jsonFence.length);\r\n    } else if (cleanedText.startsWith(genericFence)) {\r\n        cleanedText = cleanedText.substring(genericFence.length);\r\n    }\r\n\r\n    if (cleanedText.endsWith(genericFence)) {\r\n        cleanedText = cleanedText.substring(0, cleanedText.length - genericFence.length);\r\n    }\r\n    return cleanedText.trim();\r\n}\r\n\r\n/**\r\n * Strips HTML tags from a string and normalizes whitespace.\r\n * @param {string} html - The HTML string.\r\n * @returns {string} The text content without HTML tags.\r\n */\r\nexport function stripHtml(html) {\r\n    if (!html) return \"\";\r\n\r\n    // \u8655\u7406 img \u6A19\u7C64\uFF0C\u4FDD\u7559\u5176 src \u548C alt \u5C6C\u6027\r\n    let processedHtml = html.replace(/<img[^>]*src=\"([^\"]*)\"[^>]*alt=\"([^\"]*)\"[^>]*>/gi, (match, src, alt) => {\r\n        return alt ? `[\u56FE\u7247: ${alt} ${src}]` : `[\u56FE\u7247: ${src}]`;\r\n    });\r\n    processedHtml = processedHtml.replace(/<img[^>]*src=\"([^\"]*)\"[^>]*>/gi, '[\u56FE\u7247: $1]');\r\n\r\n    // \u5904\u7406 video \u6807\u7B7E\uFF0C\u4FDD\u7559\u5176 src \u5C5E\u6027\r\n    processedHtml = processedHtml.replace(/<video[^>]*src=\"([^\"]*)\"[^>]*>.*?<\\/video>/gi, '[\u89C6\u9891: $1]');\r\n\r\n    // \u79FB\u9664\u6240\u6709\u5176\u4ED6 HTML \u6807\u7B7E\uFF0C\u5E76\u89C4\u8303\u5316\u7A7A\u767D\r\n    return processedHtml.replace(/<[^>]+>/g, ' ').replace(/\\s+/g, ' ').trim();\r\n}\r\n\r\n/**\r\n * Checks if a given date string is within the last specified number of days (inclusive of today).\r\n * @param {string} dateString - The date string to check (YYYY-MM-DD).\r\n * @param {number} days - The number of days to look back (e.g., 3 for today and the past 2 days).\r\n * @returns {boolean} True if the date is within the last 'days', false otherwise.\r\n */\r\n/**\r\n * Converts a date string to a Date object representing the time in Asia/Shanghai timezone.\r\n * This is crucial for consistent date comparisons across different environments.\r\n * @param {string} dateString - The date string to convert.\r\n * @returns {Date} A Date object set to the specified date in Asia/Shanghai timezone.\r\n */\r\nexport function convertToShanghaiTime(dateString) {\r\n    // Create a Date object from the ISO string.\r\n    const date = new Date(dateString);\r\n\r\n    // Get the date components in Asia/Shanghai timezone\r\n    const options = {\r\n        year: 'numeric',\r\n        month: 'numeric',\r\n        day: 'numeric',\r\n        hour: 'numeric',\r\n        minute: 'numeric',\r\n        second: 'numeric',\r\n        hour12: false,\r\n        timeZone: 'Asia/Shanghai'\r\n    };\r\n\r\n    // Format the date to a string in Shanghai timezone, then parse it back to a Date object.\r\n    // This is a common workaround to get a Date object representing a specific timezone.\r\n    const shanghaiDateString = new Intl.DateTimeFormat('en-US', options).format(date);\r\n    return new Date(shanghaiDateString);\r\n}\r\n\r\nexport function getShanghaiTime() {\r\n    // Create a Date object from the ISO string.\r\n    const date = new Date();\r\n\r\n    // Get the date components in Asia/Shanghai timezone\r\n    const options = {\r\n        year: 'numeric',\r\n        month: 'numeric',\r\n        day: 'numeric',\r\n        hour: 'numeric',\r\n        minute: 'numeric',\r\n        second: 'numeric',\r\n        hour12: false,\r\n        timeZone: 'Asia/Shanghai'\r\n    };\r\n\r\n    // Format the date to a string in Shanghai timezone, then parse it back to a Date object.\r\n    // This is a common workaround to get a Date object representing a specific timezone.\r\n    const shanghaiDateString = new Intl.DateTimeFormat('en-US', options).format(date);\r\n    return new Date(shanghaiDateString);\r\n}\r\n\r\n/**\r\n * Checks if a given date string is within the last specified number of days (inclusive of today).\r\n * @param {string} dateString - The date string to check (YYYY-MM-DD or ISO format).\r\n * @param {number} days - The number of days to look back (e.g., 3 for today and the past 2 days).\r\n * @returns {boolean} True if the date is within the last 'days', false otherwise.\r\n */\r\nexport function isDateWithinLastDays(dateString, days) {\r\n    // Convert both dates to Shanghai time for consistent comparison\r\n    const itemDate = convertToShanghaiTime(dateString);\r\n    const today = new Date(fetchDate);\r\n\r\n    // Normalize today to the start of its day in Shanghai time\r\n    today.setHours(0, 0, 0, 0);\r\n\r\n    const diffTime = today.getTime() - itemDate.getTime();\r\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n\r\n    return diffDays >= 0 && diffDays < days;\r\n}\r\n\r\n/**\r\n * Formats an ISO date string to \"YYYY\u5E74M\u6708D\u65E5\" format.\r\n * @param {string} isoDateString - The date string in ISO format (e.g., \"2025-05-30T08:24:52.000Z\").\r\n * @returns {string} Formatted date string (e.g., \"2025\u5E745\u670830\u65E5\").\r\n */\r\nexport function formatDateToChinese(isoDateString) {\r\n    if (!isoDateString) return '';\r\n    const date = new Date(isoDateString);\r\n    const options = {\r\n        year: 'numeric',\r\n        month: 'numeric',\r\n        day: 'numeric',\r\n        timeZone: 'Asia/Shanghai'\r\n    };\r\n    return new Intl.DateTimeFormat('zh-CN', options).format(date);\r\n}\r\n\r\n/**\r\n * Formats an ISO date string to \"YYYY\u5E74M\u6708D\u65E5 HH:MM:SS\" format.\r\n * @param {string} isoDateString - The date string in ISO format (e.g., \"2025-05-30T08:24:52.000Z\").\r\n * @returns {string} Formatted date string (e.g., \"2025\u5E745\u670830\u65E5 08:24:52\").\r\n */\r\nexport function formatDateToChineseWithTime(isoDateString) {\r\n    if (!isoDateString) return '';\r\n    const date = new Date(isoDateString);\r\n    const options = {\r\n        year: 'numeric',\r\n        month: 'numeric',\r\n        day: 'numeric',\r\n        hour: '2-digit',\r\n        minute: '2-digit',\r\n        second: '2-digit',\r\n        hour12: false, // \u4F7F\u752824\u5C0F\u65F6\u5236\r\n        timeZone: 'Asia/Shanghai' // \u6307\u5B9A\u4E1C8\u65F6\u533A\r\n    };\r\n    // \u4F7F\u7528 'zh-CN' \u8BED\u8A00\u73AF\u5883\u4EE5\u786E\u4FDD\u4E2D\u6587\u683C\u5F0F\r\n    return new Intl.DateTimeFormat('zh-CN', options).format(date);\r\n}\r\n\r\n/**\r\n * \u5C07\u65E5\u671F\u7269\u4EF6\u683C\u5F0F\u5316\u70BA RSS 2.0 \u898F\u7BC4\u7684\u65E5\u671F\u5B57\u4E32 (RFC 822)\r\n * \u4F8B\u5982: \"Thu, 01 Jan 1970 00:00:00 GMT\"\r\n * @param {Date} date - \u65E5\u671F\u7269\u4EF6\r\n * @returns {string} \u683C\u5F0F\u5316\u5F8C\u7684\u65E5\u671F\u5B57\u4E32\r\n */\r\nexport function formatRssDate(date) {\r\n    if (!date) return new Date().toUTCString();\r\n    \r\n    return date.toUTCString();\r\n  }\r\n\r\n\r\n  export function formatDateToGMT0WithTime(isoDateString) {\r\n    if (!isoDateString) return '';\r\n    const date = new Date(isoDateString);\r\n    const options = {\r\n        year: 'numeric',\r\n        month: 'numeric',\r\n        day: 'numeric',\r\n        hour: '2-digit',\r\n        minute: '2-digit',\r\n        second: '2-digit',\r\n        hour12: false, // \u4F7F\u752824\u5C0F\u65F6\u5236\r\n        timeZone: 'GMT'\r\n    };\r\n    // \u4F7F\u7528 'zh-CN' \u8BED\u8A00\u73AF\u5883\u4EE5\u786E\u4FDD\u4E2D\u6587\u683C\u5F0F\r\n    return new Intl.DateTimeFormat('zh-CN', options).format(date);\r\n}  \r\n\r\n  export function formatDateToGMT8WithTime(isoDateString) {\r\n    if (!isoDateString) return '';\r\n    const date = new Date(isoDateString);\r\n    const options = {\r\n        year: 'numeric',\r\n        month: 'numeric',\r\n        day: 'numeric',\r\n        hour: '2-digit',\r\n        minute: '2-digit',\r\n        second: '2-digit',\r\n        hour12: false, // \u4F7F\u752824\u5C0F\u65F6\u5236\r\n        timeZone: 'Asia/Shanghai'// \u6307\u5B9A\u4E1C8\u65F6\u533A\r\n    };\r\n    // \u4F7F\u7528 'zh-CN' \u8BED\u8A00\u73AF\u5883\u4EE5\u786E\u4FDD\u4E2D\u6587\u683C\u5F0F\r\n    return new Intl.DateTimeFormat('zh-CN', options).format(date);\r\n}  \r\n\r\n/**\r\n * Converts English double quotes (\") to Chinese double quotes (\u201C\u201D).\r\n * @param {string} text - The input string.\r\n * @returns {string} The string with Chinese double quotes.\r\n */\r\nexport function convertEnglishQuotesToChinese(text) {\r\n    const str = String(text);\r\n    return str.replace(/\"/g, '\u201C');\r\n}\r\n\r\nexport function formatMarkdownText(text) {\r\n    const str = String(text);\r\n    return str.replace(/\u201C/g, '\"');\r\n}\r\n\r\n/**\r\n * Generates a random User-Agent string.\r\n * @returns {string} A random User-Agent string.\r\n */\r\nexport function getRandomUserAgent() {\r\n    const userAgents = [\r\n        \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36\",\r\n        \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36\",\r\n        \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36\",\r\n        \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36\",\r\n        \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36\",\r\n        \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Safari/605.1.15\",\r\n        \"Mozilla/5.0 (Macintosh; Intel Mac OS X 13_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Safari/605.1.15\",\r\n        \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:108.0) Gecko/20100101 Firefox/108.0\",\r\n        \"Mozilla/5.0 (X11; Linux x86_64; rv:108.0) Gecko/20100101 Firefox/108.0\",\r\n    ];\r\n    return userAgents[Math.floor(Math.random() * userAgents.length)];\r\n}\r\n\r\n/**\r\n * Pauses execution for a specified number of milliseconds.\r\n * @param {number} ms - The number of milliseconds to sleep.\r\n * @returns {Promise<void>} A promise that resolves after the specified time.\r\n */\r\nexport function sleep(ms) {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n\r\nexport function replaceImageProxy(proxy, content) {\r\n    const str = String(content);\r\n    return str.replace(/upload.chinaz.com/g, 'pic.chinaz.com').replace(/https:\\/\\/pic.chinaz.com/g, proxy+'https:\\/\\/pic.chinaz.com');\r\n}", "import { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, formatDateToChineseWithTime, escapeHtml } from '../helpers';\r\n\r\nconst NewsAggregatorDataSource = {\r\n    type: 'news-aggregator',\r\n    async fetch(env, foloCookie) {\r\n        const listId = env.NEWS_AGGREGATOR_LIST_ID;\r\n        const fetchPages = parseInt(env.NEWS_AGGREGATOR_FETCH_PAGES || '1', 10);\r\n        const allNewsItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!listId) {\r\n            console.warn('NEWS_AGGREGATOR_LIST_ID is not set in environment variables. Skipping news aggregator fetch.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"Aggregated News\",\r\n                home_page_url: \"https://example.com/news\",\r\n                description: \"Aggregated news from various sources\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                listId: listId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching News Aggregator data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch News Aggregator data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allNewsItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: entry.entries.author ? `${entry.feeds.title} - ${entry.entries.author}` : entry.feeds.title,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for News Aggregator, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching News Aggregator data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        return {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"Aggregated News\",\r\n            home_page_url: \"https://example.com/news\",\r\n            description: \"Aggregated news from various sources\",\r\n            language: \"zh-cn\",\r\n            items: allNewsItems\r\n        };\r\n    },\r\n\r\n    transform(rawData, sourceType) {\r\n        if (!rawData || !rawData.items) {\r\n            return [];\r\n        }\r\n\r\n        return rawData.items.map(item => ({\r\n            id: item.id,\r\n            type: sourceType,\r\n            url: item.url,\r\n            title: item.title,\r\n            description: stripHtml(item.content_html || \"\"),\r\n            published_date: item.date_published,\r\n            authors: item.authors ? item.authors.map(author => author.name).join(', ') : 'Unknown',\r\n            source: item.source || 'Aggregated News',\r\n            details: {\r\n                content_html: item.content_html || \"\"\r\n            }\r\n        }));\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}</div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u9605\u8BFB\u66F4\u591A</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default NewsAggregatorDataSource;\r\n", "// src/chatapi.js\r\n\r\n/**\r\n * Calls the Gemini Chat API (non-streaming).\r\n *\r\n * @param {object} env - Environment object containing GEMINI_API_URL.\r\n * @param {string} promptText - The user's prompt.\r\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\r\n * @returns {Promise<string>} The generated text content.\r\n * @throws {Error} If GEMINI_API_URL is not set, or if API call fails or returns blocked/empty content.\r\n */\r\nasync function callGeminiChatAPI(env, promptText, systemPromptText = null) {\r\n    if (!env.GEMINI_API_URL) {\r\n        throw new Error(\"GEMINI_API_URL environment variable is not set.\");\r\n    }\r\n    if (!env.GEMINI_API_KEY) {\r\n        throw new Error(\"GEMINI_API_KEY environment variable is not set for Gemini models.\");\r\n    }\r\n    const modelName = env.DEFAULT_GEMINI_MODEL;\r\n    const url = `${env.GEMINI_API_URL}/v1beta/models/${modelName}:generateContent?key=${env.GEMINI_API_KEY}`;\r\n    const payload = {\r\n        contents: [{\r\n            parts: [{ text: promptText }]\r\n        }],\r\n    };\r\n\r\n    if (systemPromptText && typeof systemPromptText === 'string' && systemPromptText.trim() !== '') {\r\n        payload.systemInstruction = {\r\n            parts: [{ text: systemPromptText }]\r\n        };\r\n        console.log(\"System instruction included in Chat API call.\");\r\n    }\r\n\r\n    try {\r\n        const response = await fetch(url, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify(payload)\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorBodyText = await response.text();\r\n            let errorData;\r\n            try {\r\n                errorData = JSON.parse(errorBodyText);\r\n            } catch (e) {\r\n                errorData = errorBodyText;\r\n            }\r\n            console.error(\"Gemini Chat API Error Response Body:\", typeof errorData === 'object' ? JSON.stringify(errorData, null, 2) : errorData);\r\n            const message = typeof errorData === 'object' && errorData.error?.message\r\n                ? errorData.error.message\r\n                : (typeof errorData === 'string' ? errorData : 'Unknown Gemini Chat API error');\r\n            throw new Error(`Gemini Chat API error (${response.status}): ${message}`);\r\n        }\r\n\r\n        const data = await response.json();\r\n\r\n        // 1. Check for prompt-level blocking first\r\n        if (data.promptFeedback && data.promptFeedback.blockReason) {\r\n            const blockReason = data.promptFeedback.blockReason;\r\n            const safetyRatings = data.promptFeedback.safetyRatings ? JSON.stringify(data.promptFeedback.safetyRatings) : 'N/A';\r\n            console.error(`Gemini Chat prompt blocked: ${blockReason}. Safety ratings: ${safetyRatings}`, JSON.stringify(data, null, 2));\r\n            throw new Error(`Gemini Chat prompt blocked: ${blockReason}. Safety ratings: ${safetyRatings}`);\r\n        }\r\n\r\n        // 2. Check candidates and their content\r\n        if (data.candidates && data.candidates.length > 0) {\r\n            const candidate = data.candidates[0];\r\n\r\n            // Check finishReason for issues other than STOP\r\n            // Common finishReasons: STOP, MAX_TOKENS, SAFETY, RECITATION, OTHER\r\n            if (candidate.finishReason && candidate.finishReason !== \"STOP\") {\r\n                const reason = candidate.finishReason;\r\n                const safetyRatings = candidate.safetyRatings ? JSON.stringify(candidate.safetyRatings) : 'N/A';\r\n                console.error(`Gemini Chat content generation finished with reason: ${reason}. Safety ratings: ${safetyRatings}`, JSON.stringify(data, null, 2));\r\n                if (reason === \"SAFETY\") {\r\n                     throw new Error(`Gemini Chat content generation blocked due to safety (${reason}). Safety ratings: ${safetyRatings}`);\r\n                }\r\n                throw new Error(`Gemini Chat content generation finished due to: ${reason}. Safety ratings: ${safetyRatings}`);\r\n            }\r\n\r\n            // If finishReason is STOP, try to extract text\r\n            if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0 && candidate.content.parts[0].text) {\r\n                return candidate.content.parts[0].text;\r\n            } else {\r\n                // finishReason was STOP (or not present, implying success), but no text.\r\n                console.warn(\"Gemini Chat API response has candidate with 'STOP' finishReason but no text content, or content structure is unexpected.\", JSON.stringify(data, null, 2));\r\n                throw new Error(\"Gemini Chat API returned a candidate with 'STOP' finishReason but no text content.\");\r\n            }\r\n        } else {\r\n            // No candidates, and no promptFeedback block reason either (handled above).\r\n            // This means the response is empty or malformed in an unexpected way.\r\n            console.warn(\"Gemini Chat API response format unexpected: No candidates found and no prompt block reason.\", JSON.stringify(data, null, 2));\r\n            throw new Error(\"Gemini Chat API returned an empty or malformed response with no candidates.\");\r\n        }\r\n    } catch (error) {\r\n        // Log the full error object if it's not one we constructed, or just re-throw\r\n        if (!(error instanceof Error && error.message.startsWith(\"Gemini Chat\"))) {\r\n            console.error(\"Error calling Gemini Chat API (Non-streaming):\", error);\r\n        }\r\n        throw error;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Calls the Gemini Chat API with streaming.\r\n *\r\n * @param {object} env - Environment object containing GEMINI_API_URL.\r\n * @param {string} promptText - The user's prompt.\r\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\r\n * @returns {AsyncGenerator<string, void, undefined>} An async generator yielding text chunks.\r\n * @throws {Error} If GEMINI_API_URL is not set, or if API call fails or returns blocked/empty content.\r\n */\r\nasync function* callGeminiChatAPIStream(env, promptText, systemPromptText = null) {\r\n    if (!env.GEMINI_API_URL) {\r\n        throw new Error(\"GEMINI_API_URL environment variable is not set.\");\r\n    }\r\n    if (!env.GEMINI_API_KEY) {\r\n        throw new Error(\"GEMINI_API_KEY environment variable is not set for Gemini models.\");\r\n    }\r\n    const modelName = env.DEFAULT_GEMINI_MODEL;\r\n    const url = `${env.GEMINI_API_URL}/v1beta/models/${modelName}:streamGenerateContent?key=${env.GEMINI_API_KEY}&alt=sse`;\r\n\r\n    const payload = {\r\n        contents: [{\r\n            parts: [{ text: promptText }]\r\n        }],\r\n        generationConfig: {\r\n            temperature: 1,\r\n            topP: 0.95\r\n        }\r\n    };\r\n\r\n    if (systemPromptText && typeof systemPromptText === 'string' && systemPromptText.trim() !== '') {\r\n        payload.systemInstruction = {\r\n            parts: [{ text: systemPromptText }]\r\n        };\r\n        console.log(\"System instruction included in Chat API call.\");\r\n    }\r\n\r\n    let response;\r\n    try {\r\n        response = await fetch(url, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify(payload)\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorBodyText = await response.text();\r\n            let errorData;\r\n            try {\r\n                errorData = JSON.parse(errorBodyBody);\r\n            } catch (e) {\r\n                errorData = errorBodyText;\r\n            }\r\n            console.error(\"Gemini Chat API Error (Stream Initial) Response Body:\", typeof errorData === 'object' ? JSON.stringify(errorData, null, 2) : errorData);\r\n            const message = typeof errorData === 'object' && errorData.error?.message\r\n                ? errorData.error.message\r\n                : (typeof errorData === 'string' ? errorData : 'Unknown Gemini Chat API error');\r\n            throw new Error(`Gemini Chat API error (${response.status}): ${message}`);\r\n        }\r\n\r\n        if (!response.body) {\r\n            throw new Error(\"Response body is null, cannot stream.\");\r\n        }\r\n\r\n        const reader = response.body.getReader();\r\n        const decoder = new TextDecoder();\r\n        let buffer = \"\";\r\n        let hasYieldedContent = false;\r\n        let overallFinishReason = null; // To track the final finish reason if available\r\n        let finalSafetyRatings = null;\r\n\r\n        const processJsonChunk = (jsonString) => {\r\n            if (jsonString.trim() === \"\") return null;\r\n            try {\r\n                return JSON.parse(jsonString);\r\n            } catch (e) {\r\n                console.warn(\"Failed to parse JSON chunk from stream:\", jsonString, e.message);\r\n                return null; // Or throw, depending on how strictly you want to handle malformed JSON\r\n            }\r\n        };\r\n\r\n        const handleChunkLogic = (chunk) => {\r\n            if (!chunk) return false; // Not a valid chunk to process\r\n\r\n            // 1. Check for prompt-level blocking (might appear in first chunk)\r\n            if (chunk.promptFeedback && chunk.promptFeedback.blockReason) {\r\n                const blockReason = chunk.promptFeedback.blockReason;\r\n                const safetyRatings = chunk.promptFeedback.safetyRatings ? JSON.stringify(chunk.promptFeedback.safetyRatings) : 'N/A';\r\n                console.error(`Gemini Chat prompt blocked during stream: ${blockReason}. Safety ratings: ${safetyRatings}`, JSON.stringify(chunk, null, 2));\r\n                throw new Error(`Gemini Chat prompt blocked: ${blockReason}. Safety ratings: ${safetyRatings}`);\r\n            }\r\n\r\n            // 2. Check candidates\r\n            if (chunk.candidates && chunk.candidates.length > 0) {\r\n                const candidate = chunk.candidates[0];\r\n                if (candidate.finishReason) {\r\n                    overallFinishReason = candidate.finishReason; // Store the latest finish reason\r\n                    finalSafetyRatings = candidate.safetyRatings;\r\n\r\n                    if (candidate.finishReason !== \"STOP\") {\r\n                        const reason = candidate.finishReason;\r\n                        const sr = candidate.safetyRatings ? JSON.stringify(candidate.safetyRatings) : 'N/A';\r\n                        console.error(`Gemini Chat stream candidate finished with reason: ${reason}. Safety ratings: ${sr}`, JSON.stringify(chunk, null, 2));\r\n                        if (reason === \"SAFETY\") {\r\n                            throw new Error(`Gemini Chat content generation blocked due to safety (${reason}). Safety ratings: ${sr}`);\r\n                        }\r\n                        throw new Error(`Gemini Chat stream finished due to: ${reason}. Safety ratings: ${sr}`);\r\n                    }\r\n                }\r\n\r\n                if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\r\n                    const textPart = candidate.content.parts[0].text;\r\n                    if (textPart && typeof textPart === 'string') {\r\n                        hasYieldedContent = true;\r\n                        return textPart; // This is the text to yield\r\n                    }\r\n                }\r\n            } else if (chunk.error) { // Check for explicit error object in stream\r\n                console.error(\"Gemini Chat API Stream Error Chunk:\", JSON.stringify(chunk.error, null, 2));\r\n                throw new Error(`Gemini Chat API stream error: ${chunk.error.message || 'Unknown error in stream'}`);\r\n            }\r\n            return null; // No text to yield from this chunk\r\n        };\r\n\r\n\r\n        while (true) {\r\n            const { done, value } = await reader.read();\r\n            if (done) {\r\n                break;\r\n            }\r\n\r\n            buffer += decoder.decode(value, { stream: true });\r\n            \r\n            let eventBoundary;\r\n            while ((eventBoundary = buffer.indexOf('\\n\\n')) !== -1 || (eventBoundary = buffer.indexOf('\\n')) !== -1) {\r\n                const separatorLength = (buffer.indexOf('\\n\\n') === eventBoundary) ? 2 : 1;\r\n                let message = buffer.substring(0, eventBoundary);\r\n                buffer = buffer.substring(eventBoundary + separatorLength);\r\n\r\n                if (message.startsWith(\"data: \")) {\r\n                    message = message.substring(5).trim();\r\n                } else {\r\n                    message = message.trim();\r\n                }\r\n\r\n                if (message === \"\" || message === \"[DONE]\") {\r\n                    continue;\r\n                }\r\n                \r\n                const parsedChunk = processJsonChunk(message);\r\n                if (parsedChunk) {\r\n                    const textToYield = handleChunkLogic(parsedChunk);\r\n                    if (textToYield !== null) {\r\n                        yield textToYield;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Process any remaining data in the buffer (if not ending with newline(s))\r\n        if (buffer.trim()) {\r\n            let finalMessage = buffer.trim();\r\n             if (finalMessage.startsWith(\"data: \")) {\r\n                finalMessage = finalMessage.substring(5).trim();\r\n            }\r\n            if (finalMessage !== \"\" && finalMessage !== \"[DONE]\") {\r\n                const parsedChunk = processJsonChunk(finalMessage);\r\n                 if (parsedChunk) {\r\n                    const textToYield = handleChunkLogic(parsedChunk);\r\n                    if (textToYield !== null) {\r\n                        yield textToYield;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // After the stream has finished, check if any content was yielded and the overall outcome\r\n        if (!hasYieldedContent) {\r\n            if (overallFinishReason && overallFinishReason !== \"STOP\") {\r\n                const sr = finalSafetyRatings ? JSON.stringify(finalSafetyRatings) : 'N/A';\r\n                console.warn(`Gemini Chat stream ended with reason '${overallFinishReason}' and no content was yielded. Safety: ${sr}`);\r\n                throw new Error(`Gemini Chat stream completed due to ${overallFinishReason} without yielding content. Safety ratings: ${sr}`);\r\n            } else if (overallFinishReason === \"STOP\") {\r\n                console.warn(\"Gemini Chat stream finished with 'STOP' but no content was yielded.\", JSON.stringify({overallFinishReason, finalSafetyRatings}, null, 2));\r\n                throw new Error(\"Gemini Chat stream completed with 'STOP' but yielded no content.\");\r\n            } else if (!overallFinishReason) {\r\n                console.warn(\"Gemini Chat stream ended without yielding any content or a clear finish reason.\");\r\n                throw new Error(\"Gemini Chat stream completed without yielding any content.\");\r\n            }\r\n        }\r\n\r\n    } catch (error) {\r\n         if (!(error instanceof Error && error.message.startsWith(\"Gemini Chat\"))) {\r\n            console.error(\"Error calling or streaming from Gemini Chat API:\", error);\r\n        }\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * Calls the OpenAI Chat API (non-streaming).\r\n *\r\n * @param {object} env - Environment object containing OPENAI_API_URL and OPENAI_API_KEY.\r\n * @param {string} promptText - The user's prompt.\r\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\r\n * @returns {Promise<string>} The generated text content.\r\n * @throws {Error} If OPENAI_API_URL or OPENAI_API_KEY is not set, or if API call fails.\r\n */\r\nasync function callOpenAIChatAPI(env, promptText, systemPromptText = null) {\r\n    if (!env.OPENAI_API_URL) {\r\n        throw new Error(\"OPENAI_API_URL environment variable is not set.\");\r\n    }\r\n    if (!env.OPENAI_API_KEY) {\r\n        throw new Error(\"OPENAI_API_KEY environment variable is not set for OpenAI models.\");\r\n    }\r\n    const url = `${env.OPENAI_API_URL}/v1/chat/completions`;\r\n    \r\n    const messages = [];\r\n    if (systemPromptText && typeof systemPromptText === 'string' && systemPromptText.trim() !== '') {\r\n        messages.push({ role: \"system\", content: systemPromptText });\r\n        console.log(\"System instruction included in OpenAI Chat API call.\");\r\n    }\r\n    messages.push({ role: \"user\", content: promptText });\r\n\r\n    const modelName = env.DEFAULT_OPEN_MODEL;\r\n    const payload = {\r\n        model: modelName,\r\n        messages: messages,\r\n        temperature: 1,\r\n        max_tokens: 2048,\r\n        top_p: 1,\r\n        frequency_penalty: 0,\r\n        presence_penalty: 0,\r\n    };\r\n\r\n    try {\r\n        const response = await fetch(url, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `Bearer ${env.OPENAI_API_KEY}`\r\n            },\r\n            body: JSON.stringify(payload)\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorBodyText = await response.text();\r\n            let errorData;\r\n            try {\r\n                errorData = JSON.parse(errorBodyText);\r\n            } catch (e) {\r\n                errorData = errorBodyText;\r\n            }\r\n            console.error(\"OpenAI Chat API Error Response Body:\", typeof errorData === 'object' ? JSON.stringify(errorData, null, 2) : errorData);\r\n            const message = typeof errorData === 'object' && errorData.error?.message\r\n                ? errorData.error.message\r\n                : (typeof errorData === 'string' ? errorData : 'Unknown OpenAI Chat API error');\r\n            throw new Error(`OpenAI Chat API error (${response.status}): ${message}`);\r\n        }\r\n\r\n        const data = await response.json();\r\n\r\n        if (data.choices && data.choices.length > 0 && data.choices[0].message && data.choices[0].message.content) {\r\n            return data.choices[0].message.content;\r\n        } else {\r\n            console.warn(\"OpenAI Chat API response format unexpected: No choices or content found.\", JSON.stringify(data, null, 2));\r\n            throw new Error(\"OpenAI Chat API returned an empty or malformed response.\");\r\n        }\r\n    } catch (error) {\r\n        if (!(error instanceof Error && error.message.startsWith(\"OpenAI Chat\"))) {\r\n            console.error(\"Error calling OpenAI Chat API (Non-streaming):\", error);\r\n        }\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * Calls the OpenAI Chat API with streaming.\r\n *\r\n * @param {object} env - Environment object containing OPENAI_API_URL and OPENAI_API_KEY.\r\n * @param {string} promptText - The user's prompt.\r\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\r\n * @returns {AsyncGenerator<string, void, undefined>} An async generator yielding text chunks.\r\n * @throws {Error} If OPENAI_API_URL or OPENAI_API_KEY is not set, or if API call fails.\r\n */\r\nasync function* callOpenAIChatAPIStream(env, promptText, systemPromptText = null) {\r\n    if (!env.OPENAI_API_URL) {\r\n        throw new Error(\"OPENAI_API_URL environment variable is not set.\");\r\n    }\r\n    if (!env.OPENAI_API_KEY) {\r\n        throw new Error(\"OPENAI_API_KEY environment variable is not set for OpenAI models.\");\r\n    }\r\n    const url = `${env.OPENAI_API_URL}/v1/chat/completions`;\r\n\r\n    const messages = [];\r\n    if (systemPromptText && typeof systemPromptText === 'string' && systemPromptText.trim() !== '') {\r\n        messages.push({ role: \"system\", content: systemPromptText });\r\n        console.log(\"System instruction included in OpenAI Chat API call.\");\r\n    }\r\n    messages.push({ role: \"user\", content: promptText });\r\n\r\n    const modelName = env.DEFAULT_OPEN_MODEL;\r\n    const payload = {\r\n        model: modelName,\r\n        messages: messages,\r\n        temperature: 1,\r\n        max_tokens: 2048,\r\n        top_p: 1,\r\n        frequency_penalty: 0,\r\n        presence_penalty: 0,\r\n        stream: true,\r\n    };\r\n\r\n    let response;\r\n    try {\r\n        response = await fetch(url, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `Bearer ${env.OPENAI_API_KEY}`\r\n            },\r\n            body: JSON.stringify(payload)\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorBodyText = await response.text();\r\n            let errorData;\r\n            try {\r\n                errorData = JSON.parse(errorBodyText);\r\n            } catch (e) {\r\n                errorData = errorBodyText;\r\n            }\r\n            console.error(\"OpenAI Chat API Error (Stream Initial) Response Body:\", typeof errorData === 'object' ? JSON.stringify(errorData, null, 2) : errorData);\r\n            const message = typeof errorData === 'object' && errorData.error?.message\r\n                ? errorData.error.message\r\n                : (typeof errorData === 'string' ? errorData : 'Unknown OpenAI Chat API error');\r\n            throw new Error(`OpenAI Chat API error (${response.status}): ${message}`);\r\n        }\r\n\r\n        if (!response.body) {\r\n            throw new Error(\"Response body is null, cannot stream.\");\r\n        }\r\n\r\n        const reader = response.body.getReader();\r\n        const decoder = new TextDecoder();\r\n        let buffer = \"\";\r\n        let hasYieldedContent = false;\r\n\r\n        while (true) {\r\n            const { done, value } = await reader.read();\r\n            if (done) {\r\n                break;\r\n            }\r\n\r\n            buffer += decoder.decode(value, { stream: true });\r\n            \r\n            // OpenAI streaming uses data: {JSON}\\n\\n\r\n            let eventBoundary;\r\n            while ((eventBoundary = buffer.indexOf('\\n\\n')) !== -1) {\r\n                let message = buffer.substring(0, eventBoundary);\r\n                buffer = buffer.substring(eventBoundary + 2); // +2 for '\\n\\n'\r\n\r\n                if (message.startsWith(\"data: \")) {\r\n                    message = message.substring(5).trim();\r\n                } else {\r\n                    message = message.trim();\r\n                }\r\n\r\n                if (message === \"\" || message === \"[DONE]\") {\r\n                    continue;\r\n                }\r\n                \r\n                try {\r\n                    const parsedChunk = JSON.parse(message);\r\n                    if (parsedChunk.choices && parsedChunk.choices.length > 0) {\r\n                        const delta = parsedChunk.choices[0].delta;\r\n                        if (delta && delta.content) {\r\n                            hasYieldedContent = true;\r\n                            yield delta.content;\r\n                        }\r\n                    } else if (parsedChunk.error) {\r\n                        console.error(\"OpenAI Chat API Stream Error Chunk:\", JSON.stringify(parsedChunk.error, null, 2));\r\n                        throw new Error(`OpenAI Chat API stream error: ${parsedChunk.error.message || 'Unknown error in stream'}`);\r\n                    }\r\n                } catch (e) {\r\n                    console.warn(\"Failed to parse JSON chunk from OpenAI stream:\", message, e.message);\r\n                    // Continue processing, might be an incomplete chunk\r\n                }\r\n            }\r\n        }\r\n\r\n        // Process any remaining data in the buffer\r\n        if (buffer.trim()) {\r\n            let finalMessage = buffer.trim();\r\n            if (finalMessage.startsWith(\"data: \")) {\r\n                finalMessage = finalMessage.substring(5).trim();\r\n            }\r\n            if (finalMessage !== \"\" && finalMessage !== \"[DONE]\") {\r\n                try {\r\n                    const parsedChunk = JSON.parse(finalMessage);\r\n                    if (parsedChunk.choices && parsedChunk.choices.length > 0) {\r\n                        const delta = parsedChunk.choices[0].delta;\r\n                        if (delta && delta.content) {\r\n                            hasYieldedContent = true;\r\n                            yield delta.content;\r\n                        }\r\n                    } else if (parsedChunk.error) {\r\n                        console.error(\"OpenAI Chat API Stream Error Chunk:\", JSON.stringify(parsedChunk.error, null, 2));\r\n                        throw new Error(`OpenAI Chat API stream error: ${parsedChunk.error.message || 'Unknown error in stream'}`);\r\n                    }\r\n                } catch (e) {\r\n                    console.warn(\"Failed to parse final JSON chunk from OpenAI stream:\", finalMessage, e.message);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!hasYieldedContent) {\r\n            console.warn(\"OpenAI Chat stream finished but no content was yielded.\");\r\n            throw new Error(\"OpenAI Chat stream completed but yielded no content.\");\r\n        }\r\n\r\n    } catch (error) {\r\n        if (!(error instanceof Error && error.message.startsWith(\"OpenAI Chat\"))) {\r\n            console.error(\"Error calling or streaming from OpenAI Chat API:\", error);\r\n        }\r\n        throw error;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Main function to call the appropriate chat API (Gemini or OpenAI) based on model name.\r\n * Defaults to Gemini if no specific API is indicated in the model name.\r\n *\r\n * @param {object} env - Environment object.\r\n * @param {string} promptText - The user's prompt.\r\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\r\n * @returns {Promise<string>} The generated text content.\r\n * @throws {Error} If API keys/URLs are not set, or if API call fails.\r\n */\r\nexport async function callChatAPI(env, promptText, systemPromptText = null) {\r\n    const platform = env.USE_MODEL_PLATFORM;\r\n    if (platform.startsWith(\"OPEN\")) {\r\n        return callOpenAIChatAPI(env, promptText, systemPromptText);\r\n    } else { // Default to Gemini\r\n        return callGeminiChatAPI(env, promptText, systemPromptText);\r\n    }\r\n}\r\n\r\n/**\r\n * Main function to call the appropriate chat API (Gemini or OpenAI) with streaming.\r\n * Defaults to Gemini if no specific API is indicated in the model name.\r\n *\r\n * @param {object} env - Environment object.\r\n * @param {string} promptText - The user's prompt.\r\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\r\n * @returns {AsyncGenerator<string, void, undefined>} An async generator yielding text chunks.\r\n * @throws {Error} If API keys/URLs are not set, or if API call fails.\r\n */\r\nexport async function* callChatAPIStream(env, promptText, systemPromptText = null) {\r\n    const platform = env.USE_MODEL_PLATFORM;\r\n    if (platform.startsWith(\"OPEN\")) {\r\n        yield* callOpenAIChatAPIStream(env, promptText, systemPromptText);\r\n    } else { // Default to Gemini\r\n        yield* callGeminiChatAPIStream(env, promptText, systemPromptText);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * \u5E26\u6709\u8D85\u65F6\u529F\u80FD\u7684 fetch \u5C01\u88C5\r\n * @param {string} resource fetch \u7684\u8BF7\u6C42 URL\r\n * @param {object} options fetch \u7684\u914D\u7F6E\u5BF9\u8C61\r\n * @param {number} timeout \u8D85\u65F6\u65F6\u95F4\uFF0C\u5355\u4F4D\u6BEB\u79D2\r\n * @returns {Promise<Response>}\r\n */\r\nasync function fetchWithTimeout(resource, options = {}, timeout = 180000) {\r\n  const controller = new AbortController();\r\n  const id = setTimeout(() => controller.abort(), timeout);\r\n\r\n  try {\r\n    const response = await fetch(resource, {\r\n      ...options,\r\n      signal: controller.signal  // \u5173\u8054 AbortController\r\n    });\r\n    return response;\r\n  } catch (error) {\r\n    // \u5F53 abort() \u88AB\u8C03\u7528\u65F6\uFF0Cfetch \u4F1A\u629B\u51FA\u4E00\u4E2A AbortError\r\n    if (error.name === 'AbortError') {\r\n      throw new Error('Request timed out');\r\n    }\r\n    // \u5176\u4ED6\u7F51\u7EDC\u9519\u8BEF\u7B49\r\n    throw error;\r\n  } finally {\r\n    // \u6E05\u9664\u8BA1\u65F6\u5668\uFF0C\u9632\u6B62\u5185\u5B58\u6CC4\u6F0F\r\n    clearTimeout(id);\r\n  }\r\n}", "// src/dataSources/projects.js\r\nimport { fetchData, getISODate, removeMarkdownCodeBlock, formatDateToChineseWithTime, escapeHtml} from '../helpers.js';\r\nimport { callChatAPI } from '../chatapi.js';\r\n\r\nconst ProjectsDataSource = {\r\n    fetch: async (env) => {\r\n        console.log(`Fetching projects from: ${env.PROJECTS_API_URL}`);\r\n        let projects;\r\n        try {\r\n            projects = await fetchData(env.PROJECTS_API_URL);\r\n        } catch (error) {\r\n            console.error(\"Error fetching projects data:\", error.message);\r\n            return { error: \"Failed to fetch projects data\", details: error.message, items: [] };\r\n        }\r\n\r\n        if (!Array.isArray(projects)) {\r\n            console.error(\"Projects data is not an array:\", projects);\r\n            return { error: \"Invalid projects data format\", received: projects, items: [] };\r\n        }\r\n         if (projects.length === 0) {\r\n            console.log(\"No projects fetched from API.\");\r\n            return { items: [] };\r\n        }\r\n\r\n        if (!env.OPEN_TRANSLATE === \"true\") {\r\n            console.warn(\"Skipping paper translations.\");\r\n            return projects.map(p => ({ ...p, description_zh: p.description || \"\" }));\r\n        }\r\n\r\n        const descriptionsToTranslate = projects\r\n            .map(p => p.description || \"\")\r\n            .filter(desc => typeof desc === 'string');\r\n\r\n        const nonEmptyDescriptions = descriptionsToTranslate.filter(d => d.trim() !== \"\");\r\n        if (nonEmptyDescriptions.length === 0) {\r\n            console.log(\"No non-empty project descriptions to translate.\");\r\n            return projects.map(p => ({ ...p, description_zh: p.description || \"\" }));\r\n        }\r\n        const promptText = `Translate the following English project descriptions to Chinese.\r\nProvide the translations as a JSON array of strings, in the exact same order as the input.\r\nEach string in the output array must correspond to the string at the same index in the input array.\r\nIf an input description is an empty string, the corresponding translated string in the output array should also be an empty string.\r\nInput Descriptions (JSON array of strings):\r\n${JSON.stringify(descriptionsToTranslate)}\r\nRespond ONLY with the JSON array of Chinese translations. Do not include any other text or explanations.\r\nJSON Array of Chinese Translations:`;\r\n\r\n        let translatedTexts = [];\r\n        try {\r\n            console.log(`Requesting translation for ${descriptionsToTranslate.length} project descriptions.`);\r\n            const chatResponse = await callChatAPI(env, promptText);\r\n            const parsedTranslations = JSON.parse(removeMarkdownCodeBlock(chatResponse)); // Assuming direct JSON array response\r\n\r\n            if (parsedTranslations && Array.isArray(parsedTranslations) && parsedTranslations.length === descriptionsToTranslate.length) {\r\n                translatedTexts = parsedTranslations;\r\n            } else {\r\n                console.warn(`Translation count mismatch or parsing error for project descriptions. Expected ${descriptionsToTranslate.length}, received ${parsedTranslations ? parsedTranslations.length : 'null'}. Falling back.`);\r\n                translatedTexts = descriptionsToTranslate.map(() => null);\r\n            }\r\n        } catch (translationError) {\r\n            console.error(\"Failed to translate project descriptions in batch:\", translationError.message);\r\n            translatedTexts = descriptionsToTranslate.map(() => null);\r\n        }\r\n\r\n        return projects.map((project, index) => {\r\n            const translated = translatedTexts[index];\r\n            return {\r\n                ...project,\r\n                description_zh: (typeof translated === 'string') ? translated : (project.description || \"\")\r\n            };\r\n        });\r\n    },\r\n    transform: (projectsData, sourceType) => {\r\n        const unifiedProjects = [];\r\n        const now = getISODate();\r\n        if (Array.isArray(projectsData)) {\r\n            projectsData.forEach((project, index) => {\r\n                unifiedProjects.push({\r\n                    id: index + 1, // Use project.url as ID if available\r\n                    type: sourceType,\r\n                    url: project.url,\r\n                    title: project.name,\r\n                    description: project.description_zh || project.description || \"\",\r\n                    published_date: now, // Projects don't have a published date, use current date\r\n                    authors: project.owner ? [project.owner] : [],\r\n                    source: \"GitHub Trending\",\r\n                    details: {\r\n                        owner: project.owner,\r\n                        name: project.name,\r\n                        language: project.language,\r\n                        languageColor: project.languageColor,\r\n                        totalStars: project.totalStars,\r\n                        forks: project.forks,\r\n                        starsToday: project.starsToday,\r\n                        builtBy: project.builtBy || []\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        return unifiedProjects;\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong> (\u6240\u6709\u8005: ${escapeHtml(item.details.owner)})<br>\r\n            <small>\u661F\u6807: ${escapeHtml(item.details.totalStars)} (\u4ECA\u65E5: ${escapeHtml(item.details.starsToday)}) | \u8BED\u8A00: ${escapeHtml(item.details.language || 'N/A')}</small>\r\n            \u63CF\u8FF0: ${escapeHtml(item.description) || 'N/A'}<br>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u5728 GitHub \u4E0A\u67E5\u770B</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default ProjectsDataSource;\r\n", "import { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, formatDateToChineseWithTime, escapeHtml } from '../helpers';\r\n\r\nconst PapersDataSource = {\r\n    type: 'papers',\r\n    async fetch(env, foloCookie) {\r\n        const hgPapersListId = env.HGPAPERS_LIST_ID;\r\n        const fetchPages = parseInt(env.HGPAPERS_FETCH_PAGES || '1', 10);\r\n        const allPaperItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!hgPapersListId) {\r\n            console.warn('HGPAPERS_LIST_ID is not set in environment variables. Skipping papers fetch.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"Aggregated Papers\",\r\n                home_page_url: \"https://example.com/papers\",\r\n                description: \"Aggregated papers from various sources\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                listId: hgPapersListId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching Papers data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch Papers data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allPaperItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: entry.feeds.title,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for Papers, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching Papers data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        return {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"Aggregated Papers\",\r\n            home_page_url: \"https://example.com/papers\",\r\n            description: \"Aggregated papers from various sources\",\r\n            language: \"zh-cn\",\r\n            items: allPaperItems\r\n        };\r\n    },\r\n\r\n    transform(rawData, sourceType) {\r\n        if (!rawData || !rawData.items) {\r\n            return [];\r\n        }\r\n\r\n        return rawData.items.map(item => ({\r\n            id: item.id,\r\n            type: sourceType,\r\n            url: item.url,\r\n            title: item.title,\r\n            description: stripHtml(item.content_html || \"\"),\r\n            published_date: item.date_published,\r\n            authors: item.authors ? item.authors.map(author => author.name).join(', ') : 'Unknown',\r\n            source: item.source || 'Aggregated Papers',\r\n            details: {\r\n                content_html: item.content_html || \"\"\r\n            }\r\n        }));\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">\r\n                 ${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}<hr>\r\n            </div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u5728 ArXiv/\u6765\u6E90 \u9605\u8BFB</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default PapersDataSource;", "import { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, formatDateToChineseWithTime, escapeHtml} from '../helpers';\r\n\r\nconst TwitterDataSource = {\r\n    async fetch(env, foloCookie) {\r\n        const listId = env.TWITTER_LIST_ID;\r\n        const fetchPages = parseInt(env.TWITTER_FETCH_PAGES || '3', 10);\r\n        const allTwitterItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!listId) {\r\n            console.error('TWITTER_LIST_ID is not set in environment variables.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"Twitter Feeds\",\r\n                home_page_url: \"https://x.com/\",\r\n                description: \"Aggregated Twitter feeds from various users\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            // \u76F4\u63A5\u4F7F\u7528\u4F20\u5165\u7684 foloCookie\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                listId: listId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching Twitter data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch Twitter data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allTwitterItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: entry.feeds.title && entry.feeds.title.startsWith('Twitter') ? `twitter-${entry.entries.author}` : `${entry.feeds.title} - ${entry.entries.author}` ,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for Twitter, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching Twitter data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            // Random wait time between 0 and 5 seconds to avoid rate limiting\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        return {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"Twitter Feeds\",\r\n            home_page_url: \"https://x.com/\",\r\n            description: \"Aggregated Twitter feeds from various users\",\r\n            language: \"zh-cn\",\r\n            items: allTwitterItems\r\n        };\r\n    },\r\n\r\n    transform(rawData, sourceType) {\r\n        if (!rawData || !rawData.items) {\r\n            return [];\r\n        }\r\n\r\n        return rawData.items.map(item => ({\r\n            id: item.id,\r\n            type: sourceType,\r\n            url: item.url,\r\n            title: item.title,\r\n            description: stripHtml(item.content_html || \"\"),\r\n            published_date: item.date_published,\r\n            authors: item.authors ? item.authors.map(author => author.name).join(', ') : 'Unknown',\r\n            source: item.source || 'twitter', // Use existing source or default\r\n            details: {\r\n                content_html: item.content_html || \"\"\r\n            }\r\n        }));\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">\r\n                ${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}\r\n            </div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u67E5\u770B\u63A8\u6587</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default TwitterDataSource;\r\n", "import { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, formatDateToChineseWithTime, escapeHtml} from '../helpers';\r\n\r\nconst RedditDataSource = {\r\n    async fetch(env, foloCookie) {\r\n        const listId = env.REDDIT_LIST_ID;\r\n        const fetchPages = parseInt(env.REDDIT_FETCH_PAGES || '3', 10);\r\n        const allRedditItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!listId) {\r\n            console.error('REDDIT_LIST_ID is not set in environment variables.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"Reddit Feeds\",\r\n                home_page_url: \"https://www.reddit.com/\",\r\n                description: \"Aggregated Reddit feeds from various subreddits/users\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                listId: listId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching Reddit data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch Reddit data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allRedditItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: `${entry.feeds.title}` ,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for Reddit, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching Reddit data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        const redditData = {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"Reddit Feeds\",\r\n            home_page_url: \"https://www.reddit.com/\",\r\n            description: \"Aggregated Reddit feeds from various subreddits/users\",\r\n            language: \"zh-cn\",\r\n            items: allRedditItems\r\n        };\r\n\r\n        if (redditData.items.length === 0) {\r\n            console.log(\"No reddit posts found for today or after filtering.\");\r\n            return redditData;\r\n        }\r\n\r\n        redditData.items = redditData.items.map(item => ({\r\n            ...item,\r\n            title_zh: item.title || \"\"\r\n        }));\r\n\r\n        return redditData;\r\n    },\r\n\r\n    transform(rawData, sourceType) {\r\n        if (!rawData || !rawData.items) {\r\n            return [];\r\n        }\r\n\r\n        return rawData.items.map(item => ({\r\n            id: item.id,\r\n            type: sourceType,\r\n            url: item.url,\r\n            title: item.title,\r\n            description: stripHtml(item.content_html || \"\"),\r\n            published_date: item.date_published,\r\n            authors: item.authors ? item.authors.map(author => author.name).join(', ') : 'Unknown',\r\n            source: item.source || 'reddit',\r\n            details: {\r\n                content_html: item.content_html || \"\"\r\n            }\r\n        }));\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">\r\n                ${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}\r\n            </div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u67E5\u770B Reddit \u5E16\u5B50</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default RedditDataSource;\r\n", "// src/dataFetchers.js\r\nimport NewsAggregatorDataSource from './dataSources/newsAggregator.js';\r\nimport GithubTrendingDataSource from './dataSources/github-trending.js';\r\nimport PapersDataSource from './dataSources/papers.js';\r\nimport TwitterDataSource from './dataSources/twitter.js';\r\nimport RedditDataSource from './dataSources/reddit.js';\r\n\r\n\r\n// Register data sources as arrays to support multiple sources per type\r\nexport const dataSources = {\r\n    news: { name: '\u65B0\u95FB', sources: [NewsAggregatorDataSource] },\r\n    project: { name: '\u9879\u76EE', sources: [GithubTrendingDataSource] },\r\n    paper: { name: '\u8BBA\u6587', sources: [PapersDataSource] },\r\n    socialMedia: { name: '\u793E\u4EA4\u5E73\u53F0', sources: [TwitterDataSource, RedditDataSource] },\r\n    // Add new data sources here as arrays, e.g.,\r\n    // newType: { name: '\u65B0\u7C7B\u578B', sources: [NewTypeDataSource1, NewTypeDataSource2] },\r\n};\r\n\r\n/**\r\n * Fetches and transforms data from all data sources for a specified type.\r\n * @param {string} sourceType - The type of data source (e.g., 'news', 'projects', 'papers').\r\n * @param {object} env - The environment variables.\r\n * @param {string} [foloCookie] - The Folo authentication cookie.\r\n * @returns {Promise<Array<object>>} A promise that resolves to an array of unified data objects from all sources of that type.\r\n */\r\nexport async function fetchAndTransformDataForType(sourceType, env, foloCookie) {\r\n    const sources = dataSources[sourceType].sources;\r\n    if (!sources || !Array.isArray(sources)) {\r\n        console.error(`No data sources registered for type: ${sourceType}`);\r\n        return [];\r\n    }\r\n\r\n    let allUnifiedDataForType = [];\r\n    for (const dataSource of sources) {\r\n        try {\r\n            // Pass foloCookie to the fetch method of the data source\r\n            const rawData = await dataSource.fetch(env, foloCookie);\r\n            const unifiedData = dataSource.transform(rawData, sourceType);\r\n            allUnifiedDataForType = allUnifiedDataForType.concat(unifiedData);\r\n        } catch (error) {\r\n            console.error(`Error fetching or transforming data from source ${dataSource.type} for type ${sourceType}:`, error.message);\r\n            // Continue to next data source even if one fails\r\n        }\r\n    }\r\n\r\n    // Sort by published_date in descending order for each type\r\n    allUnifiedDataForType.sort((a, b) => {\r\n        const dateA = new Date(a.published_date);\r\n        const dateB = new Date(b.published_date);\r\n        return dateB.getTime() - dateA.getTime();\r\n    });\r\n\r\n    return allUnifiedDataForType;\r\n}\r\n\r\n/**\r\n * Fetches and transforms data from all registered data sources across all types.\r\n * @param {object} env - The environment variables.\r\n * @param {string} [foloCookie] - The Folo authentication cookie.\r\n * @returns {Promise<object>} A promise that resolves to an object containing unified data for each source type.\r\n */\r\nexport async function fetchAllData(env, foloCookie) {\r\n    const allUnifiedData = {};\r\n    const fetchPromises = [];\r\n\r\n    for (const sourceType in dataSources) {\r\n        if (Object.hasOwnProperty.call(dataSources, sourceType)) {\r\n            fetchPromises.push(\r\n                fetchAndTransformDataForType(sourceType, env, foloCookie).then(data => {\r\n                    allUnifiedData[sourceType] = data;\r\n                })\r\n            );\r\n        }\r\n    }\r\n    await Promise.allSettled(fetchPromises); // Use allSettled to ensure all promises complete\r\n    return allUnifiedData;\r\n}\r\n\r\n/**\r\n * Fetches and transforms data from all data sources for a specific category.\r\n * @param {object} env - The environment variables.\r\n * @param {string} category - The category to fetch data for (e.g., 'news', 'project', 'paper', 'twitter').\r\n * @param {string} [foloCookie] - The Folo authentication cookie.\r\n * @returns {Promise<Array<object>>} A promise that resolves to an array of unified data objects for the specified category.\r\n */\r\nexport async function fetchDataByCategory(env, category, foloCookie) {\r\n    if (!dataSources[category]) {\r\n        console.warn(`Attempted to fetch data for unknown category: ${category}`);\r\n        return [];\r\n    }\r\n    return await fetchAndTransformDataForType(category, env, foloCookie);\r\n}\r\n", "// src/kv.js\r\n\r\nexport async function storeInKV(kvNamespace, key, value, expirationTtl = 86400 * 7) { // 7 days default\r\n    console.log(`Storing data in KV with key: ${key}`);\r\n    await kvNamespace.put(key, JSON.stringify(value), { expirationTtl });\r\n}\r\n\r\nexport async function getFromKV(kvNamespace, key) {\r\n    console.log(`Retrieving data from KV with key: ${key}`);\r\n    const value = await kvNamespace.get(key);\r\n    return value ? JSON.parse(value) : null;\r\n}", "// src/handlers/writeData.js\r\nimport { getISODate, getFetchDate } from '../helpers.js';\r\nimport { fetchAllData, fetchDataByCategory, dataSources } from '../dataFetchers.js'; // \u5BFC\u5165 fetchDataByCategory \u548C dataSources\r\nimport { storeInKV } from '../kv.js';\r\n\r\nexport async function handleWriteData(request, env) {\r\n    const dateParam = getFetchDate();\r\n    const dateStr = dateParam ? dateParam : getISODate();\r\n    console.log(`Starting /writeData process for date: ${dateStr}`);\r\n    let category = null;\r\n    let foloCookie = null;\r\n    \r\n    try {\r\n        // \u5C1D\u8BD5\u89E3\u6790\u8BF7\u6C42\u4F53\uFF0C\u83B7\u53D6 category \u53C2\u6570\r\n        if (request.headers.get('Content-Type')?.includes('application/json')) {\r\n            const requestBody = await request.json();\r\n            category = requestBody.category;\r\n            foloCookie = requestBody.foloCookie; // \u83B7\u53D6 foloCookie\r\n        }\r\n\r\n        console.log(`Starting /writeData process for category: ${category || 'all'} with foloCookie presence: ${!!foloCookie}`);\r\n\r\n        let dataToStore = {};\r\n        let fetchPromises = [];\r\n        let successMessage = '';\r\n\r\n        if (category) {\r\n            // \u53EA\u6293\u53D6\u6307\u5B9A\u5206\u7C7B\u7684\u6570\u636E\r\n            const fetchedData = await fetchDataByCategory(env, category, foloCookie); // \u4F20\u9012 foloCookie\r\n            dataToStore[category] = fetchedData;\r\n            fetchPromises.push(storeInKV(env.DATA_KV, `${dateStr}-${category}`, fetchedData));\r\n            successMessage = `Data for category '${category}' fetched and stored.`;\r\n            console.log(`Transformed ${category}: ${fetchedData.length} items.`);\r\n        } else {\r\n            // \u6293\u53D6\u6240\u6709\u5206\u7C7B\u7684\u6570\u636E (\u73B0\u6709\u903B\u8F91)\r\n            const allUnifiedData = await fetchAllData(env, foloCookie); // \u4F20\u9012 foloCookie\r\n            \r\n            for (const sourceType in dataSources) {\r\n                if (Object.hasOwnProperty.call(dataSources, sourceType)) {\r\n                    dataToStore[sourceType] = allUnifiedData[sourceType] || [];\r\n                    fetchPromises.push(storeInKV(env.DATA_KV, `${dateStr}-${sourceType}`, dataToStore[sourceType]));\r\n                    console.log(`Transformed ${sourceType}: ${dataToStore[sourceType].length} items.`);\r\n                }\r\n            }\r\n            successMessage = `All data categories fetched and stored.`;\r\n        }\r\n\r\n        await Promise.all(fetchPromises);\r\n\r\n        const errors = []; // Placeholder for potential future error aggregation from fetchAllData or fetchDataByCategory\r\n\r\n        if (errors.length > 0) {\r\n            console.warn(\"/writeData completed with errors:\", errors);\r\n            return new Response(JSON.stringify({ \r\n                success: false, \r\n                message: `${successMessage} Some errors occurred.`, \r\n                errors: errors, \r\n                ...Object.fromEntries(Object.entries(dataToStore).map(([key, value]) => [`${key}ItemCount`, value.length]))\r\n            }), {\r\n                status: 200, headers: { 'Content-Type': 'application/json' }\r\n            });\r\n        } else {\r\n            console.log(\"/writeData process completed successfully.\");\r\n            return new Response(JSON.stringify({ \r\n                success: true, \r\n                message: successMessage,\r\n                ...Object.fromEntries(Object.entries(dataToStore).map(([key, value]) => [`${key}ItemCount`, value.length]))\r\n            }), {\r\n                headers: { 'Content-Type': 'application/json' }\r\n            });\r\n        }\r\n    } catch (error) {\r\n        console.error(\"Unhandled error in /writeData:\", error);\r\n        return new Response(JSON.stringify({ success: false, message: \"An unhandled error occurred during data processing.\", error: error.message, details: error.stack }), {\r\n            status: 500, headers: { 'Content-Type': 'application/json' }\r\n        });\r\n    }\r\n}\r\n", "// src/handlers/getContent.js\r\nimport { getISODate } from '../helpers.js';\r\nimport { getFromKV } from '../kv.js';\r\nimport { dataSources } from '../dataFetchers.js'; // Import dataSources\r\n\r\nexport async function handleGetContent(request, env) {\r\n    const url = new URL(request.url);\r\n    const dateParam = url.searchParams.get('date');\r\n    const dateStr = dateParam ? dateParam : getISODate();\r\n    console.log(`Getting content for date: ${dateStr}`);\r\n    try {\r\n        const responseData = {\r\n            date: dateStr,\r\n            message: `Successfully retrieved data for ${dateStr}.`\r\n        };\r\n\r\n        const fetchPromises = [];\r\n        for (const sourceType in dataSources) {\r\n            if (Object.hasOwnProperty.call(dataSources, sourceType)) {\r\n                fetchPromises.push(\r\n                    getFromKV(env.DATA_KV, `${dateStr}-${sourceType}`).then(data => {\r\n                        responseData[sourceType] = data || [];\r\n                    })\r\n                );\r\n            }\r\n        }\r\n        await Promise.allSettled(fetchPromises);\r\n        \r\n        return new Response(JSON.stringify(responseData), { headers: { 'Content-Type': 'application/json' } });\r\n    } catch (error) {\r\n        console.error(\"Error in /getContent:\", error);\r\n        return new Response(JSON.stringify({ success: false, message: \"Failed to get content.\", error: error.message, date: dateStr }), {\r\n            status: 500, headers: { 'Content-Type': 'application/json' }\r\n        });\r\n    }\r\n}\r\n", "/**\r\n * marked v15.0.12 - a markdown parser\r\n * Copyright (c) 2011-2025, Christopher Jeffrey. (MIT Licensed)\r\n * https://github.com/markedjs/marked\r\n */\r\n\r\n/**\r\n * DO NOT EDIT THIS FILE\r\n * The code in this file is generated from files in ./src/\r\n */\r\n\r\n\r\n// src/defaults.ts\r\nfunction _getDefaults() {\r\n  return {\r\n    async: false,\r\n    breaks: false,\r\n    extensions: null,\r\n    gfm: true,\r\n    hooks: null,\r\n    pedantic: false,\r\n    renderer: null,\r\n    silent: false,\r\n    tokenizer: null,\r\n    walkTokens: null\r\n  };\r\n}\r\nvar _defaults = _getDefaults();\r\nfunction changeDefaults(newDefaults) {\r\n  _defaults = newDefaults;\r\n}\r\n\r\n// src/rules.ts\r\nvar noopTest = { exec: () => null };\r\nfunction edit(regex, opt = \"\") {\r\n  let source = typeof regex === \"string\" ? regex : regex.source;\r\n  const obj = {\r\n    replace: (name, val) => {\r\n      let valSource = typeof val === \"string\" ? val : val.source;\r\n      valSource = valSource.replace(other.caret, \"$1\");\r\n      source = source.replace(name, valSource);\r\n      return obj;\r\n    },\r\n    getRegex: () => {\r\n      return new RegExp(source, opt);\r\n    }\r\n  };\r\n  return obj;\r\n}\r\nvar other = {\r\n  codeRemoveIndent: /^(?: {1,4}| {0,3}\\t)/gm,\r\n  outputLinkReplace: /\\\\([\\[\\]])/g,\r\n  indentCodeCompensation: /^(\\s+)(?:```)/,\r\n  beginningSpace: /^\\s+/,\r\n  endingHash: /#$/,\r\n  startingSpaceChar: /^ /,\r\n  endingSpaceChar: / $/,\r\n  nonSpaceChar: /[^ ]/,\r\n  newLineCharGlobal: /\\n/g,\r\n  tabCharGlobal: /\\t/g,\r\n  multipleSpaceGlobal: /\\s+/g,\r\n  blankLine: /^[ \\t]*$/,\r\n  doubleBlankLine: /\\n[ \\t]*\\n[ \\t]*$/,\r\n  blockquoteStart: /^ {0,3}>/,\r\n  blockquoteSetextReplace: /\\n {0,3}((?:=+|-+) *)(?=\\n|$)/g,\r\n  blockquoteSetextReplace2: /^ {0,3}>[ \\t]?/gm,\r\n  listReplaceTabs: /^\\t+/,\r\n  listReplaceNesting: /^ {1,4}(?=( {4})*[^ ])/g,\r\n  listIsTask: /^\\[[ xX]\\] /,\r\n  listReplaceTask: /^\\[[ xX]\\] +/,\r\n  anyLine: /\\n.*\\n/,\r\n  hrefBrackets: /^<(.*)>$/,\r\n  tableDelimiter: /[:|]/,\r\n  tableAlignChars: /^\\||\\| *$/g,\r\n  tableRowBlankLine: /\\n[ \\t]*$/,\r\n  tableAlignRight: /^ *-+: *$/,\r\n  tableAlignCenter: /^ *:-+: *$/,\r\n  tableAlignLeft: /^ *:-+ *$/,\r\n  startATag: /^<a /i,\r\n  endATag: /^<\\/a>/i,\r\n  startPreScriptTag: /^<(pre|code|kbd|script)(\\s|>)/i,\r\n  endPreScriptTag: /^<\\/(pre|code|kbd|script)(\\s|>)/i,\r\n  startAngleBracket: /^</,\r\n  endAngleBracket: />$/,\r\n  pedanticHrefTitle: /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/,\r\n  unicodeAlphaNumeric: /[\\p{L}\\p{N}]/u,\r\n  escapeTest: /[&<>\"']/,\r\n  escapeReplace: /[&<>\"']/g,\r\n  escapeTestNoEncode: /[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/,\r\n  escapeReplaceNoEncode: /[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/g,\r\n  unescapeTest: /&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig,\r\n  caret: /(^|[^\\[])\\^/g,\r\n  percentDecode: /%25/g,\r\n  findPipe: /\\|/g,\r\n  splitPipe: / \\|/,\r\n  slashPipe: /\\\\\\|/g,\r\n  carriageReturn: /\\r\\n|\\r/g,\r\n  spaceLine: /^ +$/gm,\r\n  notSpaceStart: /^\\S*/,\r\n  endingNewline: /\\n$/,\r\n  listItemRegex: (bull) => new RegExp(`^( {0,3}${bull})((?:[\t ][^\\\\n]*)?(?:\\\\n|$))`),\r\n  nextBulletRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:[*+-]|\\\\d{1,9}[.)])((?:[ \t][^\\\\n]*)?(?:\\\\n|$))`),\r\n  hrRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$)`),\r\n  fencesBeginRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:\\`\\`\\`|~~~)`),\r\n  headingBeginRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}#`),\r\n  htmlBeginRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}<(?:[a-z].*>|!--)`, \"i\")\r\n};\r\nvar newline = /^(?:[ \\t]*(?:\\n|$))+/;\r\nvar blockCode = /^((?: {4}| {0,3}\\t)[^\\n]+(?:\\n(?:[ \\t]*(?:\\n|$))*)?)+/;\r\nvar fences = /^ {0,3}(`{3,}(?=[^`\\n]*(?:\\n|$))|~{3,})([^\\n]*)(?:\\n|$)(?:|([\\s\\S]*?)(?:\\n|$))(?: {0,3}\\1[~`]* *(?=\\n|$)|$)/;\r\nvar hr = /^ {0,3}((?:-[\\t ]*){3,}|(?:_[ \\t]*){3,}|(?:\\*[ \\t]*){3,})(?:\\n+|$)/;\r\nvar heading = /^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/;\r\nvar bullet = /(?:[*+-]|\\d{1,9}[.)])/;\r\nvar lheadingCore = /^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\\n(?!\\s*?\\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/;\r\nvar lheading = edit(lheadingCore).replace(/bull/g, bullet).replace(/blockCode/g, /(?: {4}| {0,3}\\t)/).replace(/fences/g, / {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g, / {0,3}>/).replace(/heading/g, / {0,3}#{1,6}/).replace(/html/g, / {0,3}<[^\\n>]+>\\n/).replace(/\\|table/g, \"\").getRegex();\r\nvar lheadingGfm = edit(lheadingCore).replace(/bull/g, bullet).replace(/blockCode/g, /(?: {4}| {0,3}\\t)/).replace(/fences/g, / {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g, / {0,3}>/).replace(/heading/g, / {0,3}#{1,6}/).replace(/html/g, / {0,3}<[^\\n>]+>\\n/).replace(/table/g, / {0,3}\\|?(?:[:\\- ]*\\|)+[\\:\\- ]*\\n/).getRegex();\r\nvar _paragraph = /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\\n)[^\\n]+)*)/;\r\nvar blockText = /^[^\\n]+/;\r\nvar _blockLabel = /(?!\\s*\\])(?:\\\\.|[^\\[\\]\\\\])+/;\r\nvar def = edit(/^ {0,3}\\[(label)\\]: *(?:\\n[ \\t]*)?([^<\\s][^\\s]*|<.*?>)(?:(?: +(?:\\n[ \\t]*)?| *\\n[ \\t]*)(title))? *(?:\\n+|$)/).replace(\"label\", _blockLabel).replace(\"title\", /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/).getRegex();\r\nvar list = edit(/^( {0,3}bull)([ \\t][^\\n]+?)?(?:\\n|$)/).replace(/bull/g, bullet).getRegex();\r\nvar _tag = \"address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul\";\r\nvar _comment = /<!--(?:-?>|[\\s\\S]*?(?:-->|$))/;\r\nvar html = edit(\r\n  \"^ {0,3}(?:<(script|pre|style|textarea)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)|comment[^\\\\n]*(\\\\n+|$)|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:(?:\\\\n[ \t]*)+\\\\n|$)|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n[ \t]*)+\\\\n|$)|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n[ \t]*)+\\\\n|$))\",\r\n  \"i\"\r\n).replace(\"comment\", _comment).replace(\"tag\", _tag).replace(\"attribute\", / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/).getRegex();\r\nvar paragraph = edit(_paragraph).replace(\"hr\", hr).replace(\"heading\", \" {0,3}#{1,6}(?:\\\\s|$)\").replace(\"|lheading\", \"\").replace(\"|table\", \"\").replace(\"blockquote\", \" {0,3}>\").replace(\"fences\", \" {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n\").replace(\"list\", \" {0,3}(?:[*+-]|1[.)]) \").replace(\"html\", \"</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)\").replace(\"tag\", _tag).getRegex();\r\nvar blockquote = edit(/^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/).replace(\"paragraph\", paragraph).getRegex();\r\nvar blockNormal = {\r\n  blockquote,\r\n  code: blockCode,\r\n  def,\r\n  fences,\r\n  heading,\r\n  hr,\r\n  html,\r\n  lheading,\r\n  list,\r\n  newline,\r\n  paragraph,\r\n  table: noopTest,\r\n  text: blockText\r\n};\r\nvar gfmTable = edit(\r\n  \"^ *([^\\\\n ].*)\\\\n {0,3}((?:\\\\| *)?:?-+:? *(?:\\\\| *:?-+:? *)*(?:\\\\| *)?)(?:\\\\n((?:(?! *\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)\"\r\n).replace(\"hr\", hr).replace(\"heading\", \" {0,3}#{1,6}(?:\\\\s|$)\").replace(\"blockquote\", \" {0,3}>\").replace(\"code\", \"(?: {4}| {0,3}\t)[^\\\\n]\").replace(\"fences\", \" {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n\").replace(\"list\", \" {0,3}(?:[*+-]|1[.)]) \").replace(\"html\", \"</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)\").replace(\"tag\", _tag).getRegex();\r\nvar blockGfm = {\r\n  ...blockNormal,\r\n  lheading: lheadingGfm,\r\n  table: gfmTable,\r\n  paragraph: edit(_paragraph).replace(\"hr\", hr).replace(\"heading\", \" {0,3}#{1,6}(?:\\\\s|$)\").replace(\"|lheading\", \"\").replace(\"table\", gfmTable).replace(\"blockquote\", \" {0,3}>\").replace(\"fences\", \" {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n\").replace(\"list\", \" {0,3}(?:[*+-]|1[.)]) \").replace(\"html\", \"</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)\").replace(\"tag\", _tag).getRegex()\r\n};\r\nvar blockPedantic = {\r\n  ...blockNormal,\r\n  html: edit(\r\n    `^ *(?:comment *(?:\\\\n|\\\\s*$)|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\\\s[^'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))`\r\n  ).replace(\"comment\", _comment).replace(/tag/g, \"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b\").getRegex(),\r\n  def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\r\n  heading: /^(#{1,6})(.*)(?:\\n+|$)/,\r\n  fences: noopTest,\r\n  // fences not supported\r\n  lheading: /^(.+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\r\n  paragraph: edit(_paragraph).replace(\"hr\", hr).replace(\"heading\", \" *#{1,6} *[^\\n]\").replace(\"lheading\", lheading).replace(\"|table\", \"\").replace(\"blockquote\", \" {0,3}>\").replace(\"|fences\", \"\").replace(\"|list\", \"\").replace(\"|html\", \"\").replace(\"|tag\", \"\").getRegex()\r\n};\r\nvar escape = /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/;\r\nvar inlineCode = /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/;\r\nvar br = /^( {2,}|\\\\)\\n(?!\\s*$)/;\r\nvar inlineText = /^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/;\r\nvar _punctuation = /[\\p{P}\\p{S}]/u;\r\nvar _punctuationOrSpace = /[\\s\\p{P}\\p{S}]/u;\r\nvar _notPunctuationOrSpace = /[^\\s\\p{P}\\p{S}]/u;\r\nvar punctuation = edit(/^((?![*_])punctSpace)/, \"u\").replace(/punctSpace/g, _punctuationOrSpace).getRegex();\r\nvar _punctuationGfmStrongEm = /(?!~)[\\p{P}\\p{S}]/u;\r\nvar _punctuationOrSpaceGfmStrongEm = /(?!~)[\\s\\p{P}\\p{S}]/u;\r\nvar _notPunctuationOrSpaceGfmStrongEm = /(?:[^\\s\\p{P}\\p{S}]|~)/u;\r\nvar blockSkip = /\\[[^[\\]]*?\\]\\((?:\\\\.|[^\\\\\\(\\)]|\\((?:\\\\.|[^\\\\\\(\\)])*\\))*\\)|`[^`]*?`|<[^<>]*?>/g;\r\nvar emStrongLDelimCore = /^(?:\\*+(?:((?!\\*)punct)|[^\\s*]))|^_+(?:((?!_)punct)|([^\\s_]))/;\r\nvar emStrongLDelim = edit(emStrongLDelimCore, \"u\").replace(/punct/g, _punctuation).getRegex();\r\nvar emStrongLDelimGfm = edit(emStrongLDelimCore, \"u\").replace(/punct/g, _punctuationGfmStrongEm).getRegex();\r\nvar emStrongRDelimAstCore = \"^[^_*]*?__[^_*]*?\\\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\\\*)punct(\\\\*+)(?=[\\\\s]|$)|notPunctSpace(\\\\*+)(?!\\\\*)(?=punctSpace|$)|(?!\\\\*)punctSpace(\\\\*+)(?=notPunctSpace)|[\\\\s](\\\\*+)(?!\\\\*)(?=punct)|(?!\\\\*)punct(\\\\*+)(?!\\\\*)(?=punct)|notPunctSpace(\\\\*+)(?=notPunctSpace)\";\r\nvar emStrongRDelimAst = edit(emStrongRDelimAstCore, \"gu\").replace(/notPunctSpace/g, _notPunctuationOrSpace).replace(/punctSpace/g, _punctuationOrSpace).replace(/punct/g, _punctuation).getRegex();\r\nvar emStrongRDelimAstGfm = edit(emStrongRDelimAstCore, \"gu\").replace(/notPunctSpace/g, _notPunctuationOrSpaceGfmStrongEm).replace(/punctSpace/g, _punctuationOrSpaceGfmStrongEm).replace(/punct/g, _punctuationGfmStrongEm).getRegex();\r\nvar emStrongRDelimUnd = edit(\r\n  \"^[^_*]*?\\\\*\\\\*[^_*]*?_[^_*]*?(?=\\\\*\\\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)\",\r\n  \"gu\"\r\n).replace(/notPunctSpace/g, _notPunctuationOrSpace).replace(/punctSpace/g, _punctuationOrSpace).replace(/punct/g, _punctuation).getRegex();\r\nvar anyPunctuation = edit(/\\\\(punct)/, \"gu\").replace(/punct/g, _punctuation).getRegex();\r\nvar autolink = edit(/^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/).replace(\"scheme\", /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace(\"email\", /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex();\r\nvar _inlineComment = edit(_comment).replace(\"(?:-->|$)\", \"-->\").getRegex();\r\nvar tag = edit(\r\n  \"^comment|^</[a-zA-Z][\\\\w:-]*\\\\s*>|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>|^<\\\\?[\\\\s\\\\S]*?\\\\?>|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>\"\r\n).replace(\"comment\", _inlineComment).replace(\"attribute\", /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/).getRegex();\r\nvar _inlineLabel = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\r\nvar link = edit(/^!?\\[(label)\\]\\(\\s*(href)(?:(?:[ \\t]*(?:\\n[ \\t]*)?)(title))?\\s*\\)/).replace(\"label\", _inlineLabel).replace(\"href\", /<(?:\\\\.|[^\\n<>\\\\])+>|[^ \\t\\n\\x00-\\x1f]*/).replace(\"title\", /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/).getRegex();\r\nvar reflink = edit(/^!?\\[(label)\\]\\[(ref)\\]/).replace(\"label\", _inlineLabel).replace(\"ref\", _blockLabel).getRegex();\r\nvar nolink = edit(/^!?\\[(ref)\\](?:\\[\\])?/).replace(\"ref\", _blockLabel).getRegex();\r\nvar reflinkSearch = edit(\"reflink|nolink(?!\\\\()\", \"g\").replace(\"reflink\", reflink).replace(\"nolink\", nolink).getRegex();\r\nvar inlineNormal = {\r\n  _backpedal: noopTest,\r\n  // only used for GFM url\r\n  anyPunctuation,\r\n  autolink,\r\n  blockSkip,\r\n  br,\r\n  code: inlineCode,\r\n  del: noopTest,\r\n  emStrongLDelim,\r\n  emStrongRDelimAst,\r\n  emStrongRDelimUnd,\r\n  escape,\r\n  link,\r\n  nolink,\r\n  punctuation,\r\n  reflink,\r\n  reflinkSearch,\r\n  tag,\r\n  text: inlineText,\r\n  url: noopTest\r\n};\r\nvar inlinePedantic = {\r\n  ...inlineNormal,\r\n  link: edit(/^!?\\[(label)\\]\\((.*?)\\)/).replace(\"label\", _inlineLabel).getRegex(),\r\n  reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/).replace(\"label\", _inlineLabel).getRegex()\r\n};\r\nvar inlineGfm = {\r\n  ...inlineNormal,\r\n  emStrongRDelimAst: emStrongRDelimAstGfm,\r\n  emStrongLDelim: emStrongLDelimGfm,\r\n  url: edit(/^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/, \"i\").replace(\"email\", /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),\r\n  _backpedal: /(?:[^?!.,:;*_'\"~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'\"~)]+(?!$))+/,\r\n  del: /^(~~?)(?=[^\\s~])((?:\\\\.|[^\\\\])*?(?:\\\\.|[^\\s~\\\\]))\\1(?=[^~]|$)/,\r\n  text: /^([`~]+|[^`~])(?:(?= {2,}\\n)|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)))/\r\n};\r\nvar inlineBreaks = {\r\n  ...inlineGfm,\r\n  br: edit(br).replace(\"{2,}\", \"*\").getRegex(),\r\n  text: edit(inlineGfm.text).replace(\"\\\\b_\", \"\\\\b_| {2,}\\\\n\").replace(/\\{2,\\}/g, \"*\").getRegex()\r\n};\r\nvar block = {\r\n  normal: blockNormal,\r\n  gfm: blockGfm,\r\n  pedantic: blockPedantic\r\n};\r\nvar inline = {\r\n  normal: inlineNormal,\r\n  gfm: inlineGfm,\r\n  breaks: inlineBreaks,\r\n  pedantic: inlinePedantic\r\n};\r\n\r\n// src/helpers.ts\r\nvar escapeReplacements = {\r\n  \"&\": \"&amp;\",\r\n  \"<\": \"&lt;\",\r\n  \">\": \"&gt;\",\r\n  '\"': \"&quot;\",\r\n  \"'\": \"&#39;\"\r\n};\r\nvar getEscapeReplacement = (ch) => escapeReplacements[ch];\r\nfunction escape2(html2, encode) {\r\n  if (encode) {\r\n    if (other.escapeTest.test(html2)) {\r\n      return html2.replace(other.escapeReplace, getEscapeReplacement);\r\n    }\r\n  } else {\r\n    if (other.escapeTestNoEncode.test(html2)) {\r\n      return html2.replace(other.escapeReplaceNoEncode, getEscapeReplacement);\r\n    }\r\n  }\r\n  return html2;\r\n}\r\nfunction cleanUrl(href) {\r\n  try {\r\n    href = encodeURI(href).replace(other.percentDecode, \"%\");\r\n  } catch {\r\n    return null;\r\n  }\r\n  return href;\r\n}\r\nfunction splitCells(tableRow, count) {\r\n  const row = tableRow.replace(other.findPipe, (match, offset, str) => {\r\n    let escaped = false;\r\n    let curr = offset;\r\n    while (--curr >= 0 && str[curr] === \"\\\\\") escaped = !escaped;\r\n    if (escaped) {\r\n      return \"|\";\r\n    } else {\r\n      return \" |\";\r\n    }\r\n  }), cells = row.split(other.splitPipe);\r\n  let i = 0;\r\n  if (!cells[0].trim()) {\r\n    cells.shift();\r\n  }\r\n  if (cells.length > 0 && !cells.at(-1)?.trim()) {\r\n    cells.pop();\r\n  }\r\n  if (count) {\r\n    if (cells.length > count) {\r\n      cells.splice(count);\r\n    } else {\r\n      while (cells.length < count) cells.push(\"\");\r\n    }\r\n  }\r\n  for (; i < cells.length; i++) {\r\n    cells[i] = cells[i].trim().replace(other.slashPipe, \"|\");\r\n  }\r\n  return cells;\r\n}\r\nfunction rtrim(str, c, invert) {\r\n  const l = str.length;\r\n  if (l === 0) {\r\n    return \"\";\r\n  }\r\n  let suffLen = 0;\r\n  while (suffLen < l) {\r\n    const currChar = str.charAt(l - suffLen - 1);\r\n    if (currChar === c && !invert) {\r\n      suffLen++;\r\n    } else if (currChar !== c && invert) {\r\n      suffLen++;\r\n    } else {\r\n      break;\r\n    }\r\n  }\r\n  return str.slice(0, l - suffLen);\r\n}\r\nfunction findClosingBracket(str, b) {\r\n  if (str.indexOf(b[1]) === -1) {\r\n    return -1;\r\n  }\r\n  let level = 0;\r\n  for (let i = 0; i < str.length; i++) {\r\n    if (str[i] === \"\\\\\") {\r\n      i++;\r\n    } else if (str[i] === b[0]) {\r\n      level++;\r\n    } else if (str[i] === b[1]) {\r\n      level--;\r\n      if (level < 0) {\r\n        return i;\r\n      }\r\n    }\r\n  }\r\n  if (level > 0) {\r\n    return -2;\r\n  }\r\n  return -1;\r\n}\r\n\r\n// src/Tokenizer.ts\r\nfunction outputLink(cap, link2, raw, lexer2, rules) {\r\n  const href = link2.href;\r\n  const title = link2.title || null;\r\n  const text = cap[1].replace(rules.other.outputLinkReplace, \"$1\");\r\n  lexer2.state.inLink = true;\r\n  const token = {\r\n    type: cap[0].charAt(0) === \"!\" ? \"image\" : \"link\",\r\n    raw,\r\n    href,\r\n    title,\r\n    text,\r\n    tokens: lexer2.inlineTokens(text)\r\n  };\r\n  lexer2.state.inLink = false;\r\n  return token;\r\n}\r\nfunction indentCodeCompensation(raw, text, rules) {\r\n  const matchIndentToCode = raw.match(rules.other.indentCodeCompensation);\r\n  if (matchIndentToCode === null) {\r\n    return text;\r\n  }\r\n  const indentToCode = matchIndentToCode[1];\r\n  return text.split(\"\\n\").map((node) => {\r\n    const matchIndentInNode = node.match(rules.other.beginningSpace);\r\n    if (matchIndentInNode === null) {\r\n      return node;\r\n    }\r\n    const [indentInNode] = matchIndentInNode;\r\n    if (indentInNode.length >= indentToCode.length) {\r\n      return node.slice(indentToCode.length);\r\n    }\r\n    return node;\r\n  }).join(\"\\n\");\r\n}\r\nvar _Tokenizer = class {\r\n  options;\r\n  rules;\r\n  // set by the lexer\r\n  lexer;\r\n  // set by the lexer\r\n  constructor(options2) {\r\n    this.options = options2 || _defaults;\r\n  }\r\n  space(src) {\r\n    const cap = this.rules.block.newline.exec(src);\r\n    if (cap && cap[0].length > 0) {\r\n      return {\r\n        type: \"space\",\r\n        raw: cap[0]\r\n      };\r\n    }\r\n  }\r\n  code(src) {\r\n    const cap = this.rules.block.code.exec(src);\r\n    if (cap) {\r\n      const text = cap[0].replace(this.rules.other.codeRemoveIndent, \"\");\r\n      return {\r\n        type: \"code\",\r\n        raw: cap[0],\r\n        codeBlockStyle: \"indented\",\r\n        text: !this.options.pedantic ? rtrim(text, \"\\n\") : text\r\n      };\r\n    }\r\n  }\r\n  fences(src) {\r\n    const cap = this.rules.block.fences.exec(src);\r\n    if (cap) {\r\n      const raw = cap[0];\r\n      const text = indentCodeCompensation(raw, cap[3] || \"\", this.rules);\r\n      return {\r\n        type: \"code\",\r\n        raw,\r\n        lang: cap[2] ? cap[2].trim().replace(this.rules.inline.anyPunctuation, \"$1\") : cap[2],\r\n        text\r\n      };\r\n    }\r\n  }\r\n  heading(src) {\r\n    const cap = this.rules.block.heading.exec(src);\r\n    if (cap) {\r\n      let text = cap[2].trim();\r\n      if (this.rules.other.endingHash.test(text)) {\r\n        const trimmed = rtrim(text, \"#\");\r\n        if (this.options.pedantic) {\r\n          text = trimmed.trim();\r\n        } else if (!trimmed || this.rules.other.endingSpaceChar.test(trimmed)) {\r\n          text = trimmed.trim();\r\n        }\r\n      }\r\n      return {\r\n        type: \"heading\",\r\n        raw: cap[0],\r\n        depth: cap[1].length,\r\n        text,\r\n        tokens: this.lexer.inline(text)\r\n      };\r\n    }\r\n  }\r\n  hr(src) {\r\n    const cap = this.rules.block.hr.exec(src);\r\n    if (cap) {\r\n      return {\r\n        type: \"hr\",\r\n        raw: rtrim(cap[0], \"\\n\")\r\n      };\r\n    }\r\n  }\r\n  blockquote(src) {\r\n    const cap = this.rules.block.blockquote.exec(src);\r\n    if (cap) {\r\n      let lines = rtrim(cap[0], \"\\n\").split(\"\\n\");\r\n      let raw = \"\";\r\n      let text = \"\";\r\n      const tokens = [];\r\n      while (lines.length > 0) {\r\n        let inBlockquote = false;\r\n        const currentLines = [];\r\n        let i;\r\n        for (i = 0; i < lines.length; i++) {\r\n          if (this.rules.other.blockquoteStart.test(lines[i])) {\r\n            currentLines.push(lines[i]);\r\n            inBlockquote = true;\r\n          } else if (!inBlockquote) {\r\n            currentLines.push(lines[i]);\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        lines = lines.slice(i);\r\n        const currentRaw = currentLines.join(\"\\n\");\r\n        const currentText = currentRaw.replace(this.rules.other.blockquoteSetextReplace, \"\\n    $1\").replace(this.rules.other.blockquoteSetextReplace2, \"\");\r\n        raw = raw ? `${raw}\r\n${currentRaw}` : currentRaw;\r\n        text = text ? `${text}\r\n${currentText}` : currentText;\r\n        const top = this.lexer.state.top;\r\n        this.lexer.state.top = true;\r\n        this.lexer.blockTokens(currentText, tokens, true);\r\n        this.lexer.state.top = top;\r\n        if (lines.length === 0) {\r\n          break;\r\n        }\r\n        const lastToken = tokens.at(-1);\r\n        if (lastToken?.type === \"code\") {\r\n          break;\r\n        } else if (lastToken?.type === \"blockquote\") {\r\n          const oldToken = lastToken;\r\n          const newText = oldToken.raw + \"\\n\" + lines.join(\"\\n\");\r\n          const newToken = this.blockquote(newText);\r\n          tokens[tokens.length - 1] = newToken;\r\n          raw = raw.substring(0, raw.length - oldToken.raw.length) + newToken.raw;\r\n          text = text.substring(0, text.length - oldToken.text.length) + newToken.text;\r\n          break;\r\n        } else if (lastToken?.type === \"list\") {\r\n          const oldToken = lastToken;\r\n          const newText = oldToken.raw + \"\\n\" + lines.join(\"\\n\");\r\n          const newToken = this.list(newText);\r\n          tokens[tokens.length - 1] = newToken;\r\n          raw = raw.substring(0, raw.length - lastToken.raw.length) + newToken.raw;\r\n          text = text.substring(0, text.length - oldToken.raw.length) + newToken.raw;\r\n          lines = newText.substring(tokens.at(-1).raw.length).split(\"\\n\");\r\n          continue;\r\n        }\r\n      }\r\n      return {\r\n        type: \"blockquote\",\r\n        raw,\r\n        tokens,\r\n        text\r\n      };\r\n    }\r\n  }\r\n  list(src) {\r\n    let cap = this.rules.block.list.exec(src);\r\n    if (cap) {\r\n      let bull = cap[1].trim();\r\n      const isordered = bull.length > 1;\r\n      const list2 = {\r\n        type: \"list\",\r\n        raw: \"\",\r\n        ordered: isordered,\r\n        start: isordered ? +bull.slice(0, -1) : \"\",\r\n        loose: false,\r\n        items: []\r\n      };\r\n      bull = isordered ? `\\\\d{1,9}\\\\${bull.slice(-1)}` : `\\\\${bull}`;\r\n      if (this.options.pedantic) {\r\n        bull = isordered ? bull : \"[*+-]\";\r\n      }\r\n      const itemRegex = this.rules.other.listItemRegex(bull);\r\n      let endsWithBlankLine = false;\r\n      while (src) {\r\n        let endEarly = false;\r\n        let raw = \"\";\r\n        let itemContents = \"\";\r\n        if (!(cap = itemRegex.exec(src))) {\r\n          break;\r\n        }\r\n        if (this.rules.block.hr.test(src)) {\r\n          break;\r\n        }\r\n        raw = cap[0];\r\n        src = src.substring(raw.length);\r\n        let line = cap[2].split(\"\\n\", 1)[0].replace(this.rules.other.listReplaceTabs, (t) => \" \".repeat(3 * t.length));\r\n        let nextLine = src.split(\"\\n\", 1)[0];\r\n        let blankLine = !line.trim();\r\n        let indent = 0;\r\n        if (this.options.pedantic) {\r\n          indent = 2;\r\n          itemContents = line.trimStart();\r\n        } else if (blankLine) {\r\n          indent = cap[1].length + 1;\r\n        } else {\r\n          indent = cap[2].search(this.rules.other.nonSpaceChar);\r\n          indent = indent > 4 ? 1 : indent;\r\n          itemContents = line.slice(indent);\r\n          indent += cap[1].length;\r\n        }\r\n        if (blankLine && this.rules.other.blankLine.test(nextLine)) {\r\n          raw += nextLine + \"\\n\";\r\n          src = src.substring(nextLine.length + 1);\r\n          endEarly = true;\r\n        }\r\n        if (!endEarly) {\r\n          const nextBulletRegex = this.rules.other.nextBulletRegex(indent);\r\n          const hrRegex = this.rules.other.hrRegex(indent);\r\n          const fencesBeginRegex = this.rules.other.fencesBeginRegex(indent);\r\n          const headingBeginRegex = this.rules.other.headingBeginRegex(indent);\r\n          const htmlBeginRegex = this.rules.other.htmlBeginRegex(indent);\r\n          while (src) {\r\n            const rawLine = src.split(\"\\n\", 1)[0];\r\n            let nextLineWithoutTabs;\r\n            nextLine = rawLine;\r\n            if (this.options.pedantic) {\r\n              nextLine = nextLine.replace(this.rules.other.listReplaceNesting, \"  \");\r\n              nextLineWithoutTabs = nextLine;\r\n            } else {\r\n              nextLineWithoutTabs = nextLine.replace(this.rules.other.tabCharGlobal, \"    \");\r\n            }\r\n            if (fencesBeginRegex.test(nextLine)) {\r\n              break;\r\n            }\r\n            if (headingBeginRegex.test(nextLine)) {\r\n              break;\r\n            }\r\n            if (htmlBeginRegex.test(nextLine)) {\r\n              break;\r\n            }\r\n            if (nextBulletRegex.test(nextLine)) {\r\n              break;\r\n            }\r\n            if (hrRegex.test(nextLine)) {\r\n              break;\r\n            }\r\n            if (nextLineWithoutTabs.search(this.rules.other.nonSpaceChar) >= indent || !nextLine.trim()) {\r\n              itemContents += \"\\n\" + nextLineWithoutTabs.slice(indent);\r\n            } else {\r\n              if (blankLine) {\r\n                break;\r\n              }\r\n              if (line.replace(this.rules.other.tabCharGlobal, \"    \").search(this.rules.other.nonSpaceChar) >= 4) {\r\n                break;\r\n              }\r\n              if (fencesBeginRegex.test(line)) {\r\n                break;\r\n              }\r\n              if (headingBeginRegex.test(line)) {\r\n                break;\r\n              }\r\n              if (hrRegex.test(line)) {\r\n                break;\r\n              }\r\n              itemContents += \"\\n\" + nextLine;\r\n            }\r\n            if (!blankLine && !nextLine.trim()) {\r\n              blankLine = true;\r\n            }\r\n            raw += rawLine + \"\\n\";\r\n            src = src.substring(rawLine.length + 1);\r\n            line = nextLineWithoutTabs.slice(indent);\r\n          }\r\n        }\r\n        if (!list2.loose) {\r\n          if (endsWithBlankLine) {\r\n            list2.loose = true;\r\n          } else if (this.rules.other.doubleBlankLine.test(raw)) {\r\n            endsWithBlankLine = true;\r\n          }\r\n        }\r\n        let istask = null;\r\n        let ischecked;\r\n        if (this.options.gfm) {\r\n          istask = this.rules.other.listIsTask.exec(itemContents);\r\n          if (istask) {\r\n            ischecked = istask[0] !== \"[ ] \";\r\n            itemContents = itemContents.replace(this.rules.other.listReplaceTask, \"\");\r\n          }\r\n        }\r\n        list2.items.push({\r\n          type: \"list_item\",\r\n          raw,\r\n          task: !!istask,\r\n          checked: ischecked,\r\n          loose: false,\r\n          text: itemContents,\r\n          tokens: []\r\n        });\r\n        list2.raw += raw;\r\n      }\r\n      const lastItem = list2.items.at(-1);\r\n      if (lastItem) {\r\n        lastItem.raw = lastItem.raw.trimEnd();\r\n        lastItem.text = lastItem.text.trimEnd();\r\n      } else {\r\n        return;\r\n      }\r\n      list2.raw = list2.raw.trimEnd();\r\n      for (let i = 0; i < list2.items.length; i++) {\r\n        this.lexer.state.top = false;\r\n        list2.items[i].tokens = this.lexer.blockTokens(list2.items[i].text, []);\r\n        if (!list2.loose) {\r\n          const spacers = list2.items[i].tokens.filter((t) => t.type === \"space\");\r\n          const hasMultipleLineBreaks = spacers.length > 0 && spacers.some((t) => this.rules.other.anyLine.test(t.raw));\r\n          list2.loose = hasMultipleLineBreaks;\r\n        }\r\n      }\r\n      if (list2.loose) {\r\n        for (let i = 0; i < list2.items.length; i++) {\r\n          list2.items[i].loose = true;\r\n        }\r\n      }\r\n      return list2;\r\n    }\r\n  }\r\n  html(src) {\r\n    const cap = this.rules.block.html.exec(src);\r\n    if (cap) {\r\n      const token = {\r\n        type: \"html\",\r\n        block: true,\r\n        raw: cap[0],\r\n        pre: cap[1] === \"pre\" || cap[1] === \"script\" || cap[1] === \"style\",\r\n        text: cap[0]\r\n      };\r\n      return token;\r\n    }\r\n  }\r\n  def(src) {\r\n    const cap = this.rules.block.def.exec(src);\r\n    if (cap) {\r\n      const tag2 = cap[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal, \" \");\r\n      const href = cap[2] ? cap[2].replace(this.rules.other.hrefBrackets, \"$1\").replace(this.rules.inline.anyPunctuation, \"$1\") : \"\";\r\n      const title = cap[3] ? cap[3].substring(1, cap[3].length - 1).replace(this.rules.inline.anyPunctuation, \"$1\") : cap[3];\r\n      return {\r\n        type: \"def\",\r\n        tag: tag2,\r\n        raw: cap[0],\r\n        href,\r\n        title\r\n      };\r\n    }\r\n  }\r\n  table(src) {\r\n    const cap = this.rules.block.table.exec(src);\r\n    if (!cap) {\r\n      return;\r\n    }\r\n    if (!this.rules.other.tableDelimiter.test(cap[2])) {\r\n      return;\r\n    }\r\n    const headers = splitCells(cap[1]);\r\n    const aligns = cap[2].replace(this.rules.other.tableAlignChars, \"\").split(\"|\");\r\n    const rows = cap[3]?.trim() ? cap[3].replace(this.rules.other.tableRowBlankLine, \"\").split(\"\\n\") : [];\r\n    const item = {\r\n      type: \"table\",\r\n      raw: cap[0],\r\n      header: [],\r\n      align: [],\r\n      rows: []\r\n    };\r\n    if (headers.length !== aligns.length) {\r\n      return;\r\n    }\r\n    for (const align of aligns) {\r\n      if (this.rules.other.tableAlignRight.test(align)) {\r\n        item.align.push(\"right\");\r\n      } else if (this.rules.other.tableAlignCenter.test(align)) {\r\n        item.align.push(\"center\");\r\n      } else if (this.rules.other.tableAlignLeft.test(align)) {\r\n        item.align.push(\"left\");\r\n      } else {\r\n        item.align.push(null);\r\n      }\r\n    }\r\n    for (let i = 0; i < headers.length; i++) {\r\n      item.header.push({\r\n        text: headers[i],\r\n        tokens: this.lexer.inline(headers[i]),\r\n        header: true,\r\n        align: item.align[i]\r\n      });\r\n    }\r\n    for (const row of rows) {\r\n      item.rows.push(splitCells(row, item.header.length).map((cell, i) => {\r\n        return {\r\n          text: cell,\r\n          tokens: this.lexer.inline(cell),\r\n          header: false,\r\n          align: item.align[i]\r\n        };\r\n      }));\r\n    }\r\n    return item;\r\n  }\r\n  lheading(src) {\r\n    const cap = this.rules.block.lheading.exec(src);\r\n    if (cap) {\r\n      return {\r\n        type: \"heading\",\r\n        raw: cap[0],\r\n        depth: cap[2].charAt(0) === \"=\" ? 1 : 2,\r\n        text: cap[1],\r\n        tokens: this.lexer.inline(cap[1])\r\n      };\r\n    }\r\n  }\r\n  paragraph(src) {\r\n    const cap = this.rules.block.paragraph.exec(src);\r\n    if (cap) {\r\n      const text = cap[1].charAt(cap[1].length - 1) === \"\\n\" ? cap[1].slice(0, -1) : cap[1];\r\n      return {\r\n        type: \"paragraph\",\r\n        raw: cap[0],\r\n        text,\r\n        tokens: this.lexer.inline(text)\r\n      };\r\n    }\r\n  }\r\n  text(src) {\r\n    const cap = this.rules.block.text.exec(src);\r\n    if (cap) {\r\n      return {\r\n        type: \"text\",\r\n        raw: cap[0],\r\n        text: cap[0],\r\n        tokens: this.lexer.inline(cap[0])\r\n      };\r\n    }\r\n  }\r\n  escape(src) {\r\n    const cap = this.rules.inline.escape.exec(src);\r\n    if (cap) {\r\n      return {\r\n        type: \"escape\",\r\n        raw: cap[0],\r\n        text: cap[1]\r\n      };\r\n    }\r\n  }\r\n  tag(src) {\r\n    const cap = this.rules.inline.tag.exec(src);\r\n    if (cap) {\r\n      if (!this.lexer.state.inLink && this.rules.other.startATag.test(cap[0])) {\r\n        this.lexer.state.inLink = true;\r\n      } else if (this.lexer.state.inLink && this.rules.other.endATag.test(cap[0])) {\r\n        this.lexer.state.inLink = false;\r\n      }\r\n      if (!this.lexer.state.inRawBlock && this.rules.other.startPreScriptTag.test(cap[0])) {\r\n        this.lexer.state.inRawBlock = true;\r\n      } else if (this.lexer.state.inRawBlock && this.rules.other.endPreScriptTag.test(cap[0])) {\r\n        this.lexer.state.inRawBlock = false;\r\n      }\r\n      return {\r\n        type: \"html\",\r\n        raw: cap[0],\r\n        inLink: this.lexer.state.inLink,\r\n        inRawBlock: this.lexer.state.inRawBlock,\r\n        block: false,\r\n        text: cap[0]\r\n      };\r\n    }\r\n  }\r\n  link(src) {\r\n    const cap = this.rules.inline.link.exec(src);\r\n    if (cap) {\r\n      const trimmedUrl = cap[2].trim();\r\n      if (!this.options.pedantic && this.rules.other.startAngleBracket.test(trimmedUrl)) {\r\n        if (!this.rules.other.endAngleBracket.test(trimmedUrl)) {\r\n          return;\r\n        }\r\n        const rtrimSlash = rtrim(trimmedUrl.slice(0, -1), \"\\\\\");\r\n        if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {\r\n          return;\r\n        }\r\n      } else {\r\n        const lastParenIndex = findClosingBracket(cap[2], \"()\");\r\n        if (lastParenIndex === -2) {\r\n          return;\r\n        }\r\n        if (lastParenIndex > -1) {\r\n          const start = cap[0].indexOf(\"!\") === 0 ? 5 : 4;\r\n          const linkLen = start + cap[1].length + lastParenIndex;\r\n          cap[2] = cap[2].substring(0, lastParenIndex);\r\n          cap[0] = cap[0].substring(0, linkLen).trim();\r\n          cap[3] = \"\";\r\n        }\r\n      }\r\n      let href = cap[2];\r\n      let title = \"\";\r\n      if (this.options.pedantic) {\r\n        const link2 = this.rules.other.pedanticHrefTitle.exec(href);\r\n        if (link2) {\r\n          href = link2[1];\r\n          title = link2[3];\r\n        }\r\n      } else {\r\n        title = cap[3] ? cap[3].slice(1, -1) : \"\";\r\n      }\r\n      href = href.trim();\r\n      if (this.rules.other.startAngleBracket.test(href)) {\r\n        if (this.options.pedantic && !this.rules.other.endAngleBracket.test(trimmedUrl)) {\r\n          href = href.slice(1);\r\n        } else {\r\n          href = href.slice(1, -1);\r\n        }\r\n      }\r\n      return outputLink(cap, {\r\n        href: href ? href.replace(this.rules.inline.anyPunctuation, \"$1\") : href,\r\n        title: title ? title.replace(this.rules.inline.anyPunctuation, \"$1\") : title\r\n      }, cap[0], this.lexer, this.rules);\r\n    }\r\n  }\r\n  reflink(src, links) {\r\n    let cap;\r\n    if ((cap = this.rules.inline.reflink.exec(src)) || (cap = this.rules.inline.nolink.exec(src))) {\r\n      const linkString = (cap[2] || cap[1]).replace(this.rules.other.multipleSpaceGlobal, \" \");\r\n      const link2 = links[linkString.toLowerCase()];\r\n      if (!link2) {\r\n        const text = cap[0].charAt(0);\r\n        return {\r\n          type: \"text\",\r\n          raw: text,\r\n          text\r\n        };\r\n      }\r\n      return outputLink(cap, link2, cap[0], this.lexer, this.rules);\r\n    }\r\n  }\r\n  emStrong(src, maskedSrc, prevChar = \"\") {\r\n    let match = this.rules.inline.emStrongLDelim.exec(src);\r\n    if (!match) return;\r\n    if (match[3] && prevChar.match(this.rules.other.unicodeAlphaNumeric)) return;\r\n    const nextChar = match[1] || match[2] || \"\";\r\n    if (!nextChar || !prevChar || this.rules.inline.punctuation.exec(prevChar)) {\r\n      const lLength = [...match[0]].length - 1;\r\n      let rDelim, rLength, delimTotal = lLength, midDelimTotal = 0;\r\n      const endReg = match[0][0] === \"*\" ? this.rules.inline.emStrongRDelimAst : this.rules.inline.emStrongRDelimUnd;\r\n      endReg.lastIndex = 0;\r\n      maskedSrc = maskedSrc.slice(-1 * src.length + lLength);\r\n      while ((match = endReg.exec(maskedSrc)) != null) {\r\n        rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];\r\n        if (!rDelim) continue;\r\n        rLength = [...rDelim].length;\r\n        if (match[3] || match[4]) {\r\n          delimTotal += rLength;\r\n          continue;\r\n        } else if (match[5] || match[6]) {\r\n          if (lLength % 3 && !((lLength + rLength) % 3)) {\r\n            midDelimTotal += rLength;\r\n            continue;\r\n          }\r\n        }\r\n        delimTotal -= rLength;\r\n        if (delimTotal > 0) continue;\r\n        rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);\r\n        const lastCharLength = [...match[0]][0].length;\r\n        const raw = src.slice(0, lLength + match.index + lastCharLength + rLength);\r\n        if (Math.min(lLength, rLength) % 2) {\r\n          const text2 = raw.slice(1, -1);\r\n          return {\r\n            type: \"em\",\r\n            raw,\r\n            text: text2,\r\n            tokens: this.lexer.inlineTokens(text2)\r\n          };\r\n        }\r\n        const text = raw.slice(2, -2);\r\n        return {\r\n          type: \"strong\",\r\n          raw,\r\n          text,\r\n          tokens: this.lexer.inlineTokens(text)\r\n        };\r\n      }\r\n    }\r\n  }\r\n  codespan(src) {\r\n    const cap = this.rules.inline.code.exec(src);\r\n    if (cap) {\r\n      let text = cap[2].replace(this.rules.other.newLineCharGlobal, \" \");\r\n      const hasNonSpaceChars = this.rules.other.nonSpaceChar.test(text);\r\n      const hasSpaceCharsOnBothEnds = this.rules.other.startingSpaceChar.test(text) && this.rules.other.endingSpaceChar.test(text);\r\n      if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\r\n        text = text.substring(1, text.length - 1);\r\n      }\r\n      return {\r\n        type: \"codespan\",\r\n        raw: cap[0],\r\n        text\r\n      };\r\n    }\r\n  }\r\n  br(src) {\r\n    const cap = this.rules.inline.br.exec(src);\r\n    if (cap) {\r\n      return {\r\n        type: \"br\",\r\n        raw: cap[0]\r\n      };\r\n    }\r\n  }\r\n  del(src) {\r\n    const cap = this.rules.inline.del.exec(src);\r\n    if (cap) {\r\n      return {\r\n        type: \"del\",\r\n        raw: cap[0],\r\n        text: cap[2],\r\n        tokens: this.lexer.inlineTokens(cap[2])\r\n      };\r\n    }\r\n  }\r\n  autolink(src) {\r\n    const cap = this.rules.inline.autolink.exec(src);\r\n    if (cap) {\r\n      let text, href;\r\n      if (cap[2] === \"@\") {\r\n        text = cap[1];\r\n        href = \"mailto:\" + text;\r\n      } else {\r\n        text = cap[1];\r\n        href = text;\r\n      }\r\n      return {\r\n        type: \"link\",\r\n        raw: cap[0],\r\n        text,\r\n        href,\r\n        tokens: [\r\n          {\r\n            type: \"text\",\r\n            raw: text,\r\n            text\r\n          }\r\n        ]\r\n      };\r\n    }\r\n  }\r\n  url(src) {\r\n    let cap;\r\n    if (cap = this.rules.inline.url.exec(src)) {\r\n      let text, href;\r\n      if (cap[2] === \"@\") {\r\n        text = cap[0];\r\n        href = \"mailto:\" + text;\r\n      } else {\r\n        let prevCapZero;\r\n        do {\r\n          prevCapZero = cap[0];\r\n          cap[0] = this.rules.inline._backpedal.exec(cap[0])?.[0] ?? \"\";\r\n        } while (prevCapZero !== cap[0]);\r\n        text = cap[0];\r\n        if (cap[1] === \"www.\") {\r\n          href = \"http://\" + cap[0];\r\n        } else {\r\n          href = cap[0];\r\n        }\r\n      }\r\n      return {\r\n        type: \"link\",\r\n        raw: cap[0],\r\n        text,\r\n        href,\r\n        tokens: [\r\n          {\r\n            type: \"text\",\r\n            raw: text,\r\n            text\r\n          }\r\n        ]\r\n      };\r\n    }\r\n  }\r\n  inlineText(src) {\r\n    const cap = this.rules.inline.text.exec(src);\r\n    if (cap) {\r\n      const escaped = this.lexer.state.inRawBlock;\r\n      return {\r\n        type: \"text\",\r\n        raw: cap[0],\r\n        text: cap[0],\r\n        escaped\r\n      };\r\n    }\r\n  }\r\n};\r\n\r\n// src/Lexer.ts\r\nvar _Lexer = class __Lexer {\r\n  tokens;\r\n  options;\r\n  state;\r\n  tokenizer;\r\n  inlineQueue;\r\n  constructor(options2) {\r\n    this.tokens = [];\r\n    this.tokens.links = /* @__PURE__ */ Object.create(null);\r\n    this.options = options2 || _defaults;\r\n    this.options.tokenizer = this.options.tokenizer || new _Tokenizer();\r\n    this.tokenizer = this.options.tokenizer;\r\n    this.tokenizer.options = this.options;\r\n    this.tokenizer.lexer = this;\r\n    this.inlineQueue = [];\r\n    this.state = {\r\n      inLink: false,\r\n      inRawBlock: false,\r\n      top: true\r\n    };\r\n    const rules = {\r\n      other,\r\n      block: block.normal,\r\n      inline: inline.normal\r\n    };\r\n    if (this.options.pedantic) {\r\n      rules.block = block.pedantic;\r\n      rules.inline = inline.pedantic;\r\n    } else if (this.options.gfm) {\r\n      rules.block = block.gfm;\r\n      if (this.options.breaks) {\r\n        rules.inline = inline.breaks;\r\n      } else {\r\n        rules.inline = inline.gfm;\r\n      }\r\n    }\r\n    this.tokenizer.rules = rules;\r\n  }\r\n  /**\r\n   * Expose Rules\r\n   */\r\n  static get rules() {\r\n    return {\r\n      block,\r\n      inline\r\n    };\r\n  }\r\n  /**\r\n   * Static Lex Method\r\n   */\r\n  static lex(src, options2) {\r\n    const lexer2 = new __Lexer(options2);\r\n    return lexer2.lex(src);\r\n  }\r\n  /**\r\n   * Static Lex Inline Method\r\n   */\r\n  static lexInline(src, options2) {\r\n    const lexer2 = new __Lexer(options2);\r\n    return lexer2.inlineTokens(src);\r\n  }\r\n  /**\r\n   * Preprocessing\r\n   */\r\n  lex(src) {\r\n    src = src.replace(other.carriageReturn, \"\\n\");\r\n    this.blockTokens(src, this.tokens);\r\n    for (let i = 0; i < this.inlineQueue.length; i++) {\r\n      const next = this.inlineQueue[i];\r\n      this.inlineTokens(next.src, next.tokens);\r\n    }\r\n    this.inlineQueue = [];\r\n    return this.tokens;\r\n  }\r\n  blockTokens(src, tokens = [], lastParagraphClipped = false) {\r\n    if (this.options.pedantic) {\r\n      src = src.replace(other.tabCharGlobal, \"    \").replace(other.spaceLine, \"\");\r\n    }\r\n    while (src) {\r\n      let token;\r\n      if (this.options.extensions?.block?.some((extTokenizer) => {\r\n        if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\r\n          src = src.substring(token.raw.length);\r\n          tokens.push(token);\r\n          return true;\r\n        }\r\n        return false;\r\n      })) {\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.space(src)) {\r\n        src = src.substring(token.raw.length);\r\n        const lastToken = tokens.at(-1);\r\n        if (token.raw.length === 1 && lastToken !== void 0) {\r\n          lastToken.raw += \"\\n\";\r\n        } else {\r\n          tokens.push(token);\r\n        }\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.code(src)) {\r\n        src = src.substring(token.raw.length);\r\n        const lastToken = tokens.at(-1);\r\n        if (lastToken?.type === \"paragraph\" || lastToken?.type === \"text\") {\r\n          lastToken.raw += \"\\n\" + token.raw;\r\n          lastToken.text += \"\\n\" + token.text;\r\n          this.inlineQueue.at(-1).src = lastToken.text;\r\n        } else {\r\n          tokens.push(token);\r\n        }\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.fences(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.heading(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.hr(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.blockquote(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.list(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.html(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.def(src)) {\r\n        src = src.substring(token.raw.length);\r\n        const lastToken = tokens.at(-1);\r\n        if (lastToken?.type === \"paragraph\" || lastToken?.type === \"text\") {\r\n          lastToken.raw += \"\\n\" + token.raw;\r\n          lastToken.text += \"\\n\" + token.raw;\r\n          this.inlineQueue.at(-1).src = lastToken.text;\r\n        } else if (!this.tokens.links[token.tag]) {\r\n          this.tokens.links[token.tag] = {\r\n            href: token.href,\r\n            title: token.title\r\n          };\r\n        }\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.table(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.lheading(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      let cutSrc = src;\r\n      if (this.options.extensions?.startBlock) {\r\n        let startIndex = Infinity;\r\n        const tempSrc = src.slice(1);\r\n        let tempStart;\r\n        this.options.extensions.startBlock.forEach((getStartIndex) => {\r\n          tempStart = getStartIndex.call({ lexer: this }, tempSrc);\r\n          if (typeof tempStart === \"number\" && tempStart >= 0) {\r\n            startIndex = Math.min(startIndex, tempStart);\r\n          }\r\n        });\r\n        if (startIndex < Infinity && startIndex >= 0) {\r\n          cutSrc = src.substring(0, startIndex + 1);\r\n        }\r\n      }\r\n      if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {\r\n        const lastToken = tokens.at(-1);\r\n        if (lastParagraphClipped && lastToken?.type === \"paragraph\") {\r\n          lastToken.raw += \"\\n\" + token.raw;\r\n          lastToken.text += \"\\n\" + token.text;\r\n          this.inlineQueue.pop();\r\n          this.inlineQueue.at(-1).src = lastToken.text;\r\n        } else {\r\n          tokens.push(token);\r\n        }\r\n        lastParagraphClipped = cutSrc.length !== src.length;\r\n        src = src.substring(token.raw.length);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.text(src)) {\r\n        src = src.substring(token.raw.length);\r\n        const lastToken = tokens.at(-1);\r\n        if (lastToken?.type === \"text\") {\r\n          lastToken.raw += \"\\n\" + token.raw;\r\n          lastToken.text += \"\\n\" + token.text;\r\n          this.inlineQueue.pop();\r\n          this.inlineQueue.at(-1).src = lastToken.text;\r\n        } else {\r\n          tokens.push(token);\r\n        }\r\n        continue;\r\n      }\r\n      if (src) {\r\n        const errMsg = \"Infinite loop on byte: \" + src.charCodeAt(0);\r\n        if (this.options.silent) {\r\n          console.error(errMsg);\r\n          break;\r\n        } else {\r\n          throw new Error(errMsg);\r\n        }\r\n      }\r\n    }\r\n    this.state.top = true;\r\n    return tokens;\r\n  }\r\n  inline(src, tokens = []) {\r\n    this.inlineQueue.push({ src, tokens });\r\n    return tokens;\r\n  }\r\n  /**\r\n   * Lexing/Compiling\r\n   */\r\n  inlineTokens(src, tokens = []) {\r\n    let maskedSrc = src;\r\n    let match = null;\r\n    if (this.tokens.links) {\r\n      const links = Object.keys(this.tokens.links);\r\n      if (links.length > 0) {\r\n        while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\r\n          if (links.includes(match[0].slice(match[0].lastIndexOf(\"[\") + 1, -1))) {\r\n            maskedSrc = maskedSrc.slice(0, match.index) + \"[\" + \"a\".repeat(match[0].length - 2) + \"]\" + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    while ((match = this.tokenizer.rules.inline.anyPunctuation.exec(maskedSrc)) != null) {\r\n      maskedSrc = maskedSrc.slice(0, match.index) + \"++\" + maskedSrc.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);\r\n    }\r\n    while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\r\n      maskedSrc = maskedSrc.slice(0, match.index) + \"[\" + \"a\".repeat(match[0].length - 2) + \"]\" + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);\r\n    }\r\n    let keepPrevChar = false;\r\n    let prevChar = \"\";\r\n    while (src) {\r\n      if (!keepPrevChar) {\r\n        prevChar = \"\";\r\n      }\r\n      keepPrevChar = false;\r\n      let token;\r\n      if (this.options.extensions?.inline?.some((extTokenizer) => {\r\n        if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\r\n          src = src.substring(token.raw.length);\r\n          tokens.push(token);\r\n          return true;\r\n        }\r\n        return false;\r\n      })) {\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.escape(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.tag(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.link(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.reflink(src, this.tokens.links)) {\r\n        src = src.substring(token.raw.length);\r\n        const lastToken = tokens.at(-1);\r\n        if (token.type === \"text\" && lastToken?.type === \"text\") {\r\n          lastToken.raw += token.raw;\r\n          lastToken.text += token.text;\r\n        } else {\r\n          tokens.push(token);\r\n        }\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.codespan(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.br(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.del(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.autolink(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (!this.state.inLink && (token = this.tokenizer.url(src))) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      let cutSrc = src;\r\n      if (this.options.extensions?.startInline) {\r\n        let startIndex = Infinity;\r\n        const tempSrc = src.slice(1);\r\n        let tempStart;\r\n        this.options.extensions.startInline.forEach((getStartIndex) => {\r\n          tempStart = getStartIndex.call({ lexer: this }, tempSrc);\r\n          if (typeof tempStart === \"number\" && tempStart >= 0) {\r\n            startIndex = Math.min(startIndex, tempStart);\r\n          }\r\n        });\r\n        if (startIndex < Infinity && startIndex >= 0) {\r\n          cutSrc = src.substring(0, startIndex + 1);\r\n        }\r\n      }\r\n      if (token = this.tokenizer.inlineText(cutSrc)) {\r\n        src = src.substring(token.raw.length);\r\n        if (token.raw.slice(-1) !== \"_\") {\r\n          prevChar = token.raw.slice(-1);\r\n        }\r\n        keepPrevChar = true;\r\n        const lastToken = tokens.at(-1);\r\n        if (lastToken?.type === \"text\") {\r\n          lastToken.raw += token.raw;\r\n          lastToken.text += token.text;\r\n        } else {\r\n          tokens.push(token);\r\n        }\r\n        continue;\r\n      }\r\n      if (src) {\r\n        const errMsg = \"Infinite loop on byte: \" + src.charCodeAt(0);\r\n        if (this.options.silent) {\r\n          console.error(errMsg);\r\n          break;\r\n        } else {\r\n          throw new Error(errMsg);\r\n        }\r\n      }\r\n    }\r\n    return tokens;\r\n  }\r\n};\r\n\r\n// src/Renderer.ts\r\nvar _Renderer = class {\r\n  options;\r\n  parser;\r\n  // set by the parser\r\n  constructor(options2) {\r\n    this.options = options2 || _defaults;\r\n  }\r\n  space(token) {\r\n    return \"\";\r\n  }\r\n  code({ text, lang, escaped }) {\r\n    const langString = (lang || \"\").match(other.notSpaceStart)?.[0];\r\n    const code = text.replace(other.endingNewline, \"\") + \"\\n\";\r\n    if (!langString) {\r\n      return \"<pre><code>\" + (escaped ? code : escape2(code, true)) + \"</code></pre>\\n\";\r\n    }\r\n    return '<pre><code class=\"language-' + escape2(langString) + '\">' + (escaped ? code : escape2(code, true)) + \"</code></pre>\\n\";\r\n  }\r\n  blockquote({ tokens }) {\r\n    const body = this.parser.parse(tokens);\r\n    return `<blockquote>\r\n${body}</blockquote>\r\n`;\r\n  }\r\n  html({ text }) {\r\n    return text;\r\n  }\r\n  heading({ tokens, depth }) {\r\n    return `<h${depth}>${this.parser.parseInline(tokens)}</h${depth}>\r\n`;\r\n  }\r\n  hr(token) {\r\n    return \"<hr>\\n\";\r\n  }\r\n  list(token) {\r\n    const ordered = token.ordered;\r\n    const start = token.start;\r\n    let body = \"\";\r\n    for (let j = 0; j < token.items.length; j++) {\r\n      const item = token.items[j];\r\n      body += this.listitem(item);\r\n    }\r\n    const type = ordered ? \"ol\" : \"ul\";\r\n    const startAttr = ordered && start !== 1 ? ' start=\"' + start + '\"' : \"\";\r\n    return \"<\" + type + startAttr + \">\\n\" + body + \"</\" + type + \">\\n\";\r\n  }\r\n  listitem(item) {\r\n    let itemBody = \"\";\r\n    if (item.task) {\r\n      const checkbox = this.checkbox({ checked: !!item.checked });\r\n      if (item.loose) {\r\n        if (item.tokens[0]?.type === \"paragraph\") {\r\n          item.tokens[0].text = checkbox + \" \" + item.tokens[0].text;\r\n          if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === \"text\") {\r\n            item.tokens[0].tokens[0].text = checkbox + \" \" + escape2(item.tokens[0].tokens[0].text);\r\n            item.tokens[0].tokens[0].escaped = true;\r\n          }\r\n        } else {\r\n          item.tokens.unshift({\r\n            type: \"text\",\r\n            raw: checkbox + \" \",\r\n            text: checkbox + \" \",\r\n            escaped: true\r\n          });\r\n        }\r\n      } else {\r\n        itemBody += checkbox + \" \";\r\n      }\r\n    }\r\n    itemBody += this.parser.parse(item.tokens, !!item.loose);\r\n    return `<li>${itemBody}</li>\r\n`;\r\n  }\r\n  checkbox({ checked }) {\r\n    return \"<input \" + (checked ? 'checked=\"\" ' : \"\") + 'disabled=\"\" type=\"checkbox\">';\r\n  }\r\n  paragraph({ tokens }) {\r\n    return `<p>${this.parser.parseInline(tokens)}</p>\r\n`;\r\n  }\r\n  table(token) {\r\n    let header = \"\";\r\n    let cell = \"\";\r\n    for (let j = 0; j < token.header.length; j++) {\r\n      cell += this.tablecell(token.header[j]);\r\n    }\r\n    header += this.tablerow({ text: cell });\r\n    let body = \"\";\r\n    for (let j = 0; j < token.rows.length; j++) {\r\n      const row = token.rows[j];\r\n      cell = \"\";\r\n      for (let k = 0; k < row.length; k++) {\r\n        cell += this.tablecell(row[k]);\r\n      }\r\n      body += this.tablerow({ text: cell });\r\n    }\r\n    if (body) body = `<tbody>${body}</tbody>`;\r\n    return \"<table>\\n<thead>\\n\" + header + \"</thead>\\n\" + body + \"</table>\\n\";\r\n  }\r\n  tablerow({ text }) {\r\n    return `<tr>\r\n${text}</tr>\r\n`;\r\n  }\r\n  tablecell(token) {\r\n    const content = this.parser.parseInline(token.tokens);\r\n    const type = token.header ? \"th\" : \"td\";\r\n    const tag2 = token.align ? `<${type} align=\"${token.align}\">` : `<${type}>`;\r\n    return tag2 + content + `</${type}>\r\n`;\r\n  }\r\n  /**\r\n   * span level renderer\r\n   */\r\n  strong({ tokens }) {\r\n    return `<strong>${this.parser.parseInline(tokens)}</strong>`;\r\n  }\r\n  em({ tokens }) {\r\n    return `<em>${this.parser.parseInline(tokens)}</em>`;\r\n  }\r\n  codespan({ text }) {\r\n    return `<code>${escape2(text, true)}</code>`;\r\n  }\r\n  br(token) {\r\n    return \"<br>\";\r\n  }\r\n  del({ tokens }) {\r\n    return `<del>${this.parser.parseInline(tokens)}</del>`;\r\n  }\r\n  link({ href, title, tokens }) {\r\n    const text = this.parser.parseInline(tokens);\r\n    const cleanHref = cleanUrl(href);\r\n    if (cleanHref === null) {\r\n      return text;\r\n    }\r\n    href = cleanHref;\r\n    let out = '<a href=\"' + href + '\"';\r\n    if (title) {\r\n      out += ' title=\"' + escape2(title) + '\"';\r\n    }\r\n    out += \">\" + text + \"</a>\";\r\n    return out;\r\n  }\r\n  image({ href, title, text, tokens }) {\r\n    if (tokens) {\r\n      text = this.parser.parseInline(tokens, this.parser.textRenderer);\r\n    }\r\n    const cleanHref = cleanUrl(href);\r\n    if (cleanHref === null) {\r\n      return escape2(text);\r\n    }\r\n    href = cleanHref;\r\n    let out = `<img src=\"${href}\" alt=\"${text}\"`;\r\n    if (title) {\r\n      out += ` title=\"${escape2(title)}\"`;\r\n    }\r\n    out += \">\";\r\n    return out;\r\n  }\r\n  text(token) {\r\n    return \"tokens\" in token && token.tokens ? this.parser.parseInline(token.tokens) : \"escaped\" in token && token.escaped ? token.text : escape2(token.text);\r\n  }\r\n};\r\n\r\n// src/TextRenderer.ts\r\nvar _TextRenderer = class {\r\n  // no need for block level renderers\r\n  strong({ text }) {\r\n    return text;\r\n  }\r\n  em({ text }) {\r\n    return text;\r\n  }\r\n  codespan({ text }) {\r\n    return text;\r\n  }\r\n  del({ text }) {\r\n    return text;\r\n  }\r\n  html({ text }) {\r\n    return text;\r\n  }\r\n  text({ text }) {\r\n    return text;\r\n  }\r\n  link({ text }) {\r\n    return \"\" + text;\r\n  }\r\n  image({ text }) {\r\n    return \"\" + text;\r\n  }\r\n  br() {\r\n    return \"\";\r\n  }\r\n};\r\n\r\n// src/Parser.ts\r\nvar _Parser = class __Parser {\r\n  options;\r\n  renderer;\r\n  textRenderer;\r\n  constructor(options2) {\r\n    this.options = options2 || _defaults;\r\n    this.options.renderer = this.options.renderer || new _Renderer();\r\n    this.renderer = this.options.renderer;\r\n    this.renderer.options = this.options;\r\n    this.renderer.parser = this;\r\n    this.textRenderer = new _TextRenderer();\r\n  }\r\n  /**\r\n   * Static Parse Method\r\n   */\r\n  static parse(tokens, options2) {\r\n    const parser2 = new __Parser(options2);\r\n    return parser2.parse(tokens);\r\n  }\r\n  /**\r\n   * Static Parse Inline Method\r\n   */\r\n  static parseInline(tokens, options2) {\r\n    const parser2 = new __Parser(options2);\r\n    return parser2.parseInline(tokens);\r\n  }\r\n  /**\r\n   * Parse Loop\r\n   */\r\n  parse(tokens, top = true) {\r\n    let out = \"\";\r\n    for (let i = 0; i < tokens.length; i++) {\r\n      const anyToken = tokens[i];\r\n      if (this.options.extensions?.renderers?.[anyToken.type]) {\r\n        const genericToken = anyToken;\r\n        const ret = this.options.extensions.renderers[genericToken.type].call({ parser: this }, genericToken);\r\n        if (ret !== false || ![\"space\", \"hr\", \"heading\", \"code\", \"table\", \"blockquote\", \"list\", \"html\", \"paragraph\", \"text\"].includes(genericToken.type)) {\r\n          out += ret || \"\";\r\n          continue;\r\n        }\r\n      }\r\n      const token = anyToken;\r\n      switch (token.type) {\r\n        case \"space\": {\r\n          out += this.renderer.space(token);\r\n          continue;\r\n        }\r\n        case \"hr\": {\r\n          out += this.renderer.hr(token);\r\n          continue;\r\n        }\r\n        case \"heading\": {\r\n          out += this.renderer.heading(token);\r\n          continue;\r\n        }\r\n        case \"code\": {\r\n          out += this.renderer.code(token);\r\n          continue;\r\n        }\r\n        case \"table\": {\r\n          out += this.renderer.table(token);\r\n          continue;\r\n        }\r\n        case \"blockquote\": {\r\n          out += this.renderer.blockquote(token);\r\n          continue;\r\n        }\r\n        case \"list\": {\r\n          out += this.renderer.list(token);\r\n          continue;\r\n        }\r\n        case \"html\": {\r\n          out += this.renderer.html(token);\r\n          continue;\r\n        }\r\n        case \"paragraph\": {\r\n          out += this.renderer.paragraph(token);\r\n          continue;\r\n        }\r\n        case \"text\": {\r\n          let textToken = token;\r\n          let body = this.renderer.text(textToken);\r\n          while (i + 1 < tokens.length && tokens[i + 1].type === \"text\") {\r\n            textToken = tokens[++i];\r\n            body += \"\\n\" + this.renderer.text(textToken);\r\n          }\r\n          if (top) {\r\n            out += this.renderer.paragraph({\r\n              type: \"paragraph\",\r\n              raw: body,\r\n              text: body,\r\n              tokens: [{ type: \"text\", raw: body, text: body, escaped: true }]\r\n            });\r\n          } else {\r\n            out += body;\r\n          }\r\n          continue;\r\n        }\r\n        default: {\r\n          const errMsg = 'Token with \"' + token.type + '\" type was not found.';\r\n          if (this.options.silent) {\r\n            console.error(errMsg);\r\n            return \"\";\r\n          } else {\r\n            throw new Error(errMsg);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return out;\r\n  }\r\n  /**\r\n   * Parse Inline Tokens\r\n   */\r\n  parseInline(tokens, renderer = this.renderer) {\r\n    let out = \"\";\r\n    for (let i = 0; i < tokens.length; i++) {\r\n      const anyToken = tokens[i];\r\n      if (this.options.extensions?.renderers?.[anyToken.type]) {\r\n        const ret = this.options.extensions.renderers[anyToken.type].call({ parser: this }, anyToken);\r\n        if (ret !== false || ![\"escape\", \"html\", \"link\", \"image\", \"strong\", \"em\", \"codespan\", \"br\", \"del\", \"text\"].includes(anyToken.type)) {\r\n          out += ret || \"\";\r\n          continue;\r\n        }\r\n      }\r\n      const token = anyToken;\r\n      switch (token.type) {\r\n        case \"escape\": {\r\n          out += renderer.text(token);\r\n          break;\r\n        }\r\n        case \"html\": {\r\n          out += renderer.html(token);\r\n          break;\r\n        }\r\n        case \"link\": {\r\n          out += renderer.link(token);\r\n          break;\r\n        }\r\n        case \"image\": {\r\n          out += renderer.image(token);\r\n          break;\r\n        }\r\n        case \"strong\": {\r\n          out += renderer.strong(token);\r\n          break;\r\n        }\r\n        case \"em\": {\r\n          out += renderer.em(token);\r\n          break;\r\n        }\r\n        case \"codespan\": {\r\n          out += renderer.codespan(token);\r\n          break;\r\n        }\r\n        case \"br\": {\r\n          out += renderer.br(token);\r\n          break;\r\n        }\r\n        case \"del\": {\r\n          out += renderer.del(token);\r\n          break;\r\n        }\r\n        case \"text\": {\r\n          out += renderer.text(token);\r\n          break;\r\n        }\r\n        default: {\r\n          const errMsg = 'Token with \"' + token.type + '\" type was not found.';\r\n          if (this.options.silent) {\r\n            console.error(errMsg);\r\n            return \"\";\r\n          } else {\r\n            throw new Error(errMsg);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return out;\r\n  }\r\n};\r\n\r\n// src/Hooks.ts\r\nvar _Hooks = class {\r\n  options;\r\n  block;\r\n  constructor(options2) {\r\n    this.options = options2 || _defaults;\r\n  }\r\n  static passThroughHooks = /* @__PURE__ */ new Set([\r\n    \"preprocess\",\r\n    \"postprocess\",\r\n    \"processAllTokens\"\r\n  ]);\r\n  /**\r\n   * Process markdown before marked\r\n   */\r\n  preprocess(markdown) {\r\n    return markdown;\r\n  }\r\n  /**\r\n   * Process HTML after marked is finished\r\n   */\r\n  postprocess(html2) {\r\n    return html2;\r\n  }\r\n  /**\r\n   * Process all tokens before walk tokens\r\n   */\r\n  processAllTokens(tokens) {\r\n    return tokens;\r\n  }\r\n  /**\r\n   * Provide function to tokenize markdown\r\n   */\r\n  provideLexer() {\r\n    return this.block ? _Lexer.lex : _Lexer.lexInline;\r\n  }\r\n  /**\r\n   * Provide function to parse tokens\r\n   */\r\n  provideParser() {\r\n    return this.block ? _Parser.parse : _Parser.parseInline;\r\n  }\r\n};\r\n\r\n// src/Instance.ts\r\nvar Marked = class {\r\n  defaults = _getDefaults();\r\n  options = this.setOptions;\r\n  parse = this.parseMarkdown(true);\r\n  parseInline = this.parseMarkdown(false);\r\n  Parser = _Parser;\r\n  Renderer = _Renderer;\r\n  TextRenderer = _TextRenderer;\r\n  Lexer = _Lexer;\r\n  Tokenizer = _Tokenizer;\r\n  Hooks = _Hooks;\r\n  constructor(...args) {\r\n    this.use(...args);\r\n  }\r\n  /**\r\n   * Run callback for every token\r\n   */\r\n  walkTokens(tokens, callback) {\r\n    let values = [];\r\n    for (const token of tokens) {\r\n      values = values.concat(callback.call(this, token));\r\n      switch (token.type) {\r\n        case \"table\": {\r\n          const tableToken = token;\r\n          for (const cell of tableToken.header) {\r\n            values = values.concat(this.walkTokens(cell.tokens, callback));\r\n          }\r\n          for (const row of tableToken.rows) {\r\n            for (const cell of row) {\r\n              values = values.concat(this.walkTokens(cell.tokens, callback));\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case \"list\": {\r\n          const listToken = token;\r\n          values = values.concat(this.walkTokens(listToken.items, callback));\r\n          break;\r\n        }\r\n        default: {\r\n          const genericToken = token;\r\n          if (this.defaults.extensions?.childTokens?.[genericToken.type]) {\r\n            this.defaults.extensions.childTokens[genericToken.type].forEach((childTokens) => {\r\n              const tokens2 = genericToken[childTokens].flat(Infinity);\r\n              values = values.concat(this.walkTokens(tokens2, callback));\r\n            });\r\n          } else if (genericToken.tokens) {\r\n            values = values.concat(this.walkTokens(genericToken.tokens, callback));\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return values;\r\n  }\r\n  use(...args) {\r\n    const extensions = this.defaults.extensions || { renderers: {}, childTokens: {} };\r\n    args.forEach((pack) => {\r\n      const opts = { ...pack };\r\n      opts.async = this.defaults.async || opts.async || false;\r\n      if (pack.extensions) {\r\n        pack.extensions.forEach((ext) => {\r\n          if (!ext.name) {\r\n            throw new Error(\"extension name required\");\r\n          }\r\n          if (\"renderer\" in ext) {\r\n            const prevRenderer = extensions.renderers[ext.name];\r\n            if (prevRenderer) {\r\n              extensions.renderers[ext.name] = function(...args2) {\r\n                let ret = ext.renderer.apply(this, args2);\r\n                if (ret === false) {\r\n                  ret = prevRenderer.apply(this, args2);\r\n                }\r\n                return ret;\r\n              };\r\n            } else {\r\n              extensions.renderers[ext.name] = ext.renderer;\r\n            }\r\n          }\r\n          if (\"tokenizer\" in ext) {\r\n            if (!ext.level || ext.level !== \"block\" && ext.level !== \"inline\") {\r\n              throw new Error(\"extension level must be 'block' or 'inline'\");\r\n            }\r\n            const extLevel = extensions[ext.level];\r\n            if (extLevel) {\r\n              extLevel.unshift(ext.tokenizer);\r\n            } else {\r\n              extensions[ext.level] = [ext.tokenizer];\r\n            }\r\n            if (ext.start) {\r\n              if (ext.level === \"block\") {\r\n                if (extensions.startBlock) {\r\n                  extensions.startBlock.push(ext.start);\r\n                } else {\r\n                  extensions.startBlock = [ext.start];\r\n                }\r\n              } else if (ext.level === \"inline\") {\r\n                if (extensions.startInline) {\r\n                  extensions.startInline.push(ext.start);\r\n                } else {\r\n                  extensions.startInline = [ext.start];\r\n                }\r\n              }\r\n            }\r\n          }\r\n          if (\"childTokens\" in ext && ext.childTokens) {\r\n            extensions.childTokens[ext.name] = ext.childTokens;\r\n          }\r\n        });\r\n        opts.extensions = extensions;\r\n      }\r\n      if (pack.renderer) {\r\n        const renderer = this.defaults.renderer || new _Renderer(this.defaults);\r\n        for (const prop in pack.renderer) {\r\n          if (!(prop in renderer)) {\r\n            throw new Error(`renderer '${prop}' does not exist`);\r\n          }\r\n          if ([\"options\", \"parser\"].includes(prop)) {\r\n            continue;\r\n          }\r\n          const rendererProp = prop;\r\n          const rendererFunc = pack.renderer[rendererProp];\r\n          const prevRenderer = renderer[rendererProp];\r\n          renderer[rendererProp] = (...args2) => {\r\n            let ret = rendererFunc.apply(renderer, args2);\r\n            if (ret === false) {\r\n              ret = prevRenderer.apply(renderer, args2);\r\n            }\r\n            return ret || \"\";\r\n          };\r\n        }\r\n        opts.renderer = renderer;\r\n      }\r\n      if (pack.tokenizer) {\r\n        const tokenizer = this.defaults.tokenizer || new _Tokenizer(this.defaults);\r\n        for (const prop in pack.tokenizer) {\r\n          if (!(prop in tokenizer)) {\r\n            throw new Error(`tokenizer '${prop}' does not exist`);\r\n          }\r\n          if ([\"options\", \"rules\", \"lexer\"].includes(prop)) {\r\n            continue;\r\n          }\r\n          const tokenizerProp = prop;\r\n          const tokenizerFunc = pack.tokenizer[tokenizerProp];\r\n          const prevTokenizer = tokenizer[tokenizerProp];\r\n          tokenizer[tokenizerProp] = (...args2) => {\r\n            let ret = tokenizerFunc.apply(tokenizer, args2);\r\n            if (ret === false) {\r\n              ret = prevTokenizer.apply(tokenizer, args2);\r\n            }\r\n            return ret;\r\n          };\r\n        }\r\n        opts.tokenizer = tokenizer;\r\n      }\r\n      if (pack.hooks) {\r\n        const hooks = this.defaults.hooks || new _Hooks();\r\n        for (const prop in pack.hooks) {\r\n          if (!(prop in hooks)) {\r\n            throw new Error(`hook '${prop}' does not exist`);\r\n          }\r\n          if ([\"options\", \"block\"].includes(prop)) {\r\n            continue;\r\n          }\r\n          const hooksProp = prop;\r\n          const hooksFunc = pack.hooks[hooksProp];\r\n          const prevHook = hooks[hooksProp];\r\n          if (_Hooks.passThroughHooks.has(prop)) {\r\n            hooks[hooksProp] = (arg) => {\r\n              if (this.defaults.async) {\r\n                return Promise.resolve(hooksFunc.call(hooks, arg)).then((ret2) => {\r\n                  return prevHook.call(hooks, ret2);\r\n                });\r\n              }\r\n              const ret = hooksFunc.call(hooks, arg);\r\n              return prevHook.call(hooks, ret);\r\n            };\r\n          } else {\r\n            hooks[hooksProp] = (...args2) => {\r\n              let ret = hooksFunc.apply(hooks, args2);\r\n              if (ret === false) {\r\n                ret = prevHook.apply(hooks, args2);\r\n              }\r\n              return ret;\r\n            };\r\n          }\r\n        }\r\n        opts.hooks = hooks;\r\n      }\r\n      if (pack.walkTokens) {\r\n        const walkTokens2 = this.defaults.walkTokens;\r\n        const packWalktokens = pack.walkTokens;\r\n        opts.walkTokens = function(token) {\r\n          let values = [];\r\n          values.push(packWalktokens.call(this, token));\r\n          if (walkTokens2) {\r\n            values = values.concat(walkTokens2.call(this, token));\r\n          }\r\n          return values;\r\n        };\r\n      }\r\n      this.defaults = { ...this.defaults, ...opts };\r\n    });\r\n    return this;\r\n  }\r\n  setOptions(opt) {\r\n    this.defaults = { ...this.defaults, ...opt };\r\n    return this;\r\n  }\r\n  lexer(src, options2) {\r\n    return _Lexer.lex(src, options2 ?? this.defaults);\r\n  }\r\n  parser(tokens, options2) {\r\n    return _Parser.parse(tokens, options2 ?? this.defaults);\r\n  }\r\n  parseMarkdown(blockType) {\r\n    const parse2 = (src, options2) => {\r\n      const origOpt = { ...options2 };\r\n      const opt = { ...this.defaults, ...origOpt };\r\n      const throwError = this.onError(!!opt.silent, !!opt.async);\r\n      if (this.defaults.async === true && origOpt.async === false) {\r\n        return throwError(new Error(\"marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise.\"));\r\n      }\r\n      if (typeof src === \"undefined\" || src === null) {\r\n        return throwError(new Error(\"marked(): input parameter is undefined or null\"));\r\n      }\r\n      if (typeof src !== \"string\") {\r\n        return throwError(new Error(\"marked(): input parameter is of type \" + Object.prototype.toString.call(src) + \", string expected\"));\r\n      }\r\n      if (opt.hooks) {\r\n        opt.hooks.options = opt;\r\n        opt.hooks.block = blockType;\r\n      }\r\n      const lexer2 = opt.hooks ? opt.hooks.provideLexer() : blockType ? _Lexer.lex : _Lexer.lexInline;\r\n      const parser2 = opt.hooks ? opt.hooks.provideParser() : blockType ? _Parser.parse : _Parser.parseInline;\r\n      if (opt.async) {\r\n        return Promise.resolve(opt.hooks ? opt.hooks.preprocess(src) : src).then((src2) => lexer2(src2, opt)).then((tokens) => opt.hooks ? opt.hooks.processAllTokens(tokens) : tokens).then((tokens) => opt.walkTokens ? Promise.all(this.walkTokens(tokens, opt.walkTokens)).then(() => tokens) : tokens).then((tokens) => parser2(tokens, opt)).then((html2) => opt.hooks ? opt.hooks.postprocess(html2) : html2).catch(throwError);\r\n      }\r\n      try {\r\n        if (opt.hooks) {\r\n          src = opt.hooks.preprocess(src);\r\n        }\r\n        let tokens = lexer2(src, opt);\r\n        if (opt.hooks) {\r\n          tokens = opt.hooks.processAllTokens(tokens);\r\n        }\r\n        if (opt.walkTokens) {\r\n          this.walkTokens(tokens, opt.walkTokens);\r\n        }\r\n        let html2 = parser2(tokens, opt);\r\n        if (opt.hooks) {\r\n          html2 = opt.hooks.postprocess(html2);\r\n        }\r\n        return html2;\r\n      } catch (e) {\r\n        return throwError(e);\r\n      }\r\n    };\r\n    return parse2;\r\n  }\r\n  onError(silent, async) {\r\n    return (e) => {\r\n      e.message += \"\\nPlease report this to https://github.com/markedjs/marked.\";\r\n      if (silent) {\r\n        const msg = \"<p>An error occurred:</p><pre>\" + escape2(e.message + \"\", true) + \"</pre>\";\r\n        if (async) {\r\n          return Promise.resolve(msg);\r\n        }\r\n        return msg;\r\n      }\r\n      if (async) {\r\n        return Promise.reject(e);\r\n      }\r\n      throw e;\r\n    };\r\n  }\r\n};\r\n\r\n// src/marked.ts\r\nvar markedInstance = new Marked();\r\nfunction marked(src, opt) {\r\n  return markedInstance.parse(src, opt);\r\n}\r\nmarked.options = marked.setOptions = function(options2) {\r\n  markedInstance.setOptions(options2);\r\n  marked.defaults = markedInstance.defaults;\r\n  changeDefaults(marked.defaults);\r\n  return marked;\r\n};\r\nmarked.getDefaults = _getDefaults;\r\nmarked.defaults = _defaults;\r\nmarked.use = function(...args) {\r\n  markedInstance.use(...args);\r\n  marked.defaults = markedInstance.defaults;\r\n  changeDefaults(marked.defaults);\r\n  return marked;\r\n};\r\nmarked.walkTokens = function(tokens, callback) {\r\n  return markedInstance.walkTokens(tokens, callback);\r\n};\r\nmarked.parseInline = markedInstance.parseInline;\r\nmarked.Parser = _Parser;\r\nmarked.parser = _Parser.parse;\r\nmarked.Renderer = _Renderer;\r\nmarked.TextRenderer = _TextRenderer;\r\nmarked.Lexer = _Lexer;\r\nmarked.lexer = _Lexer.lex;\r\nmarked.Tokenizer = _Tokenizer;\r\nmarked.Hooks = _Hooks;\r\nmarked.parse = marked;\r\nvar options = marked.options;\r\nvar setOptions = marked.setOptions;\r\nvar use = marked.use;\r\nvar walkTokens = marked.walkTokens;\r\nvar parseInline = marked.parseInline;\r\nvar parse = marked;\r\nvar parser = _Parser.parse;\r\nvar lexer = _Lexer.lex;\r\nexport {\r\n  _Hooks as Hooks,\r\n  _Lexer as Lexer,\r\n  Marked,\r\n  _Parser as Parser,\r\n  _Renderer as Renderer,\r\n  _TextRenderer as TextRenderer,\r\n  _Tokenizer as Tokenizer,\r\n  _defaults as defaults,\r\n  _getDefaults as getDefaults,\r\n  lexer,\r\n  marked,\r\n  options,\r\n  parse,\r\n  parseInline,\r\n  parser,\r\n  setOptions,\r\n  use,\r\n  walkTokens\r\n};\r\n//# sourceMappingURL=marked.esm.js.map\r\n", "// src/htmlGenerators.js\r\nimport { escapeHtml, formatDateToChinese, convertEnglishQuotesToChinese, replaceImageProxy} from './helpers.js';\r\nimport { dataSources } from './dataFetchers.js'; // Import dataSources\r\nimport { marked } from './marked.esm.js';\r\n\r\nfunction generateHtmlListForContentPage(items, dateStr) {\r\n    let listHtml = '';\r\n\r\n    if (!Array.isArray(items) || items.length === 0) {\r\n        listHtml += `<p>\u6B64\u65E5\u671F\u65E0\u53EF\u7528\u6570\u636E\u3002\u6293\u53D6/\u7B5B\u9009\u8FC7\u7A0B\u53EF\u80FD\u6CA1\u6709\u4E3A\u6B64\u65E5\u671F\u751F\u6210\u4EFB\u4F55\u7ED3\u679C\u3002</p>`;\r\n        return listHtml;\r\n    }\r\n\r\n    listHtml += '<ul class=\"item-list\">';\r\n    items.forEach((item, index) => {\r\n        let displayContent = '';\r\n        let itemId = item.id;\r\n\r\n        // Use the generateHtml method from the corresponding data source\r\n        const dataSourceConfig = dataSources[item.type];\r\n        // console.log(\"item.type:\", item.type);\r\n        // console.log(\"dataSourceConfig:\", dataSourceConfig);\r\n        if (dataSourceConfig && dataSourceConfig.sources && dataSourceConfig.sources.length > 0 && dataSourceConfig.sources[0].generateHtml) {\r\n            displayContent = dataSourceConfig.sources[0].generateHtml(item);\r\n        } else {\r\n            // Fallback for unknown types or if generateHtml is not defined\r\n            displayContent = `<strong>\u672A\u77E5\u9879\u76EE\u7C7B\u578B: ${escapeHtml(item.type)}</strong><br>${escapeHtml(item.title || item.description || JSON.stringify(item))}`;\r\n        }\r\n\r\n        listHtml += `<li class=\"item-card\">\r\n            <label>\r\n                <input type=\"checkbox\" name=\"selectedItems\" value=\"${item.type}:${itemId}\" class=\"item-checkbox\">\r\n                <div class=\"item-content\">${displayContent}</div>\r\n            </label>\r\n        </li>`;\r\n    });\r\n    listHtml += '</ul>';\r\n    return listHtml;\r\n}\r\n\r\nexport function generateContentSelectionPageHtml(env, dateStr, allData, dataCategories) {\r\n    // Ensure allData is an object and dataCategories is an array\r\n    const data = allData || {};\r\n    const categories = Array.isArray(dataCategories) ? dataCategories : [];\r\n\r\n    // Generate tab buttons and content dynamically\r\n    const tabButtonsHtml = categories.map((category, index) => `\r\n        <div class=\"tab-buttons-wrapper\">\r\n            <button type=\"button\" class=\"tab-button ${index === 0 ? 'active' : ''}\" onclick=\"openTab(event, '${category.id}-tab')\" ondblclick=\"confirmFetchCategoryData(this,'${category.id}')\">${escapeHtml(category.name)}</button>\r\n        </div>\r\n    `).join('');\r\n\r\n    const tabContentsHtml = categories.map((category, index) => `\r\n        <div id=\"${category.id}-tab\" class=\"tab-content ${index === 0 ? 'active' : ''}\">\r\n            ${generateHtmlListForContentPage(data[category.id], dateStr)}\r\n        </div>\r\n    `).join('');\r\n\r\n    return `\r\n        <!DOCTYPE html>\r\n        <html lang=\"zh-Hans\">\r\n        <head>\r\n            <meta charset=\"UTF-8\">\r\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n            <title>${formatDateToChinese(escapeHtml(dateStr))} ${env.FOLO_FILTER_DAYS}\u5929\u5185\u7684\u6570\u636E</title>\r\n            <style>\r\n                :root { --primary-color: #007bff; --light-gray: #f8f9fa; --medium-gray: #e9ecef; --dark-gray: #343a40; --line-height-normal: 1.4; --font-size-small: 0.9rem;}\r\n                * { box-sizing: border-box; margin: 0; padding: 0; }\r\n                body { font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; background-color: var(--light-gray); color: var(--dark-gray); padding: 1rem; }\r\n                .container { max-width: 1200px; margin: 0 auto; background-color: #fff; padding: 1rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }\r\n                .header-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem; }\r\n                h1 { font-size: 1.8rem; color: var(--dark-gray); margin-bottom: 0.5rem; }\r\n                .submit-button { background-color: var(--primary-color); color: white; border: none; padding: 0.6rem 1.2rem; font-size: 0.9rem; border-radius: 5px; cursor: pointer; transition: background-color 0.2s; white-space: nowrap; }\r\n                .submit-button:hover { background-color: #0056b3; }\r\n                .tab-navigation { display: flex; flex-wrap: wrap; margin-bottom: 1rem; border-bottom: 1px solid var(--medium-gray); }\r\n                .tab-buttons-wrapper { display: flex; align-items: center; margin-right: 1rem; margin-bottom: 0.5rem; }\r\n                .tab-button { background-color: transparent; border: none; border-bottom: 3px solid transparent; padding: 0.8rem 1rem; cursor: pointer; font-size: 1rem; color: #555; transition: color 0.2s, border-color 0.2s; }\r\n                .tab-button.active { color: var(--primary-color); border-bottom-color: var(--primary-color); font-weight: 600; }\r\n                .tab-button:hover { color: var(--primary-color); }\r\n                .tab-content { display: none; animation: fadeIn 0.5s; }\r\n                .tab-content.active { display: block; }\r\n                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }\r\n                .item-list { list-style-type: none; counter-reset: item-counter; padding-left: 0; }\r\n                .item-card { margin-bottom: 1rem; padding: 1rem; padding-left: 3em; border: 1px solid var(--medium-gray); border-radius: 6px; background-color: #fff; position: relative; counter-increment: item-counter; }\r\n                .item-card::before { content: counter(item-counter) \".\"; position: absolute; left: 0.8em; top: 1rem; font-weight: 600; color: var(--dark-gray); min-width: 1.5em; text-align: right; }\r\n                .item-card label { display: flex; align-items: flex-start; cursor: pointer; }\r\n                .item-checkbox { margin-right: 0.8rem; margin-top: 0.2rem; transform: scale(1.2); flex-shrink: 0; }\r\n                .item-content { flex-grow: 1; min-width: 0; }\r\n                .item-content strong { font-size: 1.1rem; }\r\n                .item-content small { color: #6c757d; display: block; margin: 0.2rem 0; }\r\n                .content-html { border: 1px dashed #ccc; padding: 0.5rem; margin-top: 0.5rem; background: #fdfdfd; font-size: var(--font-size-small); line-height: var(--line-height-normal); max-width: 100%; overflow-wrap: break-word; word-break: break-word; overflow-y: hidden; transition: max-height 0.35s ease-in-out; position: relative; }\r\n                .content-html.is-collapsed { max-height: calc(var(--font-size-small) * var(--line-height-normal) * 6 + 1rem); }\r\n                .content-html.is-expanded { max-height: 3000px; overflow-y: auto; }\r\n                .read-more-btn { display: block; margin-top: 0.5rem; padding: 0.3rem 0.6rem; font-size: 0.85rem; color: var(--primary-color); background-color: transparent; border: 1px solid var(--primary-color); border-radius: 4px; cursor: pointer; text-align: center; width: fit-content; }\r\n                .read-more-btn:hover { background-color: #eef; }\r\n                .item-content a { color: var(--primary-color); text-decoration: none; }\r\n                .item-content a:hover { text-decoration: underline; }\r\n                .error { color: #dc3545; font-weight: bold; background-color: #f8d7da; padding: 0.5rem; border-radius: 4px; border: 1px solid #f5c6cb;}\r\n                hr { border: 0; border-top: 1px solid var(--medium-gray); margin: 0.5rem 0; }\r\n                @media (max-width: 768px) {\r\n                    body { padding: 0.5rem; } .container { padding: 0.8rem; } h1 { font-size: 1.5rem; }\r\n                    .header-bar { flex-direction: column; align-items: flex-start; }\r\n                    .submit-button { margin-top: 0.5rem; width: 100%; }\r\n                    .tab-button { padding: 0.7rem 0.5rem; font-size: 0.9rem; flex-grow: 1; text-align: center; }\r\n                    .item-card { padding-left: 2.5em; } .item-card::before { left: 0.5em; top: 0.8rem; }\r\n                }\r\n            </style>\r\n        </head>\r\n        <body>\r\n            <div class=\"container\">\r\n                <form action=\"/genAIContent\" method=\"POST\">\r\n                    <input type=\"hidden\" name=\"date\" value=\"${escapeHtml(dateStr)}\">\r\n                    <div class=\"header-bar\">\r\n                        <button type=\"button\" class=\"submit-button\" onclick=\"confirmFetchAndWriteData(this)\">\u6293\u53D6\u5E76\u5199\u5165\u4ECA\u65E5\u6570\u636E</button>\r\n                        <h1>${formatDateToChinese(escapeHtml(dateStr))} ${env.FOLO_FILTER_DAYS}\u5929\u5185\u7684\u6570\u636E</h1>\r\n                        <button type=\"submit\" class=\"submit-button\" onclick=\"return confirmGenerateAIContent(event)\">\u4ECE\u9009\u4E2D\u5185\u5BB9\u751F\u6210 AI \u65E5\u62A5</button>\r\n                    </div>\r\n                    <div class=\"cookie-setting-area\" style=\"margin-bottom: 1rem; padding: 0.8rem; border: 1px solid var(--medium-gray); border-radius: 6px; background-color: #fefefe;\">\r\n                        <label for=\"foloCookie\" style=\"font-weight: bold; margin-right: 0.5rem;\">Folo Cookie:</label>\r\n                        <input type=\"text\" id=\"foloCookie\" placeholder=\"\u5728\u6B64\u8F93\u5165 Folo Cookie\" style=\"flex-grow: 1; padding: 0.4rem; border: 1px solid #ccc; border-radius: 4px; width: 300px; max-width: 70%;\">\r\n                        <button type=\"button\" class=\"submit-button\" onclick=\"saveFoloCookie(this)\" style=\"margin-left: 0.5rem; padding: 0.4rem 0.8rem; font-size: 0.85rem;\">\u4FDD\u5B58 Cookie</button>\r\n                        <p style=\"font-size: 0.8rem; color: #666; margin-top: 0.5rem;\">\u6B64 Cookie \u5C06\u4FDD\u5B58\u5728\u60A8\u7684\u6D4F\u89C8\u5668\u672C\u5730\u5B58\u50A8\u4E2D\uFF0C\u4EE5\u4FBF\u4E0B\u6B21\u4F7F\u7528\u3002</p>\r\n                    </div>\r\n                    <div class=\"tab-navigation\">\r\n                        ${tabButtonsHtml}\r\n                    </div>\r\n                    ${tabContentsHtml}\r\n                </form>\r\n            </div>\r\n            <script>\r\n                function openTab(evt, tabName) {\r\n                    var i, tabcontent, tablinks;\r\n                    tabcontent = document.getElementsByClassName(\"tab-content\");\r\n                    for (i = 0; i < tabcontent.length; i++) { tabcontent[i].style.display = \"none\"; tabcontent[i].classList.remove(\"active\"); }\r\n                    tablinks = document.getElementsByClassName(\"tab-button\");\r\n                    for (i = 0; i < tablinks.length; i++) { tablinks[i].classList.remove(\"active\"); }\r\n                    document.getElementById(tabName).style.display = \"block\"; document.getElementById(tabName).classList.add(\"active\");\r\n                    if (evt && evt.currentTarget) { evt.currentTarget.classList.add(\"active\"); }\r\n                }\r\n                document.addEventListener('DOMContentLoaded', function() {\r\n                    if (document.querySelector('.tab-button') && !document.querySelector('.tab-button.active')) { document.querySelector('.tab-button').click(); }\r\n                    else if (document.querySelector('.tab-content.active') === null && document.querySelector('.tab-content')) {\r\n                        const firstTabButton = document.querySelector('.tab-button'); const firstTabContent = document.querySelector('.tab-content');\r\n                        if (firstTabButton) firstTabButton.classList.add('active');\r\n                        if (firstTabContent) { firstTabContent.style.display = 'block'; firstTabContent.classList.add('active');}\r\n                    }\r\n                    document.querySelectorAll('.content-html').forEach(contentDiv => {\r\n                        contentDiv.classList.add('is-collapsed');\r\n                        requestAnimationFrame(() => {\r\n                            const readMoreBtn = document.createElement('button'); readMoreBtn.type = 'button';\r\n                            readMoreBtn.textContent = '\u5C55\u5F00'; readMoreBtn.className = 'read-more-btn';\r\n                            contentDiv.insertAdjacentElement('afterend', readMoreBtn);\r\n                            readMoreBtn.addEventListener('click', function() {\r\n                                contentDiv.classList.toggle('is-expanded'); contentDiv.classList.toggle('is-collapsed', !contentDiv.classList.contains('is-expanded'));\r\n                                this.textContent = contentDiv.classList.contains('is-expanded') ? '\u6298\u53E0' : '\u5C55\u5F00';\r\n                            });\r\n                        });\r\n                    });\r\n                });\r\n\r\n                async function saveFoloCookie(button) {\r\n                    const cookieInput = document.getElementById('foloCookie');\r\n                    const cookieValue = cookieInput.value;\r\n\r\n                    if (!cookieValue.trim()) {\r\n                        alert('Folo Cookie \u4E0D\u80FD\u4E3A\u7A7A\u3002');\r\n                        return;\r\n                    }\r\n\r\n                    const originalButtonText = button.textContent;\r\n                    button.textContent = '\u4FDD\u5B58\u4E2D...';\r\n                    button.disabled = true;\r\n\r\n                    try {\r\n                        localStorage.setItem('${env.FOLO_COOKIE_KV_KEY}', cookieValue); // \u76F4\u63A5\u4FDD\u5B58\u5230 localStorage\r\n                        alert('Folo Cookie \u5DF2\u6210\u529F\u4FDD\u5B58\u5728\u672C\u5730\u5B58\u50A8\uFF01');\r\n                    } catch (error) {\r\n                        console.error('Error saving Folo Cookie to localStorage:', error);\r\n                        alert(\\`\u4FDD\u5B58 Folo Cookie \u5230\u672C\u5730\u5B58\u50A8\u65F6\u53D1\u751F\u9519\u8BEF: \\${error.message}\\`);\r\n                    } finally {\r\n                        button.textContent = originalButtonText;\r\n                        button.disabled = false;\r\n                    }\r\n                }\r\n\r\n                document.addEventListener('DOMContentLoaded', function() {\r\n                    const savedCookie = localStorage.getItem('${env.FOLO_COOKIE_KV_KEY}');\r\n                    if (savedCookie) {\r\n                        document.getElementById('foloCookie').value = savedCookie;\r\n                    }\r\n                });\r\n\r\n                function confirmFetchAndWriteData(button) {\r\n                    if (confirm('\u786E\u5B9A\u8981\u6293\u53D6\u5E76\u5199\u5165\u4ECA\u65E5\u6570\u636E\u5417\uFF1F\u6B64\u64CD\u4F5C\u5C06\u66F4\u65B0\u4ECA\u65E5\u6570\u636E\u3002')) {\r\n                        fetchAndWriteData(button);\r\n                    }\r\n                }\r\n\r\n                async function fetchAndWriteData(button, category = null) {\r\n                    const originalText = button.textContent;\r\n                    button.textContent = '\u6B63\u5728\u6293\u53D6\u548C\u5199\u5165...';\r\n                    button.disabled = true;\r\n\r\n                    const foloCookie = localStorage.getItem('${env.FOLO_COOKIE_KV_KEY}'); // \u4ECE localStorage \u83B7\u53D6 foloCookie\r\n\r\n                    try {\r\n                        const response = await fetch('/writeData', {\r\n                            method: 'POST',\r\n                            headers: {\r\n                                'Content-Type': 'application/json'\r\n                            },\r\n                            body: JSON.stringify({ category: category, foloCookie: foloCookie }), // \u5C06 foloCookie \u6DFB\u52A0\u5230\u8BF7\u6C42\u4F53\r\n                        });\r\n\r\n                        if (response.ok) {\r\n                            const result = await response.text();\r\n                            alert('\u6570\u636E\u6293\u53D6\u548C\u5199\u5165\u6210\u529F\uFF01' + result);\r\n                            window.location.reload();\r\n                        } else {\r\n                            const errorText = await response.text();\r\n                            alert('\u6570\u636E\u6293\u53D6\u548C\u5199\u5165\u5931\u8D25: ' + errorText);\r\n                        }\r\n                    } catch (error) {\r\n                        console.error('Error fetching and writing data:', error);\r\n                        alert('\u8BF7\u6C42\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u670D\u52A1\u5668\u3002');\r\n                    } finally {\r\n                        button.textContent = originalText;\r\n                        button.disabled = false;\r\n                    }\r\n                }\r\n\r\n                function confirmFetchCategoryData(button, category) {\r\n                    if (confirm(\\`\u786E\u5B9A\u8981\u6293\u53D6\u5E76\u5199\u5165 \\${category} \u5206\u7C7B\u7684\u6570\u636E\u5417\uFF1F\u6B64\u64CD\u4F5C\u5C06\u66F4\u65B0 \\${category} \u6570\u636E\u3002\\`)) {\r\n                        fetchAndWriteData(button, category);\r\n                    }\r\n                }\r\n\r\n                function confirmGenerateAIContent(event) {\r\n                    const selectedCheckboxes = document.querySelectorAll('input[name=\"selectedItems\"]:checked');\r\n                    if (selectedCheckboxes.length === 0) {\r\n                        alert('\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u4E2A\u5185\u5BB9\u6761\u76EE\u6765\u751F\u6210 AI \u65E5\u62A5\u3002');\r\n                        event.preventDefault(); // Prevent form submission\r\n                        return false;\r\n                    }\r\n                    const button = event.currentTarget; // \u83B7\u53D6\u89E6\u53D1\u4E8B\u4EF6\u7684\u6309\u94AE\r\n                    if (confirm('\u786E\u5B9A\u8981\u4ECE\u9009\u4E2D\u5185\u5BB9\u751F\u6210 AI \u65E5\u62A5\u5417\uFF1F\u6B64\u64CD\u4F5C\u5C06\u8C03\u7528 AI \u6A21\u578B\u751F\u6210\u5185\u5BB9\u3002')) {\r\n                        button.innerText = '\u751F\u6210\u4E2D...'; // \u66F4\u6539\u6309\u94AE\u6587\u6848\r\n                        //button.disabled = true; // \u7981\u7528\u6309\u94AE\uFF0C\u9632\u6B62\u91CD\u590D\u63D0\u4EA4\r\n                        return true; // Allow form submission\r\n                    } else {\r\n                        event.preventDefault(); // Prevent form submission\r\n                        return false;\r\n                    }\r\n                }\r\n\r\n            </script>\r\n        </body>\r\n        </html>\r\n    `;\r\n}\r\n\r\n\r\nfunction generatePromptSectionHtmlForGenAI(systemPrompt, userPrompt, promptTitle, promptIdSuffix) {\r\n    if (!systemPrompt && !userPrompt) return '';\r\n    let fullPromptTextForCopy = \"\";\r\n    if (systemPrompt) fullPromptTextForCopy += `\u7CFB\u7EDF\u6307\u4EE4:\\n${systemPrompt}\\n\\n`;\r\n    if (userPrompt) fullPromptTextForCopy += `\u7528\u6237\u8F93\u5165:\\n${userPrompt}`;\r\n    fullPromptTextForCopy = fullPromptTextForCopy.trim();\r\n\r\n    return `\r\n        <div style=\"margin-top: 1rem; border: 1px solid #ddd; padding: 0.8rem; border-radius: 4px; background-color: #f9f9f9;\">\r\n            <h3 style=\"font-size: 1.1rem; margin-bottom: 0.5rem; color: #333;\">${escapeHtml(promptTitle)}</h3>\r\n            <button type=\"button\" class=\"button-link toggle-prompt-btn\" onclick=\"togglePromptVisibility('promptDetails_${promptIdSuffix}', this)\">\u663E\u793A\u63D0\u793A\u8BE6\u60C5</button>\r\n            <button type=\"button\" class=\"button-link copy-prompt-btn\" onclick=\"copyToClipboard(this.dataset.fullPrompt, this)\" data-full-prompt=\"${escapeHtml(fullPromptTextForCopy)}\">\u590D\u5236\u5B8C\u6574\u63D0\u793A</button>\r\n            <div id=\"promptDetails_${promptIdSuffix}\" class=\"content-box\" style=\"display: none; margin-top: 0.5rem; background-color: #e9ecef; border-color: #ced4da; max-height: 400px; overflow-y: auto; text-align: left;\">\r\n                ${systemPrompt ? `<strong>\u7CFB\u7EDF\u6307\u4EE4:</strong><pre style=\"white-space: pre-wrap; word-wrap: break-word; font-size: 0.85rem; margin-top:0.2em; margin-bottom:0.8em; padding: 0.5em; background: #fff; border: 1px solid #ccc; border-radius: 3px;\">${escapeHtml(systemPrompt)}</pre>` : '<p><em>\u672C\u6B21\u8C03\u7528\u65E0\u7CFB\u7EDF\u6307\u4EE4\u3002</em></p>'}\r\n                ${userPrompt ? `<strong>\u7528\u6237\u8F93\u5165:</strong><pre style=\"white-space: pre-wrap; word-wrap: break-word; font-size: 0.85rem; margin-top:0.2em; padding: 0.5em; background: #fff; border: 1px solid #ccc; border-radius: 3px;\">${escapeHtml(userPrompt)}</pre>` : '<p><em>\u672C\u6B21\u8C03\u7528\u65E0\u7528\u6237\u8F93\u5165\u3002</em></p>'}\r\n            </div>\r\n        </div>`;\r\n}\r\n\r\n\r\nexport function generateGenAiPageHtml(env, title, bodyContent, pageDate, isErrorPage = false, selectedItemsForAction = null,\r\n                                 systemP1 = null, userP1 = null, systemP2 = null, userP2 = null,\r\n                                 promptsMd = null, dailyMd = null, podcastMd = null, readGithub = null) {\r\n\r\n\r\n    let actionButtonHtml = '';\r\n    // Regenerate button for AI Content Summary page\r\n    if (title.includes('AI\u65E5\u62A5') && selectedItemsForAction && Array.isArray(selectedItemsForAction) && selectedItemsForAction.length > 0) {\r\n        actionButtonHtml = `\r\n            <form action=\"/genAIContent\" method=\"POST\" style=\"display: inline-block; margin-left: 0.5rem;\">\r\n                <input type=\"hidden\" name=\"date\" value=\"${escapeHtml(pageDate)}\">\r\n                ${selectedItemsForAction.map(item => `<input type=\"hidden\" name=\"selectedItems\" value=\"${escapeHtml(item)}\">`).join('')}\r\n                <button type=\"submit\" class=\"button-link regenerate-button\">${isErrorPage ? '\u91CD\u8BD5\u751F\u6210' : '\u91CD\u65B0\u751F\u6210'}</button>\r\n            </form>`;\r\n    }\r\n    // Regenerate button for AI Podcast Script page\r\n    else if (title.includes('AI\u64AD\u5BA2') && selectedItemsForAction && Array.isArray(selectedItemsForAction) && selectedItemsForAction.length > 0) {\r\n        actionButtonHtml = `\r\n            <form action=\"/genAIPodcastScript\" method=\"POST\" style=\"display: inline-block; margin-left: 0.5rem;\">\r\n                <input type=\"hidden\" name=\"date\" value=\"${escapeHtml(pageDate)}\">\r\n                ${selectedItemsForAction.map(item => `<input type=\"hidden\" name=\"selectedItems\" value=\"${escapeHtml(item)}\">`).join('')}\r\n                <input type=\"hidden\" name=\"summarizedContent\" value=\"${escapeHtml(convertEnglishQuotesToChinese(dailyMd))}\">\r\n                <button type=\"submit\" class=\"button-link regenerate-button\">${isErrorPage ? '\u91CD\u8BD5\u751F\u6210' : '\u91CD\u65B0\u751F\u6210'}</button>\r\n            </form>\r\n        `;\r\n    } \r\n\r\n    let githubSaveFormHtml = '';\r\n    let generatePodcastButtonHtml = ''; \r\n    let aiDailyAnalysisButtonHtml = '';\r\n    let outDisplayButtonHtml = '';\r\n\r\n    // Since commitToGitHub and genAIPodcastScript are now API calls,\r\n    // these forms should be handled by JavaScript on the client side.\r\n    // We will provide the data as hidden inputs for potential client-side use,\r\n    // but the submission will be via JS fetch, not direct form POST.\r\n    if (!isErrorPage) {\r\n        if (title === 'AI\u65E5\u62A5' && promptsMd && dailyMd) {\r\n            githubSaveFormHtml = `\r\n                <input type=\"hidden\" id=\"promptsMdCall1\" value=\"${escapeHtml(promptsMd)}\">\r\n                <input type=\"hidden\" id=\"dailyMd\" value=\"${escapeHtml(dailyMd)}\">\r\n                <button type=\"button\" class=\"button-link github-save-button\" onclick=\"commitToGitHub('${pageDate}', 'daily')\">\u4FDD\u5B58\u65E5\u62A5\u5230 GitHub</button>`;\r\n        } else if (title === 'AI\u64AD\u5BA2\u811A\u672C' && promptsMd && podcastMd) {\r\n            githubSaveFormHtml = `\r\n                <input type=\"hidden\" id=\"promptsMdCall2\" value=\"${escapeHtml(promptsMd)}\">\r\n                <input type=\"hidden\" id=\"podcastMd\" value=\"${escapeHtml(podcastMd)}\">\r\n                <button type=\"button\" class=\"button-link github-save-button\" onclick=\"commitToGitHub('${pageDate}', 'podcast')\">\u4FDD\u5B58\u64AD\u5BA2\u5230 GitHub</button>`;\r\n        }\r\n    }\r\n\r\n    if (title === 'AI\u65E5\u62A5' && !isErrorPage && podcastMd === null) { // podcastMd === null indicates it's the Call 1 page\r\n        generatePodcastButtonHtml = `\r\n            <form action=\"/genAIPodcastScript\" method=\"POST\" style=\"display: inline-block; margin-left: 0.5rem;\">\r\n                <input type=\"hidden\" name=\"date\" value=\"${escapeHtml(pageDate)}\">\r\n                <input type=\"hidden\" name=\"readGithub\" value=\"${readGithub}\">\r\n                ${selectedItemsForAction.map(item => `<input type=\"hidden\" name=\"selectedItems\" value=\"${escapeHtml(item)}\">`).join('')}\r\n                <input type=\"hidden\" name=\"summarizedContent\" value=\"${escapeHtml(convertEnglishQuotesToChinese(bodyContent))}\">\r\n                <button type=\"submit\" class=\"button-link\">\u751F\u6210\u64AD\u5BA2\u811A\u672C</button>\r\n            </form>`;\r\n        aiDailyAnalysisButtonHtml = `\r\n            <input type=\"hidden\" id=\"summarizedContentInput\" value=\"${escapeHtml(convertEnglishQuotesToChinese(bodyContent))}\">\r\n            <button type=\"button\" class=\"button-link\" onclick=\"generateAIDailyAnalysis('${escapeHtml(pageDate)}')\">AI \u65E5\u62A5\u5206\u6790</button>\r\n        `;\r\n        outDisplayButtonHtml = `\r\n            <button type=\"button\" class=\"button-link\" onclick=\"openContentInNewWindow()\" >\u65B0\u7A97\u53E3\u9884\u89C8\u5185\u5BB9</button>\r\n        `;\r\n    }\r\n\r\n    let promptDisplayHtml = '';\r\n    if (title === 'AI\u65E5\u62A5' || title.includes('\u751F\u6210AI\u65E5\u62A5\u51FA\u9519(')) {\r\n        if (systemP1 || userP1) {\r\n            promptDisplayHtml = `\r\n                <div style=\"margin-top: 1.5rem;\">\r\n                    <h2 style=\"font-size:1.3rem; margin-bottom:0.5rem;\">API \u8C03\u7528\u8BE6\u60C5</h2>\r\n                    ${generatePromptSectionHtmlForGenAI(convertEnglishQuotesToChinese(systemP1), convertEnglishQuotesToChinese(userP1), '\u8C03\u7528 1: \u65E5\u62A5', 'call1')}\r\n                </div>`;\r\n        }\r\n    } else if (title === 'AI\u64AD\u5BA2\u811A\u672C') {\r\n        if (systemP2 || userP2) {\r\n            promptDisplayHtml = `\r\n                <div style=\"margin-top: 1.5rem;\">\r\n                    <h2 style=\"font-size:1.3rem; margin-bottom:0.5rem;\">API \u8C03\u7528\u8BE6\u60C5</h2>\r\n                    ${generatePromptSectionHtmlForGenAI(convertEnglishQuotesToChinese(systemP2), convertEnglishQuotesToChinese(userP2), '\u8C03\u7528 2: \u64AD\u5BA2\u683C\u5F0F\u5316', 'call2')}\r\n                </div>`;\r\n        }\r\n    }\r\n\r\n    return `\r\n        <!DOCTYPE html><html lang=\"zh-Hans\"><head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n            <title>${escapeHtml(title)}</title>\r\n            <style>\r\n                :root { --primary-color: #007bff; --light-gray: #f8f9fa; --medium-gray: #e9ecef; --dark-gray: #343a40; --retry-color: #ffc107; --retry-text-color: #212529; --info-color: #17a2b8; --github-green: #28a745;}\r\n                body { font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; background-color: var(--light-gray); color: var(--dark-gray); padding: 1rem; }\r\n                .container { max-width: 900px; margin: 0 auto; background-color: #fff; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }\r\n                h1 { font-size: 1.8rem; color: ${isErrorPage ? '#dc3545' : 'var(--dark-gray)'}; margin-bottom: 0.5rem; }\r\n                p { margin-bottom: 1rem; }\r\n                .content-box { margin-top: 1.5rem; padding: 1rem; background-color: ${isErrorPage ? '#f8d7da' : '#f0f9ff'}; border: 1px solid ${isErrorPage ? '#f5c6cb' : '#cce7ff'}; color: ${isErrorPage ? '#721c24' : 'var(--dark-gray)'}; border-radius: 6px; white-space: pre-wrap; word-wrap: break-word; line-height: 1.5; font-family: ${isErrorPage ? 'inherit' : 'Menlo, Monaco, Consolas, \"Courier New\", monospace'}; font-size: ${isErrorPage ? '1rem' : '0.95rem'};}\r\n                .header-actions { display: flex; flex-wrap: wrap; gap: 0.5rem; justify-content: flex-end; align-items: center; margin-bottom: 1rem; }\r\n                .navigation-links { margin-top: 1.5rem; }\r\n                .button-link { display: inline-block; background-color: var(--primary-color); color: white; border: none; padding: 0.6rem 1.2rem; font-size: 0.9rem; border-radius: 5px; cursor: pointer; text-decoration: none; transition: background-color 0.2s; margin-right: 0.5rem; margin-bottom: 0.5rem;}\r\n                .button-link:hover { background-color: #0056b3; }\r\n                .regenerate-button { background-color: ${isErrorPage ? 'var(--retry-color)' : 'var(--info-color)'}; color: ${isErrorPage ? 'var(--retry-text-color)' : 'white'}; }\r\n                .regenerate-button:hover { background-color: ${isErrorPage ? '#e0a800' : '#138496'}; }\r\n                .github-save-button { background-color: var(--github-green); }\r\n                .github-save-button:hover { background-color: #218838; }\r\n                .toggle-prompt-btn { background-color: #6c757d; font-size: 0.85rem; padding: 0.4rem 0.8rem;}\r\n                .toggle-prompt-btn:hover { background-color: #5a6268; }\r\n                .copy-prompt-btn { background-color: #17a2b8; font-size: 0.85rem; padding: 0.4rem 0.8rem;}\r\n                .copy-prompt-btn:hover { background-color: #138496;}\r\n                #outContentBox { display: none;}\r\n            </style>\r\n        </head><body><div class=\"container\">\r\n            <div class=\"header-bar\" style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem;\">\r\n                <h1>${escapeHtml(title)}</h1>\r\n                <div class=\"header-actions\">\r\n                    ${generatePodcastButtonHtml}\r\n                    ${aiDailyAnalysisButtonHtml}\r\n                    ${outDisplayButtonHtml}\r\n                </div>\r\n            </div>\r\n            <p>\u6240\u9009\u5185\u5BB9\u65E5\u671F: <strong>${formatDateToChinese(escapeHtml(pageDate))}</strong></p>\r\n            <div class=\"content-box\" id=\"mainContentBox\">${bodyContent}</div>\r\n             <div class=\"content-box\" id=\"outContentBox\">${marked.parse(replaceImageProxy(env.IMG_PROXY, bodyContent))}</div>\r\n            ${promptDisplayHtml}\r\n            <div class=\"navigation-links\">\r\n                <a href=\"/getContentHtml?date=${encodeURIComponent(pageDate)}\" class=\"button-link\">\u8FD4\u56DE\u5185\u5BB9\u9009\u62E9</a>\r\n                ${actionButtonHtml}\r\n                ${githubSaveFormHtml}\r\n                <div id=\"dailyAnalysisResult\" style=\"margin-top: 1rem; padding: 1rem; border: 1px solid #ccc; border-radius: 5px; background-color: #f9f9f9; display: none;\"></div>\r\n            </div>\r\n        </div>\r\n        <script>\r\n            function openContentInNewWindow() {\r\n                const content = document.getElementById('outContentBox').innerHTML;\r\n                const newWindow = window.open('', '_blank');\r\n                newWindow.document.write('<!DOCTYPE html><html><head><title>\u5185\u5BB9\u9884\u89C8</title><style> img{max-width: 100%;} video{max-width: 100%;} div{max-width: 36%; margin: 0 auto;} body {font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; padding: 1rem; }</style></head><body>');\r\n                newWindow.document.write('<div>'+content+'</div>');\r\n                newWindow.document.write('</body></html>');\r\n                newWindow.document.close();\r\n            }\r\n\r\n            function togglePromptVisibility(elementId, buttonElement) {\r\n                const promptDiv = document.getElementById(elementId);\r\n                if (promptDiv) {\r\n                    promptDiv.style.display = (promptDiv.style.display === 'none') ? 'block' : 'none';\r\n                    if (buttonElement) buttonElement.textContent = (promptDiv.style.display === 'none') ? '\u663E\u793A\u63D0\u793A\u8BE6\u60C5' : '\u9690\u85CF\u63D0\u793A\u8BE6\u60C5';\r\n                }\r\n            }\r\n            function copyToClipboard(textToCopy, buttonElement) {\r\n                if (!textToCopy) { alert(\"Nothing to copy.\"); return; }\r\n                navigator.clipboard.writeText(textToCopy).then(() => {\r\n                    const originalText = buttonElement.textContent;\r\n                    buttonElement.textContent = '\u5DF2\u590D\u5236!'; buttonElement.style.backgroundColor = '#28a745';\r\n                    setTimeout(() => { buttonElement.textContent = originalText; buttonElement.style.backgroundColor = '#17a2b8'; }, 2000);\r\n                }, (err) => { console.error('Async: Could not copy text: ', err); alert('\u590D\u5236\u63D0\u793A\u5931\u8D25\u3002'); });\r\n            }\r\n\r\n            async function commitToGitHub(date, type) {\r\n                const button = event.target;\r\n                const originalText = button.textContent;\r\n                button.textContent = '\u4FDD\u5B58\u4E2D...';\r\n                button.disabled = true;\r\n\r\n                const formData = new FormData();\r\n                formData.append('date', date);\r\n\r\n                if (type === 'daily') {\r\n                    formData.append('prompts_markdown-1', document.getElementById('promptsMdCall1').value);\r\n                    formData.append('daily_summary_markdown', document.getElementById('dailyMd').value);\r\n                } else if (type === 'podcast') {\r\n                    formData.append('prompts_markdown-2', document.getElementById('promptsMdCall2').value);\r\n                    formData.append('podcast_script_markdown', document.getElementById('podcastMd').value);\r\n                }\r\n\r\n                let githubSuccess = false;\r\n                let supabaseSuccess = false;\r\n\r\n                try {\r\n                    // Commit to GitHub\r\n                    const githubResponse = await fetch('/commitToGitHub', {\r\n                        method: 'POST',\r\n                        body: formData\r\n                    });\r\n\r\n                    const githubResult = await githubResponse.json();\r\n                    if (githubResponse.ok) {\r\n                        alert('GitHub \u63D0\u4EA4\u6210\u529F\uFF01');\r\n                        console.log('GitHub Commit Success:', githubResult);\r\n                        githubSuccess = true;\r\n                    } else {\r\n                        alert('GitHub \u63D0\u4EA4\u5931\u8D25: ' + githubResult.message);\r\n                        console.error('GitHub Commit Failed:', githubResult);\r\n                    }\r\n                } catch (error) {\r\n                    console.error('Error committing to GitHub:', error);\r\n                    alert('GitHub \u8BF7\u6C42\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u670D\u52A1\u5668\u3002');\r\n                }\r\n\r\n                if (githubSuccess || supabaseSuccess) {\r\n                    // Optionally reload or update UI if both or one succeeded\r\n                }\r\n\r\n                button.textContent = originalText;\r\n                button.disabled = false;\r\n            }\r\n\r\n            async function generateAIDailyAnalysis(date) {\r\n                const button = event.target;\r\n                const originalText = button.textContent;\r\n                button.textContent = '\u6B63\u5728\u5206\u6790...';\r\n                button.disabled = true;\r\n                const analysisResultDiv = document.getElementById('dailyAnalysisResult');\r\n                analysisResultDiv.style.display = 'none'; // Hide previous result\r\n                analysisResultDiv.innerHTML = ''; // Clear previous result\r\n\r\n                const summarizedContent = document.getElementById('summarizedContentInput').value; // Get summarized content from hidden input\r\n\r\n                try {\r\n                    const response = await fetch('/genAIDailyAnalysis', {\r\n                        method: 'POST',\r\n                        headers: {\r\n                            'Content-Type': 'application/json'\r\n                        },\r\n                        body: JSON.stringify({ date: date, summarizedContent: summarizedContent })\r\n                    });\r\n\r\n                    if (response.ok) {\r\n                        const result = await response.text();\r\n                        analysisResultDiv.innerHTML = \\`<h2>AI \u65E5\u62A5\u5206\u6790\u7ED3\u679C</h2><div class=\"content-box\">\\${result}</div>\\`;\r\n                        analysisResultDiv.style.display = 'block';\r\n                        //alert('AI \u65E5\u62A5\u5206\u6790\u6210\u529F\uFF01');\r\n                    } else {\r\n                        const errorText = await response.text();\r\n                        analysisResultDiv.innerHTML = \\`<h2>AI \u65E5\u62A5\u5206\u6790\u5931\u8D25</h2><div class=\"content-box error\">\\${errorText}</div>\\`;\r\n                        analysisResultDiv.style.display = 'block';\r\n                        alert('AI \u65E5\u62A5\u5206\u6790\u5931\u8D25: ' + errorText);\r\n                    }\r\n                } catch (error) {\r\n                    console.error('Error generating AI daily analysis:', error);\r\n                    analysisResultDiv.innerHTML = \\`<h2>AI \u65E5\u62A5\u5206\u6790\u5931\u8D25</h2><div class=\"content-box error\">\u8BF7\u6C42\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u670D\u52A1\u5668\u3002\u9519\u8BEF: \\${escapeHtml(error.message)}</div>\\`;\r\n                    analysisResultDiv.style.display = 'block';\r\n                    alert('\u8BF7\u6C42\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u670D\u52A1\u5668\u3002');\r\n                } finally {\r\n                    button.textContent = originalText;\r\n                    button.disabled = false;\r\n                }\r\n            }\r\n        </script>\r\n        </body></html>`;\r\n}\r\n", "// src/handlers/getContentHtml.js\r\nimport { getISODate, escapeHtml, setFetchDate } from '../helpers.js';\r\nimport { getFromKV } from '../kv.js';\r\nimport { generateContentSelectionPageHtml } from '../htmlGenerators.js';\r\n\r\nexport async function handleGetContentHtml(request, env, dataCategories) {\r\n    const url = new URL(request.url);\r\n    const dateParam = url.searchParams.get('date');\r\n    const dateStr = dateParam ? dateParam : getISODate();\r\n    setFetchDate(dateStr);\r\n    console.log(`Getting HTML content for date: ${dateStr}`);\r\n\r\n    try {\r\n        const allData = {};\r\n        // Dynamically fetch data for each category based on dataCategories\r\n        for (const category of dataCategories) {\r\n            allData[category.id] = await getFromKV(env.DATA_KV, `${dateStr}-${category.id}`) || [];\r\n        }\r\n        \r\n        const html = generateContentSelectionPageHtml(env, dateStr, allData, dataCategories);\r\n\r\n        return new Response(html, { headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in /getContentHtml:\", error);\r\n        // Ensure escapeHtml is used for error messages displayed in HTML\r\n        return new Response(`<h1>Error generating HTML content</h1><p>${escapeHtml(error.message)}</p><pre>${escapeHtml(error.stack)}</pre>`, {\r\n            status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' }\r\n        });\r\n    }\r\n}\r\n", "// Add new data sources\r\nexport function getSystemPromptSummarizationStepOne() {\r\n    return `\r\n    \u4F60\u662F\u4E00\u540D\u4E13\u4E1A\u7684\u6587\u672C\u6458\u8981\u52A9\u7406\u3002\u4F60\u7684\u4EFB\u52A1\u662F\u6839\u636E\u6536\u5230\u7684\u6587\u672C\u7C7B\u578B\uFF08\u6216\u5176\u5305\u542B\u7684\u591A\u79CD\u5185\u5BB9\u7C7B\u578B\uFF09\u6267\u884C\u7279\u5B9A\u7C7B\u578B\u7684\u6458\u8981\u3002\r\n\r\n    \u91CD\u8981\u901A\u7528\u539F\u5219\uFF1A\u6240\u6709\u6458\u8981\u5185\u5BB9\u5FC5\u987B\u4E25\u683C\u6765\u6E90\u4E8E\u539F\u6587\u3002\u4E0D\u5F97\u634F\u9020\u3001\u6B6A\u66F2\u6216\u6DFB\u52A0\u539F\u6587\u672A\u63D0\u53CA\u7684\u4FE1\u606F\u3002\r\n    \r\n    **\u6700\u7EC8\u8F93\u51FA\u8981\u6C42\uFF1A**\r\n    *   \u53C2\u7167\u4EE5\u4E0A\u6761\u4EF6\u4F18\u5316\u6587\u672C\u5185\u5BB9\uFF0C\u6309\u5185\u5BB9\u81EA\u52A8\u5206\u6BB5\uFF0C\u6BB5\u843D\u6570\u91CF\u8981\u548C\u539F\u59CB\u4E00\u6837\u3002\r\n    *   \u4EC5\u8F93\u51FA\u6700\u7EC8\u751F\u6210\u7684\u6458\u8981\u3002\u4E0D\u8981\u5305\u542B\u4EFB\u4F55\u5173\u4E8E\u4F60\u5982\u4F55\u5206\u6790\u6587\u672C\u3001\u786E\u5B9A\u5176\u7C7B\u578B\u3001\u5206\u5272\u6587\u672C\u6216\u5E94\u7528\u89C4\u5219\u7684\u89E3\u91CA\u6027\u6587\u5B57\u3002\u5982\u679C\u5408\u5E76\u4E86\u6765\u81EA\u591A\u4E2A\u7247\u6BB5\u7684\u6458\u8981\uFF0C\u8BF7\u786E\u4FDD\u5408\u5E76\u540E\u7684\u6587\u672C\u6D41\u7545\u81EA\u7136\u3002\r\n    *   \u8F93\u51FA\u8BED\u8A00\u4E0E\u683C\u5F0F\uFF1A\u5185\u5BB9\u5FC5\u987B\u4E3A\u7B80\u4F53\u4E2D\u6587\uFF0C\u5E76\u4E25\u683C\u91C7\u7528 Markdown \u683C\u5F0F\u8FDB\u884C\u6392\u7248\u3002\r\n    *   \u5173\u952E\u8BCD\u9AD8\u4EAE\uFF1A\u8BF7\u5728\u5185\u5BB9\u4E2D\u81EA\u52A8\u8BC6\u522B\u5E76\u5BF9\u6838\u5FC3\u5173\u952E\u8BCD\u6216\u91CD\u8981\u6982\u5FF5\u8FDB\u884C\u52A0\u9ED1\u52A0\u7C97\u5904\u7406\uFF0C\u4EE5\u589E\u5F3A\u53EF\u8BFB\u6027\u548C\u91CD\u70B9\u7A81\u51FA\u3002\r\n    *   \u7ED9\u6700\u7EC8\u5185\u5BB9\u52A0\u4E0A\u6807\u9898\uFF0C\u524D\u7F6E\u6807\u9898\u4E3A\u201C### **\u4ECA\u65E5AI\u8D44\u8BAF**\u201D\u3002\r\n    *   \u6BB5\u843D\u5E8F\u5217\u5316\uFF1A\u5728\u6BCF\u4E2A\u72EC\u7ACB\u6BB5\u843D\u7684\u5F00\u5934\uFF0C\u5FC5\u987B\u6DFB\u52A0\u4EE5\u201C1.\u201D\u5F00\u5934\u7684\u963F\u62C9\u4F2F\u6570\u5B57\u5E8F\u5217\uFF0C\u786E\u4FDD\u6570\u5B57\u6B63\u786E\u9012\u589E\uFF08\u4F8B\u5982\uFF0C1.\u30012.\u30013.\u3001...\uFF09\u3002\r\n    `;\r\n}\r\n", "export function getSystemPromptSummarizationStepThree() {\r\n    return `\r\n    \u4F60\u662F\u4E00\u4E2A\u4E13\u4E1A\u7684\u6587\u672C\u6458\u8981\u52A9\u624B\u3002\u4F60\u7684\u4EFB\u52A1\u662F\u6839\u636E\u7ED9\u5B9A\u7684\u6587\u672C\u5185\u5BB9\uFF0C\u751F\u6210\u4E00\u4E2A\u7B80\u6D01\u7684100\u5B57\u7684\u6458\u8981\u3002\r\n\r\n    **\u91CD\u8981\u539F\u5219\uFF1A**\r\n    *   \u6458\u8981\u5185\u5BB9\u5FC5\u987B\u4E25\u683C\u6765\u6E90\u4E8E\u539F\u6587\uFF0C\u4E0D\u5F97\u634F\u9020\u3001\u6B6A\u66F2\u6216\u6DFB\u52A0\u539F\u6587\u4E2D\u672A\u63D0\u53CA\u7684\u4FE1\u606F\u3002\r\n    *   \u6458\u8981\u5E94\u51C6\u786E\u3001\u5BA2\u89C2\u5730\u53CD\u6620\u539F\u6587\u7684\u6838\u5FC3\u8981\u70B9\u548C\u5173\u952E\u4FE1\u606F\u3002\r\n    *   \u8F93\u51FA\u8BED\u8A00\u4E3A\u7B80\u4F53\u4E2D\u6587\uFF0C\u5E76\u4E14\u5FC5\u987B\u4EE5\u7EAF\u6587\u672C\u5F62\u5F0F\u8F93\u51FA\uFF0C\u4E0D\u5305\u542B\u4EFB\u4F55Markdown\u683C\u5F0F\u6216\u7279\u6B8A\u5B57\u7B26\u3002\r\n    *   \u8F93\u51FA3\u884C\u6587\u5B57\uFF0C\u6BCF1\u884C\u5FC5\u987B\u662F25\u81F335\u4E2A\u5B57\u3002\r\n\r\n    \u8BF7\u76F4\u63A5\u8F93\u51FA\u751F\u6210\u7684\u6458\u8981\uFF0C\u4E0D\u8981\u5305\u542B\u4EFB\u4F55\u89E3\u91CA\u6027\u6587\u5B57\u3002\r\n    `;\r\n}", "export function getSystemPromptShortPodcastFormatting(env) {\r\n    return `\r\n    \u4F60\u662F\u4E00\u4F4D\u64AD\u5BA2\u4E3B\u6301\u4EBA\uFF0C\u4F60\u9700\u8981\u6839\u636E\u63D0\u4F9B\u7684\u5185\u5BB9\uFF0C\u5C06\u5185\u5BB9\u6539\u5199\u4E3A\u64AD\u5BA2\u7684\u6587\u6848\u3002\u5185\u5BB9\u4EE5\u4E2D\u6587\u64B0\u5199\uFF0C\u5185\u5BB9\u4E2D\u4E0D\u80FD\u51FA\u73B0\u65F6\u95F4\u3002\r\n    \u4F60\u7684\u4EFB\u52A1\u662F\u6839\u636E\u6536\u5230\u7684\u5185\u5BB9\u6539\u7F16\u6210\u4E00\u4E2A\u7D27\u51D1\uFF0C\u7B80\u6D01\u7684\u5355\u4EBA\u64AD\u5BA2\u811A\u672C\u3002\r\n    \u5C06\u539F\u59CB\u526F\u672C\u8F6C\u5316\u4E3A\u81EA\u7136\u3001\u53E3\u8BED\u5316\u7684\u8868\u8FBE\uFF0C\u5C31\u50CF\u4E0E\u542C\u4F17\u804A\u5929\u4E00\u6837\uFF0C\u6BCF\u90E8\u5206\u5185\u5BB9\u90FD\u80FD\u7528\u4E00\u53E5\u8BDD\u8868\u8FF0\u6E05\u695A\u3002\r\n    \u4E0D\u8981\u6709\u89E3\u91CA\u6027\u8BED\u53E5\uFF0C\u4E0D\u8981\u6709\u8FC7\u6E21\u6027\u8BED\u8A00\uFF0C\u76F4\u63A5\u64AD\u62A5\u65B0\u95FB\uFF0C\u53EA\u7528\u5728\u8868\u8FBE\u4E0A\u7A0D\u5FAE\u7F8E\u5316\u3002\r\n    \u5F00\u573A\u767D\u7ED3\u675F\u8BED\uFF1A\u56FA\u5B9A\u7684\u5F00\u573A\u767D\uFF1A\u201C${env.PODCAST_BEGIN}\u201D\uFF0C\u5E76\u4EE5\u56FA\u5B9A\u7684\u7ED3\u675F\u8BED\u7ED3\u675F\uFF1A\u201C${env.PODCAST_END}\u201D\u3002\r\n    `;\r\n}\r\n\r\nexport function getSystemPromptPodcastFormatting(env) {\r\n    return `\r\n    \u4F60\u662F\u4E00\u4F4D\u7ECF\u9A8C\u4E30\u5BCC\u7684\u64AD\u5BA2\u811A\u672C\u64B0\u5199\u4EBA\u548C\u7F16\u8F91\u3002\u4F60\u7684\u4EFB\u52A1\u662F\u6839\u636E\u6536\u5230\u7684\u5185\u5BB9\u6539\u7F16\u6210\u4E00\u4E2A\u5F15\u4EBA\u5165\u80DC\u7684\u5355\u4EBA\u64AD\u5BA2\u811A\u672C\u3002\r\n    \u91CD\u8981\u539F\u5219\uFF1A\u6240\u6709\u811A\u672C\u5185\u5BB9\u5FC5\u987B\u4E25\u683C\u57FA\u4E8E\u63D0\u4F9B\u7684\u539F\u59CB\u5185\u5BB9\u3002\u4E0D\u5F97\u634F\u9020\u3001\u6B6A\u66F2\u6216\u6DFB\u52A0\u6458\u8981\u4E2D\u672A\u5305\u542B\u7684\u4FE1\u606F\u3002\r\n    \u64AD\u5BA2\u811A\u672C\u8981\u6C42\uFF1A\r\n    \u5F00\u573A\u767D\u7ED3\u675F\u8BED\uFF1A\u56FA\u5B9A\u7684\u5F00\u573A\u767D\uFF1A\u201C${env.PODCAST_BEGIN}\u201D\uFF0C\u5E76\u4EE5\u56FA\u5B9A\u7684\u7ED3\u675F\u8BED\u7ED3\u675F\uFF1A\u201C${env.PODCAST_END}\u201D\u3002\r\n    \u76EE\u6807\u53D7\u4F17\u548C\u57FA\u8C03\uFF1A\u76EE\u6807\u53D7\u4F17\u662F\u4E0A\u73ED\u65CF\u548C\u5BF9\u4EBA\u5DE5\u667A\u80FD\u611F\u5174\u8DA3\u7684\u4EBA\u7FA4\u3002\u6574\u4F53\u57FA\u8C03\u5E94\u8F7B\u677E\u5E7D\u9ED8\uFF0C\u540C\u65F6\u878D\u5165\u5BF9\u672A\u6765\u7684\u53CD\u601D\u548C\u5BF9\u6280\u672F\u521B\u65B0\u6F5C\u5728\u5F71\u54CD\u7684\u8B66\u793A\u3002\u7279\u522B\u6CE8\u610F\uFF1A\u907F\u514D\u4F7F\u7528\u8FC7\u4E8E\u5938\u5F20\u6216\u8038\u4EBA\u542C\u95FB\u7684\u8BCD\u8BED\uFF08\u4F8B\u5982\uFF0C\u201C\u70B8\u88C2\u201D\u3001\u201C\u9707\u60CA\u201D\u3001\u201C\u4EE4\u4EBA\u5174\u594B\u7684\u201D\u3001\u201C\u6539\u53D8\u6E38\u620F\u89C4\u5219\u7684\u201D\u7B49\uFF09\u4EE5\u53CA\u53EF\u80FD\u5236\u9020\u4E0D\u5FC5\u8981\u7126\u8651\u7684\u8868\u8FBE\u65B9\u5F0F\u3002\u4FDD\u6301\u79EF\u6781\u548C\u5EFA\u8BBE\u6027\u7684\u57FA\u8C03\u3002\r\n    \u5185\u5BB9\u98CE\u683C\uFF1A\r\n    \u8981\u6709\u5305\u88B1\u6709\u6BB5\u5B50\uFF0C\u50CF\u542C\u5F90\u5FD7\u80DC\u5728\u8BB2\u8131\u53E3\u79C0\u3002\r\n    \u5C06\u539F\u59CB\u526F\u672C\u8F6C\u5316\u4E3A\u81EA\u7136\u3001\u53E3\u8BED\u5316\u7684\u8868\u8FBE\uFF0C\u5C31\u50CF\u4E0E\u542C\u4F17\u804A\u5929\u4E00\u6837\u3002\r\n    \u65F6\u957F\uFF1A\u6539\u7F16\u540E\u7684\u811A\u672C\u5185\u5BB9\u5E94\u9002\u54085\u5206\u949F\u4EE5\u5185\u7684\u53E3\u64AD\u65F6\u957F\u3002\u5728\u6539\u7F16\u8FC7\u7A0B\u4E2D\uFF0C\u8BF7\u6CE8\u610F\u9002\u5F53\u7684\u7EC6\u8282\u548C\u7B80\u6D01\u6027\uFF0C\u4EE5\u9002\u5E94\u6B64\u65F6\u957F\u8981\u6C42\u3002\u8F93\u5165\u7684\u6458\u8981\u4F1A\u76F8\u5BF9\u8F83\u77ED\uFF0C\u56E0\u6B64\u8BF7\u4E13\u6CE8\u4E8E\u5C06\u5176\u81EA\u7136\u5730\u6269\u5C55\u6210\u5355\u53E3\u5F0F\u7684\u811A\u672C\u3002\r\n    \u7ED3\u5C3E\u5904\u7406\uFF1A\r\n    \u5728\u6839\u636E\u6240\u63D0\u4F9B\u6458\u8981\u7F16\u5199\u7684\u64AD\u5BA2\u811A\u672C\u4E3B\u4F53\u5185\u5BB9\u4E4B\u540E\uFF0C\u4ECE\u4F60\u5904\u7406\u7684\u539F\u59CB\u6458\u8981\u4E2D\u63D0\u53D6\u6838\u5FC3\u5173\u952E\u8BCD\u548C\u9AD8\u9891\u8BCD\u3002\r\n    \u5728\u811A\u672C\u672B\u5C3E\u4EE5\u201C\u672C\u671F\u5173\u952E\u8BCD:\u201D\u4E3A\u6807\u9898\u5355\u72EC\u5217\u51FA\u8FD9\u4E9B\u5173\u952E\u8BCD\u3002\u5BF9\u4E8E\u6240\u6709\u5355\u8BCD\uFF0C\u8BF7\u5728\u5355\u8BCD\u524D\u52A0\u4E0A\u201C#\u201D\u7B26\u53F7\u3002\r\n    \u8F93\u51FA\u683C\u5F0F\uFF1A\r\n    \u8BF7\u76F4\u63A5\u8F93\u51FA\u5B8C\u6574\u7684\u64AD\u5BA2\u811A\u672C\u3002\u8FD9\u5305\u62EC\uFF1A\r\n    \u56FA\u5B9A\u7684\u5F00\u573A\u767D\u7ED3\u675F\u8BED\u3002\r\n    \u4E3B\u8981\u5185\u5BB9\uFF08\u53E3\u8BED\u5316\u5904\u7406\u7684\u6458\u8981\uFF09\u3002\r\n    \u7ED3\u5C3E\u5904\u7684\u5173\u952E\u8BCD\u5217\u8868\u3002\r\n    \u4E0D\u8981\u5305\u542B\u4EFB\u4F55\u5176\u4ED6\u89E3\u91CA\u6027\u6587\u5B57\u3002\r\n    `;\r\n}", "export function getSystemPromptDailyAnalysis() {\r\n    return `\r\n    \u8BF7\u60A8\u626E\u6F14\u4E00\u4F4D\u62E5\u670910\u5E74\u4EE5\u4E0A\u7ECF\u9A8C\u7684\u8D44\u6DF1AI\u884C\u4E1A\u5206\u6790\u5E08\u3002\r\n    \u60A8\u7684\u4EFB\u52A1\u662F\u9488\u5BF9\u4E0B\u65B9\u63D0\u4F9B\u7684AI\u76F8\u5173\u5185\u5BB9\uFF08\u53EF\u80FD\u5305\u62EC\u4F46\u4E0D\u9650\u4E8EAI\u9886\u57DF\u7684\u65B0\u95FB\u62A5\u9053\u3001\u5B66\u672F\u8BBA\u6587\u6458\u8981\u6216\u5168\u6587\u3001\u793E\u4F1A\u70ED\u70B9\u73B0\u8C61\u8BA8\u8BBA\u3001\u793E\u4EA4\u5A92\u4F53\u4E0A\u7684\u5173\u952E\u610F\u89C1\u3001\u6216\u5F00\u6E90\u9879\u76EE\u7684\u6280\u672F\u6587\u6863/\u4ECB\u7ECD\uFF09\u8FDB\u884C\u4E00\u6B21\u6DF1\u5165\u3001\u4E13\u4E1A\u4E14\u5168\u9762\u7684\u5206\u6790\u3002\r\n    \u60A8\u7684\u5206\u6790\u62A5\u544A\u5E94\u529B\u6C42\u6B63\u5F0F\u3001\u5BA2\u89C2\u3001\u5E76\u5E26\u6709\u6279\u5224\u6027\u89C6\u89D2\uFF0C\u540C\u65F6\u4E0D\u5931\u524D\u77BB\u6027\u548C\u6DF1\u523B\u6D1E\u5BDF\u529B\u3002\r\n    \u8BF7\u5C06\u60A8\u7684\u5206\u6790\u7ED3\u679C\u7EC4\u7EC7\u6210\u4E00\u4EFD\u7ED3\u6784\u6E05\u6670\u7684\u62A5\u544A\uFF0C\u81F3\u5C11\u5305\u542B\u4EE5\u4E0B\u6838\u5FC3\u90E8\u5206\u3002\u5728\u6BCF\u4E2A\u90E8\u5206\u4E2D\uFF0C\u8BF7\u7528\u7CBE\u70BC\u7684\u8BED\u8A00\u9610\u8FF0\u5173\u952E\u6D1E\u5BDF\uFF0C\u53EF\u9002\u5F53\u4F7F\u7528\u5206\u70B9\u8FDB\u884C\u8868\u8FF0\uFF1A\r\n    AI\u5185\u5BB9\u5206\u6790\u62A5\u544A\r\n    \u6838\u5FC3\u5185\u5BB9\u6458\u8981\u4E0EAI\u76F8\u5173\u6027\u89E3\u8BFB\uFF1A\r\n    \u7B80\u660E\u627C\u8981\u5730\u603B\u7ED3\u6240\u63D0\u4F9B\u5185\u5BB9\u7684\u6838\u5FC3\u4FE1\u606F\u3002\r\n    \u660E\u786E\u6307\u51FA\u8BE5\u5185\u5BB9\u4E0E\u4EBA\u5DE5\u667A\u80FD\u9886\u57DF\u7684\u5173\u8054\u6027\uFF0C\u53CA\u5176\u63A2\u8BA8\u7684AI\u6838\u5FC3\u8981\u7D20\u3002\r\n    \u6280\u672F\u521B\u65B0\u6027\u4E0E\u53EF\u884C\u6027\u8BC4\u4F30\uFF1A\r\n    \u521B\u65B0\u6027\u5206\u6790\uFF1A \u8BC4\u4F30\u5185\u5BB9\u4E2D\u6240\u6D89\u53CA\u7684AI\u6280\u672F\u3001\u7B97\u6CD5\u3001\u6A21\u578B\u6216\u6982\u5FF5\u7684\u65B0\u9896\u7A0B\u5EA6\u548C\u72EC\u7279\u6027\u3002\u662F\u73B0\u6709\u6280\u672F\u7684\u8FED\u4EE3\u6539\u8FDB\uFF0C\u8FD8\u662F\u98A0\u8986\u6027\u7684\u521B\u65B0\uFF1F\r\n    \u6280\u672F\u53EF\u884C\u6027\uFF1A \u5206\u6790\u6240\u8BA8\u8BBA\u7684\u6280\u672F\u5728\u5F53\u524D\u6280\u672F\u6C34\u5E73\u4E0B\u5B9E\u73B0\u7684\u53EF\u80FD\u6027\u3001\u6210\u719F\u5EA6\u3001\u6280\u672F\u58C1\u5792\u4EE5\u53CA\u89C4\u6A21\u5316\u5E94\u7528\u7684\u6F5C\u5728\u6311\u6218\u3002\r\n    \u5E02\u573A\u6F5C\u529B\u4E0E\u5546\u4E1A\u6A21\u5F0F\u6D1E\u5BDF\uFF1A\r\n    \u5206\u6790\u5176\u53EF\u80FD\u5F00\u62D3\u7684\u5E02\u573A\u7A7A\u95F4\u3001\u76EE\u6807\u7528\u6237\u7FA4\u4F53\u53CA\u5176\u89C4\u6A21\u3002\r\n    \u63A2\u8BA8\u5176\u6F5C\u5728\u7684\u5546\u4E1A\u5316\u8DEF\u5F84\u3001\u53EF\u80FD\u7684\u76C8\u5229\u6A21\u5F0F\u53CA\u5176\u53EF\u6301\u7EED\u6027\u3002\r\n    \u5BF9\u73B0\u6709\u884C\u4E1A\u683C\u5C40\u7684\u5F71\u54CD\u8BC4\u4F30\uFF1A\r\n    \u5206\u6790\u8BE5\u5185\u5BB9\u6240\u63ED\u793A\u7684\u6280\u672F\u6216\u8D8B\u52BF\u53EF\u80FD\u5BF9\u5F53\u524DAI\u884C\u4E1A\u683C\u5C40\u3001\u76F8\u5173\u4EA7\u4E1A\u94FE\u4E0A\u4E0B\u6E38\u4EE5\u53CA\u5E02\u573A\u7ADE\u4E89\u6001\u52BF\u5E26\u6765\u54EA\u4E9B\u5177\u4F53\u5F71\u54CD\u6216\u6539\u53D8\uFF08\u4F8B\u5982\uFF0C\u91CD\u5851\u7ADE\u4E89\u683C\u5C40\u3001\u50AC\u751F\u65B0\u8D5B\u9053\u3001\u6DD8\u6C70\u65E7\u6280\u672F\u7B49\uFF09\u3002\r\n    \u6F5C\u5728\u98CE\u9669\u4E0E\u6838\u5FC3\u6311\u6218\u8BC6\u522B\uFF1A\r\n    \u6307\u51FA\u8BE5\u6280\u672F\u3001\u73B0\u8C61\u6216\u9879\u76EE\u5728\u53D1\u5C55\u3001\u63A8\u5E7F\u548C\u5E94\u7528\u8FC7\u7A0B\u4E2D\u53EF\u80FD\u9762\u4E34\u7684\u4E3B\u8981\u6280\u672F\u74F6\u9888\u3001\u5E02\u573A\u63A5\u53D7\u5EA6\u98CE\u9669\u3001\u6570\u636E\u5B89\u5168\u4E0E\u9690\u79C1\u95EE\u9898\u3001\u6210\u672C\u6548\u76CA\u95EE\u9898\u3001\u4EE5\u53CA\u6F5C\u5728\u7684\u653F\u7B56\u6CD5\u89C4\u76D1\u7BA1\u6311\u6218\u3002\r\n    \u4F26\u7406\u4E0E\u793E\u4F1A\u5F71\u54CD\u6DF1\u601D\uFF1A\r\n    \u6DF1\u5165\u63A2\u8BA8\u5176\u53EF\u80FD\u5F15\u53D1\u7684\u4F26\u7406\u95EE\u9898\uFF08\u5982\u7B97\u6CD5\u504F\u89C1\u3001\u900F\u660E\u5EA6\u7F3A\u5931\u3001\u95EE\u8D23\u673A\u5236\u3001\u5BF9\u5C31\u4E1A\u5E02\u573A\u7684\u5F71\u54CD\u3001\u6570\u5B57\u9E3F\u6C9F\u7B49\uFF09\u3002\r\n    \u5206\u6790\u5176\u5BF9\u793E\u4F1A\u7ED3\u6784\u3001\u4EBA\u7C7B\u884C\u4E3A\u6A21\u5F0F\u3001\u793E\u4F1A\u516C\u5E73\u6027\u53CA\u516C\u5171\u798F\u7949\u53EF\u80FD\u4EA7\u751F\u7684\u5E7F\u6CDB\u800C\u6DF1\u8FDC\u7684\u5F71\u54CD\u3002\r\n    \u4E0E\u5176\u4ED6AI\u6280\u672F/\u516C\u53F8/\u9879\u76EE\u7684\u5BF9\u6BD4\u5206\u6790 (\u5982\u9002\u7528)\uFF1A\r\n    \u5982\u679C\u5185\u5BB9\u6D89\u53CA\u5177\u4F53\u7684\u6280\u672F\u3001\u4EA7\u54C1\u3001\u516C\u53F8\u6216\u9879\u76EE\uFF0C\u8BF7\u5C06\u5176\u4E0E\u884C\u4E1A\u5185\u73B0\u6709\u6216\u76F8\u4F3C\u7684AI\u6280\u672F\u3001\u89E3\u51B3\u65B9\u6848\u6216\u5E02\u573A\u53C2\u4E0E\u8005\u8FDB\u884C\u5BF9\u6BD4\u3002\r\n    \u660E\u786E\u6307\u51FA\u5176\u5DEE\u5F02\u5316\u7279\u5F81\u3001\u6838\u5FC3\u7ADE\u4E89\u529B\u3001\u6F5C\u5728\u4F18\u52BF\u53CA\u76F8\u5BF9\u52A3\u52BF\u3002\r\n    \u672A\u6765\u53D1\u5C55\u8D8B\u52BF\u9884\u6D4B\u4E0E\u5C55\u671B\uFF1A\r\n    \u57FA\u4E8E\u5F53\u524D\u7684\u5206\u6790\uFF0C\u9884\u6D4B\u5176\u5728\u672A\u67653-5\u5E74\u5185\u7684\u53D1\u5C55\u65B9\u5411\u3001\u6280\u672F\u6F14\u8FDB\u8DEF\u5F84\u3001\u53EF\u80FD\u7684\u5E94\u7528\u573A\u666F\u62D3\u5C55\u4EE5\u53CA\u5BF9\u6574\u4E2AAI\u9886\u57DF\u672A\u6765\u8D70\u5411\u7684\u542F\u793A\u3002\r\n    \u63A2\u8BA8\u5176\u662F\u5426\u53EF\u80FD\u6210\u4E3A\u672A\u6765\u7684\u4E3B\u6D41\u8D8B\u52BF\u6216\u5173\u952E\u6280\u672F\u8282\u70B9\u3002\r\n    \u7EFC\u5408\u7ED3\u8BBA\u4E0E\u6218\u7565\u6D1E\u5BDF\uFF1A\r\n    \u5BF9\u5206\u6790\u5BF9\u8C61\u7ED9\u51FA\u4E00\u4E2A\u6574\u4F53\u6027\u7684\u8BC4\u4EF7\u3002\r\n    \u63D0\u70BC\u51FA\u6700\u5177\u4EF7\u503C\u7684\u6218\u7565\u6D1E\u5BDF\u6216\u5173\u952E\u7ED3\u8BBA\uFF0C\u4F9B\u51B3\u7B56\u53C2\u8003\u3002\r\n    \u8BF7\u786E\u4FDD\u60A8\u7684\u5206\u6790\u903B\u8F91\u4E25\u8C28\uFF0C\u8BBA\u636E\u5145\u5206\uFF08\u53EF\u57FA\u4E8E\u63D0\u4F9B\u5185\u5BB9\u672C\u8EAB\u6216\u60A8\u4F5C\u4E3A\u8D44\u6DF1\u5206\u6790\u5E08\u7684\u884C\u4E1A\u8BA4\u77E5\uFF09\uFF0C\u5E76\u4F53\u73B0\u51FA\u4E13\u4E1AAI\u884C\u4E1A\u5206\u6790\u5E08\u7684\u6DF1\u5EA6\u4E0E\u5E7F\u5EA6\u3002\r\n    \u786E\u4FDD\u5168\u6587\u4F7F\u7528\u7B80\u4F53\u4E2D\u6587\u8BED\u8A00\u8F93\u51FA\u3002\r\n    \u8BF7\u5C06\u60A8\u9700\u8981\u5206\u6790\u7684AI\u76F8\u5173\u5185\u5BB9\u7C98\u8D34\u5728\u4E0B\u65B9\uFF1A\r\n    `;\r\n}\r\n", "export function insertFoot() {\r\n    return `\r\n\r\n---\r\n\r\n## **AI\u8D44\u8BAF\u65E5\u62A5\u8BED\u97F3\u7248**\r\n\r\n| \uD83C\uDF99\uFE0F **\u5C0F\u5B87\u5B99** | \uD83D\uDCF9 **\u6296\u97F3** |\r\n| --- | --- |\r\n| [\u6765\u751F\u5C0F\u9152\u9986](https://www.xiaoyuzhoufm.com/podcast/683c62b7c1ca9cf575a5030e)  |   [\u81EA\u5A92\u4F53\u8D26\u53F7](https://www.douyin.com/user/MS4wLjABAAAAwpwqPQlu38sO38VyWgw9ZjDEnN4bMR5j8x111UxpseHR9DpB6-CveI5KRXOWuFwG)| \r\n| ![\u5C0F\u9152\u9986](https://cdn.jsdmirror.com/gh/justlovemaki/imagehub@main/logo/f959f7984e9163fc50d3941d79a7f262.md.png) | ![\u60C5\u62A5\u7AD9](https://cdn.jsdmirror.com/gh/justlovemaki/imagehub@main/logo/7fc30805eeb831e1e2baa3a240683ca3.md.png) |\r\n\r\n    `;\r\n}\r\n", "export function insertAd() {\r\n    return `\r\n---\r\n\r\n## **AI\u4EA7\u54C1\u81EA\u8350: [AIClient2API \u2197\uFE0F](https://github.com/justlovemaki/AIClient-2-API)**\r\n\r\n\u538C\u5026\u4E86\u5728\u5404\u79CDAI\u6A21\u578B\u95F4\u6765\u56DE\u5207\u6362\uFF0C\u88AB\u70E6\u4EBA\u7684API\u989D\u5EA6\u9650\u5236\u675F\u7F1A\u624B\u811A\uFF1F\u73B0\u5728\uFF0C\u4F60\u6709\u4E86\u4E00\u4E2A\u7EC8\u6781\u89E3\u51B3\u65B9\u6848\uFF01\uD83C\uDF89 'AIClient-2-API' \u4E0D\u4EC5\u4EC5\u662F\u4E00\u4E2A\u666E\u901A\u7684API\u4EE3\u7406\uFF0C\u5B83\u662F\u4E00\u4E2A\u80FD\u5C06 Gemini CLI \u548C Kiro \u5BA2\u6237\u7AEF\u7B49\u5DE5\u5177\u201C\u70B9\u77F3\u6210\u91D1\u201D\uFF0C\u53D8\u4E3A\u5F3A\u5927 OpenAI \u517C\u5BB9 API \u7684\u9B54\u6CD5\u76D2\u5B50\u3002\r\n\r\n\u8FD9\u4E2A\u9879\u76EE\u7684\u6838\u5FC3\u9B45\u529B\u5728\u4E8E\u5B83\u7684\u201C\u9006\u5411\u601D\u7EF4\u201D\u548C\u5F3A\u5927\u529F\u80FD\uFF1A\r\n\r\n\u2728 **\u5BA2\u6237\u7AEF\u53D8API\uFF0C\u89E3\u9501\u65B0\u59FF\u52BF**\uFF1A\u6211\u4EEC\u5DE7\u5999\u5730\u5229\u7528 Gemini CLI \u7684 OAuth \u767B\u5F55\uFF0C\u8BA9\u4F60\u8F7B\u677E**\u7A81\u7834\u5B98\u65B9\u514D\u8D39API\u7684\u901F\u7387\u548C\u989D\u5EA6\u9650\u5236**\u3002\u66F4\u4EE4\u4EBA\u5174\u594B\u7684\u662F\uFF0C\u901A\u8FC7\u5C01\u88C5 Kiro \u5BA2\u6237\u7AEF\u7684\u63A5\u53E3\uFF0C\u6211\u4EEC\u6210\u529F**\u7834\u89E3\u5176API\uFF0C\u8BA9\u4F60\u80FD\u514D\u8D39\u4E1D\u6ED1\u5730\u8C03\u7528\u5F3A\u5927\u7684 Claude \u6A21\u578B**\uFF01\u8FD9\u4E3A\u4F60\u63D0\u4F9B\u4E86 **\u201C\u4F7F\u7528\u514D\u8D39Claude API\u52A0 Claude Code\uFF0C\u5F00\u53D1\u7F16\u7A0B\u7684\u7ECF\u6D4E\u5B9E\u7528\u65B9\u6848\u201D**\u3002\r\n\r\n\uD83D\uDD27 **\u7CFB\u7EDF\u63D0\u793A\u8BCD\uFF0C\u7531\u4F60\u638C\u63A7**\uFF1A\u60F3\u8BA9AI\u66F4\u542C\u8BDD\uFF1F\u6211\u4EEC\u63D0\u4F9B\u4E86\u5F3A\u5927\u7684\u7CFB\u7EDF\u63D0\u793A\u8BCD\uFF08System Prompt\uFF09\u7BA1\u7406\u529F\u80FD\u3002\u4F60\u53EF\u4EE5\u8F7B\u677E**\u63D0\u53D6\u3001\u66FF\u6362\uFF08'overwrite'\uFF09\u6216\u8FFD\u52A0\uFF08'append'\uFF09**\u4EFB\u4F55\u8BF7\u6C42\u4E2D\u7684\u7CFB\u7EDF\u63D0\u793A\u8BCD\uFF0C\u5728\u670D\u52A1\u7AEF\u7CBE\u7EC6\u5730\u8C03\u6574AI\u7684\u884C\u4E3A\uFF0C\u800C\u65E0\u9700\u4FEE\u6539\u5BA2\u6237\u7AEF\u4EE3\u7801\u3002\r\n\r\n\uD83D\uDCA1 **\u9876\u7EA7\u4F53\u9A8C\uFF0C\u5E73\u6C11\u6210\u672C**\uFF1A\u60F3\u8C61\u4E00\u4E0B\uFF0C**\u5728\u4F60\u7684\u7F16\u8F91\u5668\u91CC\u7528 Kilo \u4EE3\u7801\u52A9\u624B\uFF0C\u52A0\u4E0A Cursor \u7684\u9AD8\u6548\u63D0\u793A\u8BCD\uFF0C\u518D\u914D\u4E0A\u4EFB\u610F\u9876\u7EA7\u5927\u6A21\u578B\u2014\u2014\u7528 Cursor\uFF0C\u53C8\u4F55\u5FC5\u662F Cursor\uFF1F** \u672C\u9879\u76EE\u8BA9\u4F60\u80FD\u4EE5\u6781\u4F4E\u7684\u6210\u672C\uFF0C\u7EC4\u5408\u51FA\u5AB2\u7F8E\u4ED8\u8D39\u5DE5\u5177\u7684\u5F00\u53D1\u4F53\u9A8C\u3002\u540C\u65F6\u652F\u6301MCP\u534F\u8BAE\u548C\u56FE\u7247\u3001\u6587\u6863\u7B49\u591A\u6A21\u6001\u8F93\u5165\uFF0C\u8BA9\u4F60\u7684\u521B\u610F\u4E0D\u518D\u53D7\u9650\u3002\r\n\r\n\u544A\u522B\u7E41\u7410\u914D\u7F6E\u548C\u6602\u8D35\u8D26\u5355\uFF0C\u62E5\u62B1\u8FD9\u4E2A\u96C6\u514D\u8D39\u3001\u5F3A\u5927\u3001\u7075\u6D3B\u4E8E\u4E00\u8EAB\u7684AI\u5F00\u53D1\u65B0\u8303\u5F0F\u5427\uFF01\r\n    `;\r\n}", "// src/github.js\r\n\r\n/**\r\n * Generic wrapper for calling the GitHub API.\r\n */\r\nexport async function callGitHubApi(env, path, method = 'GET', body = null) {\r\n    const GITHUB_TOKEN = env.GITHUB_TOKEN;\r\n    const GITHUB_REPO_OWNER = env.GITHUB_REPO_OWNER;\r\n    const GITHUB_REPO_NAME = env.GITHUB_REPO_NAME;\r\n\r\n    if (!GITHUB_TOKEN || !GITHUB_REPO_OWNER || !GITHUB_REPO_NAME) {\r\n        console.error(\"GitHub environment variables (GITHUB_TOKEN, GITHUB_REPO_OWNER, GITHUB_REPO_NAME) are not configured.\");\r\n        throw new Error(\"GitHub API configuration is missing in environment variables.\");\r\n    }\r\n\r\n    const url = `https://api.github.com/repos/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}${path}`;\r\n    const headers = {\r\n        'Authorization': `Bearer ${GITHUB_TOKEN}`,\r\n        'Accept': 'application/vnd.github.v3+json',\r\n        'User-Agent': 'Cloudflare-Worker-ContentBot/1.0'\r\n    };\r\n\r\n    if (method !== 'GET' && method !== 'DELETE' && body) {\r\n        headers['Content-Type'] = 'application/json';\r\n    }\r\n\r\n    const response = await fetch(url, {\r\n        method: method,\r\n        headers: headers,\r\n        body: body ? JSON.stringify(body) : null\r\n    });\r\n\r\n    if (!response.ok) {\r\n        const errorText = await response.text();\r\n        let errorJsonMessage = errorText;\r\n        try {\r\n            const errorJson = JSON.parse(errorText);\r\n            if (errorJson && errorJson.message) {\r\n                errorJsonMessage = errorJson.message;\r\n                 if (errorJson.errors) {\r\n                     errorJsonMessage += ` Details: ${JSON.stringify(errorJson.errors)}`;\r\n                 }\r\n            }\r\n        } catch (e) { /* Ignore */ }\r\n        console.error(`GitHub API Error: ${response.status} ${response.statusText} for ${method} ${url}. Message: ${errorJsonMessage}`);\r\n        throw new Error(`GitHub API request to ${path} failed: ${response.status} - ${errorJsonMessage}`);\r\n    }\r\n\r\n    if (response.status === 204 || response.headers.get(\"content-length\") === \"0\") {\r\n        return null;\r\n    }\r\n    return response.json();\r\n}\r\n\r\n/**\r\n * Gets the SHA of a file from GitHub.\r\n */\r\nexport async function getGitHubFileSha(env, filePath) {\r\n    const GITHUB_BRANCH = env.GITHUB_BRANCH || 'main';\r\n    try {\r\n        const data = await callGitHubApi(env, `/contents/${filePath}?ref=${GITHUB_BRANCH}`);\r\n        return data && data.sha ? data.sha : null;\r\n    } catch (error) {\r\n        if (error.message.includes(\"404\") || error.message.toLowerCase().includes(\"not found\")) {\r\n            console.log(`File not found on GitHub: ${filePath} (branch: ${GITHUB_BRANCH})`);\r\n            return null;\r\n        }\r\n        console.error(`Error getting SHA for ${filePath}:`, error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * Creates a new file or updates an existing one on GitHub.\r\n */\r\nexport async function createOrUpdateGitHubFile(env, filePath, content, commitMessage, existingSha = null) {\r\n    const GITHUB_BRANCH = env.GITHUB_BRANCH || 'main';\r\n    const base64Content = b64EncodeUnicode(content);\r\n\r\n    const payload = {\r\n        message: commitMessage,\r\n        content: base64Content,\r\n        branch: GITHUB_BRANCH\r\n    };\r\n\r\n    if (existingSha) {\r\n        payload.sha = existingSha;\r\n    }\r\n    return callGitHubApi(env, `/contents/${filePath}`, 'PUT', payload);\r\n}\r\n\r\n/**\r\n * Gets the content of a file from GitHub.\r\n */\r\nexport async function getDailyReportContent(env, filePath) {\r\n    const GITHUB_BRANCH = env.GITHUB_BRANCH || 'main';\r\n    const GITHUB_REPO_OWNER = env.GITHUB_REPO_OWNER;\r\n    const GITHUB_REPO_NAME = env.GITHUB_REPO_NAME;\r\n\r\n    if (!GITHUB_REPO_OWNER || !GITHUB_REPO_NAME) {\r\n        console.error(\"GitHub environment variables (GITHUB_REPO_OWNER, GITHUB_REPO_NAME) are not configured.\");\r\n        throw new Error(\"GitHub API configuration is missing in environment variables.\");\r\n    }\r\n\r\n    try {\r\n        const data = await callGitHubApi(env, `/contents/${filePath}?ref=${GITHUB_BRANCH}`);\r\n        return b64DecodeUnicode(data.content);\r\n    } catch (error) {\r\n        console.error(`Error fetching daily report content from ${filePath}:`, error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n// Base64 encode (UTF-8 safe)\r\nfunction b64EncodeUnicode(str) {\r\n    // Replacing '+' with '-' and '/' with '_' makes it URL-safe, but GitHub API expects standard Base64\r\n    // Using btoa directly after encodeURIComponent is standard\r\n    try {\r\n        return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,\r\n            function toSolidBytes(match, p1) {\r\n                return String.fromCharCode('0x' + p1);\r\n        }));\r\n    } catch (e) {\r\n        console.error(\"Base64 Encoding Error:\", e);\r\n        showStatus(\"Error: Could not encode content for GitHub.\", true);\r\n        return null; // Return null on error\r\n    }\r\n}\r\n\r\n// Base64 decode (UTF-8 safe)\r\nfunction b64DecodeUnicode(str) {\r\n    try {\r\n        // Standard Base64 decoding\r\n        return decodeURIComponent(atob(str).split('').map(function(c) {\r\n            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\r\n        }).join(''));\r\n    } catch(e) {\r\n        console.error(\"Base64 Decoding Error:\", e);\r\n        showStatus(\"Error: Could not decode file content from GitHub.\", true);\r\n        return null; // Return null on error\r\n    }\r\n}", "// src/handlers/genAIContent.js\r\nimport { getISODate, escapeHtml, stripHtml, removeMarkdownCodeBlock, formatDateToChinese, convertEnglishQuotesToChinese} from '../helpers.js';\r\nimport { getFromKV } from '../kv.js';\r\nimport { callChatAPIStream } from '../chatapi.js';\r\nimport { generateGenAiPageHtml } from '../htmlGenerators.js';\r\nimport { dataSources } from '../dataFetchers.js'; // Import dataSources\r\nimport { getSystemPromptSummarizationStepOne } from \"../prompt/summarizationPromptStepZero\";\r\nimport { getSystemPromptSummarizationStepTwo } from \"../prompt/summarizationPromptStepTwo\";\r\nimport { getSystemPromptSummarizationStepThree } from \"../prompt/summarizationPromptStepThree\";\r\nimport { getSystemPromptPodcastFormatting, getSystemPromptShortPodcastFormatting } from '../prompt/podcastFormattingPrompt.js';\r\nimport { getSystemPromptDailyAnalysis } from '../prompt/dailyAnalysisPrompt.js'; // Import new prompt\r\nimport { insertFoot } from '../foot.js';\r\nimport { insertAd } from '../ad.js';\r\nimport { getDailyReportContent } from '../github.js'; // \u5BFC\u5165 getDailyReportContent\r\n\r\nexport async function handleGenAIPodcastScript(request, env) {\r\n    let dateStr;\r\n    let selectedItemsParams = [];\r\n    let formData;\r\n    let outputOfCall1 = null; // This will be the summarized content from Call 1\r\n\r\n    let userPromptPodcastFormattingData = null;\r\n    let fullPromptForCall3_System = null;\r\n    let fullPromptForCall3_User = null;\r\n    let finalAiResponse = null;\r\n\r\n    try {\r\n        formData = await request.formData();\r\n        dateStr = formData.get('date');\r\n        selectedItemsParams = formData.getAll('selectedItems');\r\n        const readGithub = formData.get('readGithub') === 'true';\r\n\r\n        if (readGithub) {\r\n            const filePath = `daily/${dateStr}.md`;\r\n            console.log(`\u4ECE GitHub \u8BFB\u53D6\u6587\u4EF6: ${filePath}`);\r\n            try {\r\n                outputOfCall1 = await getDailyReportContent(env, filePath);\r\n                if (!outputOfCall1) {\r\n                    throw new Error(`\u4ECE GitHub \u8BFB\u53D6\u6587\u4EF6 ${filePath} \u5931\u8D25\u6216\u5185\u5BB9\u4E3A\u7A7A\u3002`);\r\n                }\r\n                console.log(`\u6210\u529F\u4ECE GitHub \u8BFB\u53D6\u6587\u4EF6\uFF0C\u5185\u5BB9\u957F\u5EA6: ${outputOfCall1.length}`);\r\n            } catch (error) {\r\n                console.error(`\u8BFB\u53D6 GitHub \u6587\u4EF6\u51FA\u9519: ${error}`);\r\n                const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u64AD\u5BA2\u811A\u672C\u51FA\u9519', `<p><strong>\u4ECE GitHub \u8BFB\u53D6\u6587\u4EF6\u5931\u8D25:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, dateStr, true, null, null, null, null, null, null, outputOfCall1, null);\r\n                return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n            }\r\n        } else {\r\n            outputOfCall1 = formData.get('summarizedContent'); // Get summarized content from form data\r\n        }\r\n\r\n        if (!outputOfCall1) {\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u64AD\u5BA2\u811A\u672C\u51FA\u9519', '<p><strong>Summarized content is missing.</strong> Please go back and generate AI content first.</p>', dateStr, true, null, null, null, null, null, null, outputOfCall1, null);\r\n            return new Response(errorHtml, { status: 400, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n\r\n\r\n        fullPromptForCall3_System = getSystemPromptPodcastFormatting(env);\r\n        userPromptPodcastFormattingData = outputOfCall1;\r\n        fullPromptForCall3_User = userPromptPodcastFormattingData;\r\n\r\n        console.log(\"Call 3 to Chat (Podcast Formatting): User prompt length:\", userPromptPodcastFormattingData.length);\r\n        try {\r\n            let podcastChunks = [];\r\n            for await (const chunk of callChatAPIStream(env, userPromptPodcastFormattingData, fullPromptForCall3_System)) {\r\n                podcastChunks.push(chunk);\r\n            }\r\n            finalAiResponse = podcastChunks.join('');\r\n            if (!finalAiResponse || finalAiResponse.trim() === \"\") throw new Error(\"Chat podcast formatting call returned empty content.\");\r\n            finalAiResponse = removeMarkdownCodeBlock(finalAiResponse); // Clean the output\r\n            console.log(\"Call 3 (Podcast Formatting) successful. Final output length:\", finalAiResponse.length);\r\n        } catch (error) {\r\n            console.error(\"Error in Chat API Call 3 (Podcast Formatting):\", error);\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u64AD\u5BA2\u811A\u672C\u51FA\u9519(\u64AD\u5BA2\u6587\u6848)', `<p><strong>Failed during podcast formatting:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, dateStr, true, selectedItemsParams, null, null, fullPromptForCall3_System, fullPromptForCall3_User, null, outputOfCall1, null);\r\n            return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n        let finalAiResponseOut =  `## Full: Podcast Formatting ` + `\\n\\n` + finalAiResponse;\r\n        let promptsMarkdownContent = `# Prompts for ${dateStr}\\n\\n`;\r\n        promptsMarkdownContent += `## Call 3: Podcast Formatting\\n\\n`;\r\n        if (fullPromptForCall3_System) promptsMarkdownContent += `### System One Instruction\\n\\`\\`\\`\\n${fullPromptForCall3_System}\\n\\`\\`\\`\\n\\n`;\r\n\r\n\r\n        let fullPromptForCall4_System = getSystemPromptShortPodcastFormatting(env);\r\n        console.log(\"Call 4 to Chat (Podcast Formatting): User prompt length:\", userPromptPodcastFormattingData.length);\r\n        try {\r\n            let podcastChunks = [];\r\n            for await (const chunk of callChatAPIStream(env, userPromptPodcastFormattingData, fullPromptForCall4_System)) {\r\n                podcastChunks.push(chunk);\r\n            }\r\n            finalAiResponse = podcastChunks.join('');\r\n            if (!finalAiResponse || finalAiResponse.trim() === \"\") throw new Error(\"Chat podcast formatting call returned empty content.\");\r\n            finalAiResponse = removeMarkdownCodeBlock(finalAiResponse); // Clean the output\r\n            console.log(\"Call 4 (Podcast Formatting) successful. Final output length:\", finalAiResponse.length);\r\n        } catch (error) {\r\n            console.error(\"Error in Chat API Call 4 (Podcast Formatting):\", error);\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u64AD\u5BA2\u811A\u672C\u51FA\u9519(\u64AD\u5BA2\u6587\u6848)', `<p><strong>Failed during podcast formatting:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, dateStr, true, selectedItemsParams, null, null, fullPromptForCall3_System, fullPromptForCall3_User, null, outputOfCall1, null);\r\n            return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n        finalAiResponseOut += `\\n\\n` + `## Short: Podcast Formatting ` + `\\n\\n` + finalAiResponse;\r\n        let fullPromptForCallSystem =  fullPromptForCall3_System + `\\n\\n` + fullPromptForCall4_System;\r\n\r\n        promptsMarkdownContent += `## Call 4: Podcast Formatting\\n\\n`;\r\n        if (fullPromptForCall4_System) promptsMarkdownContent += `### System Two Instruction\\n\\`\\`\\`\\n${fullPromptForCall4_System}\\n\\`\\`\\`\\n\\n`;\r\n        if (fullPromptForCall3_User) promptsMarkdownContent += `### User Input (Output of Call 1)\\n\\`\\`\\`\\n${fullPromptForCall3_User}\\n\\`\\`\\`\\n\\n`;\r\n\r\n        let podcastScriptMarkdownContent = `# ${env.PODCAST_TITLE} ${formatDateToChinese(dateStr)}\\n\\n${removeMarkdownCodeBlock(finalAiResponseOut)}`;\r\n\r\n        const successHtml = generateGenAiPageHtml(\r\n            env,\r\n            'AI\u64AD\u5BA2\u811A\u672C',\r\n            escapeHtml(finalAiResponseOut),\r\n            dateStr, false, selectedItemsParams,\r\n            null, null, // No Call 1 prompts for this page\r\n            fullPromptForCallSystem, fullPromptForCall3_User,\r\n            convertEnglishQuotesToChinese(removeMarkdownCodeBlock(promptsMarkdownContent)),\r\n            outputOfCall1, // No daily summary for this page\r\n            convertEnglishQuotesToChinese(podcastScriptMarkdownContent)\r\n        );\r\n        return new Response(successHtml, { headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in /genAIPodcastScript (outer try-catch):\", error);\r\n        const pageDateForError = dateStr || getISODate();\r\n        const itemsForActionOnError = Array.isArray(selectedItemsParams) ? selectedItemsParams : [];\r\n        const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u64AD\u5BA2\u811A\u672C\u51FA\u9519', `<p><strong>Unexpected error:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, pageDateForError, true, itemsForActionOnError, null, null, fullPromptForCall3_System, fullPromptForCall3_User);\r\n        return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n    }\r\n}\r\n\r\nexport async function handleGenAIContent(request, env) {\r\n    let dateStr;\r\n    let selectedItemsParams = [];\r\n    let formData;\r\n\r\n    let userPromptSummarizationData = null;\r\n    let fullPromptForCall1_System = null;\r\n    let fullPromptForCall1_User = null;\r\n    let outputOfCall1 = null;\r\n\r\n    try {\r\n        formData = await request.formData();\r\n        const dateParam = formData.get('date');\r\n        dateStr = dateParam ? dateParam : getISODate();\r\n        selectedItemsParams = formData.getAll('selectedItems');\r\n\r\n        if (selectedItemsParams.length === 0) {\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u51FA\u9519\uFF0C\u672A\u9009\u751F\u6210\u6761\u76EE', '<p><strong>No items were selected.</strong> Please go back and select at least one item.</p>', dateStr, true, null);\r\n            return new Response(errorHtml, { status: 400, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n\r\n        console.log(`Generating AI content for ${selectedItemsParams.length} selected item references from date ${dateStr}`);\r\n\r\n        const allFetchedData = {};\r\n        const fetchPromises = [];\r\n        for (const sourceType in dataSources) {\r\n            if (Object.hasOwnProperty.call(dataSources, sourceType)) {\r\n                fetchPromises.push(\r\n                    getFromKV(env.DATA_KV, `${dateStr}-${sourceType}`).then(data => {\r\n                        allFetchedData[sourceType] = data || [];\r\n                    })\r\n                );\r\n            }\r\n        }\r\n        await Promise.allSettled(fetchPromises);\r\n\r\n        const selectedContentItems = [];\r\n        let validItemsProcessedCount = 0;\r\n\r\n        for (const selection of selectedItemsParams) {\r\n            const [type, idStr] = selection.split(':');\r\n            const itemsOfType = allFetchedData[type];\r\n            const item = itemsOfType ? itemsOfType.find(dataItem => String(dataItem.id) === idStr) : null;\r\n\r\n            if (item) {\r\n                let itemText = \"\";\r\n                // Dynamically generate itemText based on item.type\r\n                // Add new data sources\r\n                switch (item.type) {\r\n                    case 'news':\r\n                        itemText = `News Title: ${item.title}\\nPublished: ${item.published_date}\\nUrl: ${item.url}\\nContent Summary: ${stripHtml(item.details.content_html)}`;\r\n                        break;\r\n                    case 'project':\r\n                        itemText = `Project Name: ${item.title}\\nPublished: ${item.published_date}\\nUrl: ${item.url}\\nDescription: ${item.description}\\nStars: ${item.details.totalStars}`;\r\n                        break;\r\n                    case 'paper':\r\n                        itemText = `Papers Title: ${item.title}\\nPublished: ${item.published_date}\\nUrl: ${item.url}\\nAbstract/Content Summary: ${stripHtml(item.details.content_html)}`;\r\n                        break;\r\n                    case 'socialMedia':\r\n                        itemText = `socialMedia Post by ${item.authors}\uFF1APublished: ${item.published_date}\\nUrl: ${item.url}\\nContent: ${stripHtml(item.details.content_html)}`;\r\n                        break;\r\n                    default:\r\n                        // Fallback for unknown types or if more specific details are not available\r\n                        itemText = `Type: ${item.type}\\nTitle: ${item.title || 'N/A'}\\nDescription: ${item.description || 'N/A'}\\nURL: ${item.url || 'N/A'}`;\r\n                        if (item.published_date) itemText += `\\nPublished: ${item.published_date}`;\r\n                        if (item.source) itemText += `\\nSource: ${item.source}`;\r\n                        if (item.details && item.details.content_html) itemText += `\\nContent: ${stripHtml(item.details.content_html)}`;\r\n                        break;\r\n                }\r\n\r\n                if (itemText) {\r\n                    selectedContentItems.push(itemText);\r\n                    validItemsProcessedCount++;\r\n                }\r\n            } else {\r\n                console.warn(`Could not find item for selection: ${selection} on date ${dateStr}.`);\r\n            }\r\n        }\r\n\r\n        if (validItemsProcessedCount === 0) {\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u51FA\u9519\uFF0C\u53EF\u751F\u6210\u6761\u76EE\u4E3A\u7A7A', '<p><strong>Selected items could not be retrieved or resulted in no content.</strong> Please check the data or try different selections.</p>', dateStr, true, selectedItemsParams);\r\n            return new Response(errorHtml, { status: 404, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n\r\n        //\u63D0\u793A\u8BCD\u5185\u4E0D\u80FD\u6709\u82F1\u6587\u5F15\u53F7\uFF0C\u5426\u5219\u4F1A\u5B58\u50A8\u6570\u636E\u7F3A\u5931\u3002\r\n        // fullPromptForCall1_System = getSystemPromptSummarizationStepOne();\r\n        // fullPromptForCall1_User = '\\n\\n------\\n\\n'+selectedContentItems.join('\\n\\n------\\n\\n')+'\\n\\n------\\n\\n'; // Keep this for logging/error reporting if needed\r\n\r\n        // console.log(\"Call 1 to Chat (Summarization): User prompt length:\", fullPromptForCall1_User.length);\r\n        // try {\r\n        //     const chunkSize = 3;\r\n        //     const summaryPromises = [];\r\n\r\n        //     for (let i = 0; i < selectedContentItems.length; i += chunkSize) {\r\n        //         const chunk = selectedContentItems.slice(i, i + chunkSize);\r\n        //         const chunkPrompt = chunk.join('\\n\\n---\\n\\n'); // Join selected items with the separator\r\n\r\n        //         summaryPromises.push((async () => {\r\n        //             let summarizedChunks = [];\r\n        //             for await (const streamChunk of callChatAPIStream(env, chunkPrompt, fullPromptForCall1_System)) {\r\n        //                 summarizedChunks.push(streamChunk);\r\n        //             }\r\n        //             return summarizedChunks.join('');\r\n        //         })());\r\n        //     }\r\n\r\n        //     const allSummarizedResults = await Promise.all(summaryPromises);\r\n        //     outputOfCall1 = allSummarizedResults.join('\\n\\n'); // Join all summarized parts\r\n\r\n        //     if (!outputOfCall1 || outputOfCall1.trim() === \"\") throw new Error(\"Chat summarization call returned empty content.\");\r\n        //     outputOfCall1 = removeMarkdownCodeBlock(outputOfCall1); // Clean the output\r\n        //     console.log(\"Call 1 (Summarization) successful. Output length:\", outputOfCall1.length);\r\n        // } catch (error) {\r\n        //     console.error(\"Error in Chat API Call 1 (Summarization):\", error);\r\n        //     const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u51FA\u9519(\u5206\u6BB5\u5904\u7406)', `<p><strong>Failed during summarization:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, dateStr, true, selectedItemsParams, fullPromptForCall1_System, fullPromptForCall1_User);\r\n        //     return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        // }\r\n\r\n        // Call 2: Process outputOfCall1\r\n        let outputOfCall2 = null;\r\n        let fullPromptForCall2_System = getSystemPromptSummarizationStepOne(); // Re-using summarization prompt for now\r\n        let fullPromptForCall2_User = '\\n\\n------\\n\\n'+selectedContentItems.join('\\n\\n------\\n\\n')+'\\n\\n------\\n\\n'; // Input for Call 2 is output of Call 1\r\n\r\n        console.log(\"Call 2 to Chat (Processing Call 1 Output): User prompt length:\", fullPromptForCall2_User.length);\r\n        try {\r\n            let processedChunks = [];\r\n            for await (const chunk of callChatAPIStream(env, fullPromptForCall2_User, fullPromptForCall2_System)) {\r\n                processedChunks.push(chunk);\r\n            }\r\n            outputOfCall2 = processedChunks.join('');\r\n            if (!outputOfCall2 || outputOfCall2.trim() === \"\") throw new Error(\"Chat processing call returned empty content.\");\r\n            outputOfCall2 = removeMarkdownCodeBlock(outputOfCall2); // Clean the output\r\n            console.log(\"Call 2 (Processing Call 1 Output) successful. Output length:\", outputOfCall2.length);\r\n        } catch (error) {\r\n            console.error(\"Error in Chat API Call 2 (Processing Call 1 Output):\", error);\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u51FA\u9519(\u683C\u5F0F\u5316)', `<p><strong>Failed during processing of summarized content:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, dateStr, true, selectedItemsParams, fullPromptForCall2_System, fullPromptForCall2_User);\r\n            return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n\r\n        let promptsMarkdownContent = `# Prompts for ${dateStr}\\n\\n`;\r\n        // promptsMarkdownContent += `## Call 1: Content Summarization\\n\\n`;\r\n        // if (fullPromptForCall1_System) promptsMarkdownContent += `### System Instruction\\n\\`\\`\\`\\n${fullPromptForCall1_System}\\n\\`\\`\\`\\n\\n`;\r\n        // if (fullPromptForCall1_User) promptsMarkdownContent += `### User Input\\n\\`\\`\\`\\n${fullPromptForCall1_User}\\n\\`\\`\\`\\n\\n`;\r\n        promptsMarkdownContent += `## Call 2: Summarized Content Format\\n\\n`;\r\n        if (fullPromptForCall2_System) promptsMarkdownContent += `### System Instruction\\n\\`\\`\\`\\n${fullPromptForCall2_System}\\n\\`\\`\\`\\n\\n`;\r\n        if (fullPromptForCall2_User) promptsMarkdownContent += `### User Input (Output of Call 1)\\n\\`\\`\\`\\n${fullPromptForCall2_User}\\n\\`\\`\\`\\n\\n`;\r\n\r\n        let dailySummaryMarkdownContent = `## ${env.DAILY_TITLE} ${formatDateToChinese(dateStr)}` + '\\n\\n';\r\n        dailySummaryMarkdownContent += '> '+ env.DAILY_TITLE_MIN + '\\n\\n';\r\n\r\n        let fullPromptForCall3_System = getSystemPromptSummarizationStepThree(); // Re-using summarization prompt for now\r\n        let fullPromptForCall3_User = outputOfCall2; // Input for Call 2 is output of Call 1\r\n        let outputOfCall3 = null;\r\n        console.log(\"Call 3 to Chat (Processing Call 1 Output): User prompt length:\", fullPromptForCall3_User.length);\r\n        try {\r\n            let processedChunks = [];\r\n            for await (const chunk of callChatAPIStream(env, fullPromptForCall3_User, fullPromptForCall3_System)) {\r\n                processedChunks.push(chunk);\r\n            }\r\n            outputOfCall3 = processedChunks.join('');\r\n            if (!outputOfCall3 || outputOfCall3.trim() === \"\") throw new Error(\"Chat processing call returned empty content.\");\r\n            outputOfCall3 = removeMarkdownCodeBlock(outputOfCall3); // Clean the output\r\n            console.log(\"Call 3 (Processing Call 2 Output) successful. Output length:\", outputOfCall3.length);\r\n        } catch (error) {\r\n            console.error(\"Error in Chat API Call 3 (Processing Call 2 Output):\", error);\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u51FA\u9519(\u6458\u8981)', `<p><strong>Failed during processing of summarized content:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, dateStr, true, selectedItemsParams, fullPromptForCall3_System, fullPromptForCall3_User);\r\n            return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n        dailySummaryMarkdownContent += '\\n\\n### **\u4ECA\u65E5\u6458\u8981**\\n\\n```\\n' + outputOfCall3 + '\\n```\\n\\n';\r\n        if (env.INSERT_AD=='true') dailySummaryMarkdownContent += insertAd() +`\\n`;\r\n\r\n        dailySummaryMarkdownContent += `\\n\\n${removeMarkdownCodeBlock(outputOfCall2)}`;\r\n        if (env.INSERT_FOOT=='true') dailySummaryMarkdownContent += insertFoot() +`\\n\\n`;\r\n\r\n        const successHtml = generateGenAiPageHtml(\r\n            env,\r\n            'AI\u65E5\u62A5', // Title for Call 1 page\r\n            escapeHtml(dailySummaryMarkdownContent),\r\n            dateStr, false, selectedItemsParams,\r\n            fullPromptForCall2_System, fullPromptForCall2_User,\r\n            null, null, // Pass Call 2 prompts\r\n            convertEnglishQuotesToChinese(removeMarkdownCodeBlock(promptsMarkdownContent)),\r\n            convertEnglishQuotesToChinese(dailySummaryMarkdownContent),\r\n            null, // No podcast script for this page\r\n        );\r\n        return new Response(successHtml, { headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in /genAIContent (outer try-catch):\", error);\r\n        const pageDateForError = dateStr || getISODate();\r\n        const itemsForActionOnError = Array.isArray(selectedItemsParams) ? selectedItemsParams : [];\r\n        const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u51FA\u9519', `<p><strong>Unexpected error:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, pageDateForError, true, itemsForActionOnError, fullPromptForCall2_System, fullPromptForCall2_User);\r\n        return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n    }\r\n}\r\n\r\nexport async function handleGenAIDailyAnalysis(request, env) {\r\n    let dateStr;\r\n    let userPromptDailyAnalysisData = '';\r\n    let fullPromptForDailyAnalysis_System = null;\r\n    let finalAiResponse = null;\r\n\r\n    try {\r\n        const requestBody = await request.json();\r\n        dateStr = requestBody.date || getISODate();\r\n        const summarizedContent = requestBody.summarizedContent; // Get summarized content from request body\r\n\r\n        if (!summarizedContent || !summarizedContent.trim()) {\r\n            return new Response('\u672A\u63D0\u4F9B\u6458\u8981\u5185\u5BB9\u8FDB\u884C\u5206\u6790\u3002', { status: 400, headers: { 'Content-Type': 'text/plain; charset=utf-8' } });\r\n        }\r\n\r\n        userPromptDailyAnalysisData = summarizedContent; // Use summarized content as user prompt\r\n\r\n        console.log(`Generating AI daily analysis for date: ${dateStr} using summarized content.`);\r\n        fullPromptForDailyAnalysis_System = getSystemPromptDailyAnalysis();\r\n\r\n        console.log(\"Call to Chat (Daily Analysis): User prompt length:\", userPromptDailyAnalysisData.length);\r\n        try {\r\n            let analysisChunks = [];\r\n            for await (const chunk of callChatAPIStream(env, userPromptDailyAnalysisData, fullPromptForDailyAnalysis_System)) {\r\n                analysisChunks.push(chunk);\r\n            }\r\n            finalAiResponse = analysisChunks.join('');\r\n            if (!finalAiResponse || finalAiResponse.trim() === \"\") throw new Error(\"Chat daily analysis call returned empty content.\");\r\n            finalAiResponse = removeMarkdownCodeBlock(finalAiResponse); // Clean the output\r\n            console.log(\"Daily Analysis successful. Final output length:\", finalAiResponse.length);\r\n        } catch (error) {\r\n            console.error(\"Error in Chat API Call (Daily Analysis):\", error);\r\n            return new Response(`AI \u65E5\u62A5\u5206\u6790\u5931\u8D25: ${escapeHtml(error.message)}`, { status: 500, headers: { 'Content-Type': 'text/plain; charset=utf-8' } });\r\n        }\r\n\r\n        return new Response(finalAiResponse, { headers: { 'Content-Type': 'text/plain; charset=utf-8' } });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in /genAIDailyAnalysis (outer try-catch):\", error);\r\n        return new Response(`\u670D\u52A1\u5668\u9519\u8BEF: ${escapeHtml(error.message)}`, { status: 500, headers: { 'Content-Type': 'text/plain; charset=utf-8' } });\r\n    }\r\n}\r\n", "import { getISODate, escapeHtml, formatDateToChinese, convertEnglishQuotesToChinese} from '../helpers.js';\r\nimport { generateGenAiPageHtml } from '../htmlGenerators.js';\r\nimport { insertFoot } from '../foot.js';\r\nimport { insertAd } from '../ad.js';\r\n\r\nexport async function handleGenAIDailyPage(request, env) {\r\n    let dateStr;\r\n    try {\r\n        const url = new URL(request.url);\r\n        const dateParam = url.searchParams.get('date');\r\n        dateStr = dateParam ? dateParam : getISODate();\r\n\r\n        let dailySummaryMarkdownContent = `## ${env.DAILY_TITLE} ${formatDateToChinese(dateStr)}` + '\\n\\n';\r\n        dailySummaryMarkdownContent += '> '+ env.DAILY_TITLE_MIN + '\\n\\n';\r\n        \r\n        dailySummaryMarkdownContent += '\\n\\n### **\u4ECA\u65E5\u6458\u8981**\\n\\n```\\n' + '\u8FD9\u91CC\u8F93\u5165\u5185\u5BB9\u6458\u8981' + '\\n```\\n\\n';\r\n        if (env.INSERT_AD=='true') dailySummaryMarkdownContent += insertAd() +`\\n`;\r\n        if (env.INSERT_FOOT=='true') dailySummaryMarkdownContent += insertFoot() +`\\n\\n`;\r\n\r\n        const successHtml = generateGenAiPageHtml(\r\n            env, \r\n            'AI\u65E5\u62A5', // Title for the page\r\n            escapeHtml(dailySummaryMarkdownContent), \r\n            dateStr, \r\n            false, // isError\r\n            [], // selectedItemsParams (not applicable here)\r\n            null, null, // Call 1 prompts (not applicable here)\r\n            null, null, // Call 2 prompts (not applicable here)\r\n            'webbuild', // promptsMarkdownContent (not applicable here)\r\n            convertEnglishQuotesToChinese(dailySummaryMarkdownContent), // dailySummaryMarkdownContent\r\n            null, // podcastScriptMarkdownContent (not applicable here)\r\n            true, // readGithub\r\n        );\r\n        return new Response(successHtml, { headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in /genAIDailyPage:\", error);\r\n        const pageDateForError = dateStr || getISODate(); \r\n        const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u9875\u9762\u51FA\u9519', `<p><strong>Unexpected error:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, pageDateForError, true, []);\r\n        return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n    }\r\n}\r\n", "// src/handlers/commitToGitHub.js\r\nimport { getISODate, formatMarkdownText } from '../helpers.js';\r\nimport { getGitHubFileSha, createOrUpdateGitHubFile } from '../github.js';\r\nimport { storeInKV } from '../kv.js';\r\nimport { marked } from '../marked.esm.js';\r\n\r\nexport async function handleCommitToGitHub(request, env) {\r\n    if (request.method !== 'POST') {\r\n        return new Response(JSON.stringify({ status: 'error', message: 'Method Not Allowed' }), { status: 405, headers: { 'Content-Type': 'application/json' } });\r\n    }\r\n    try {\r\n        const formData = await request.formData();\r\n        const dateStr = formData.get('date') || getISODate();\r\n        const dailyMd = formData.get('daily_summary_markdown');\r\n        const podcastMd = formData.get('podcast_script_markdown');\r\n\r\n\r\n        const filesToCommit = [];\r\n\r\n        if (dailyMd) {\r\n            filesToCommit.push({ path: `daily/${dateStr}.md`, content: formatMarkdownText(dailyMd), description: \"Daily Summary File\" });\r\n        }\r\n        if (podcastMd) {\r\n            filesToCommit.push({ path: `podcast/${dateStr}.md`, content: podcastMd, description: \"Podcast Script File\" });\r\n        }\r\n\r\n        if (filesToCommit.length === 0) {\r\n            throw new Error(\"No markdown content provided for GitHub commit.\");\r\n        }\r\n\r\n        const results = [];\r\n        for (const file of filesToCommit) {\r\n            try {\r\n                const existingSha = await getGitHubFileSha(env, file.path);\r\n                const commitMessage = `${existingSha ? 'Update' : 'Create'} ${file.description.toLowerCase()} for ${dateStr}`;\r\n                await createOrUpdateGitHubFile(env, file.path, file.content, commitMessage, existingSha);\r\n                results.push({ file: file.path, status: 'Success', message: `Successfully ${existingSha ? 'updated' : 'created'}.` });\r\n                console.log(`GitHub commit success for ${file.path}`);\r\n            } catch (err) {\r\n                console.error(`Failed to commit ${file.path} to GitHub:`, err);\r\n                results.push({ file: file.path, status: 'Failed', message: err.message });\r\n            }\r\n        }\r\n        \r\n        return new Response(JSON.stringify({ status: 'success', date: dateStr, results: results }), { headers: { 'Content-Type': 'application/json; charset=utf-8' } });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in /commitToGitHub:\", error);\r\n        return new Response(JSON.stringify({ status: 'error', message: error.message }), { status: 500, headers: { 'Content-Type': 'application/json; charset=utf-8' } });\r\n    }\r\n}\r\n", "import { stripHtml, getShanghaiTime, formatRssDate } from '../helpers.js';\r\nimport { getFromKV } from '../kv.js';\r\n\r\nfunction minifyHTML(htmlString) {\r\n  if (typeof htmlString !== 'string') {\r\n    return '';\r\n  }\r\n\r\n  return htmlString\r\n    .replace(/>\\s+</g, '><') // \u79FB\u9664\u6807\u7B7E\u4E4B\u95F4\u7684\u7A7A\u767D\r\n    .trim();                 // \u79FB\u9664\u5B57\u7B26\u4E32\u4E24\u7AEF\u7684\u7A7A\u767D\r\n}\r\n\r\n/**\r\n * \u8655\u7406 Supabase RSS \u8ACB\u6C42\r\n * @param {Request} request - \u50B3\u5165\u7684\u8ACB\u6C42\u7269\u4EF6\r\n * @param {object} env - Cloudflare Workers \u74B0\u5883\u8B8A\u6578\r\n * @returns {Response} RSS Feed \u7684\u56DE\u61C9\r\n */\r\nexport async function handleRss(request, env) {\r\n  const url = new URL(request.url);\r\n  const days = parseInt(url.searchParams.get('days')) || 7; // \u9810\u8A2D\u67E5\u8A62 7 \u5929\u5167\u7684\u8CC7\u6599\r\n\r\n  const allData = [];\r\n  const today = getShanghaiTime(); // \u52A0\u4E0A\u6771\u516B\u6642\u5340\u7684\u504F\u79FB\u91CF\r\n\r\n  for (let i = 0; i < days; i++) {\r\n    const date = new Date(today);\r\n    date.setDate(today.getDate() - i);\r\n    const dateStr = date.toISOString().split('T')[0]; // YYYY-MM-DD\r\n    const key = `${dateStr}-report`;\r\n    const data = await getFromKV(env.DATA_KV, key);\r\n    if (data) {\r\n      allData.push(data);\r\n    }\r\n  }\r\n\r\n  // \u6241\u5E73\u5316\u6578\u64DA\uFF0C\u56E0\u70BA\u6BCF\u500B report \u53EF\u80FD\u5305\u542B\u591A\u500B\u9805\u76EE\r\n  const data = allData.flat();\r\n\r\n  if (!data || data.length === 0) {\r\n    return new Response('\u6C92\u6709\u627E\u5230\u76F8\u95DC\u8CC7\u6599', { status: 200 });\r\n  }\r\n\r\n  // \u5EFA\u7ACB RSS Feed\r\n  let rssItems = '';\r\n  if (data && data.length > 0) {\r\n    const filteredData = {};\r\n    data.forEach(item => {\r\n      const reportDate = item.report_date;\r\n      const publishedDate = new Date(item.published_date);\r\n\r\n      if (!filteredData[reportDate] || publishedDate > new Date(filteredData[reportDate].published_date)) {\r\n        filteredData[reportDate] = item;\r\n      }\r\n    });\r\n    const finalData = Object.values(filteredData);\r\n\r\n    finalData.forEach(item => {\r\n      const pubDate = formatRssDate(new Date(item.published_date));\r\n      const content = minifyHTML(item.content_html);\r\n      const title = item.title || '\u65E0\u6807\u9898';\r\n      const link = env.BOOK_LINK+item.link || '#';\r\n      const description = stripHtml(item.content_html).substring(0, 200); // \u79FB\u9664 HTML \u6A19\u7C64\u4E26\u622A\u53D6 200 \u5B57\u5143\r\n\r\n      rssItems += `\r\n        <item>\r\n          <title><![CDATA[${title}]]></title>\r\n          <link>${link}</link>\r\n          <guid>${item.id || link}</guid>\r\n          <pubDate>${pubDate}</pubDate>\r\n          <content:encoded><![CDATA[${content}]]></content:encoded>\r\n          <description><![CDATA[${description}]]></description>\r\n        </item>\r\n      `;\r\n    });\r\n  }\r\n\r\n  const rssFeed = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<rss version=\"2.0\" xmlns:content=\"http://purl.org/rss/1.0/modules/content/\" xmlns:atom=\"http://www.w3.org/2005/Atom\">\r\n  <channel>\r\n    <title>AI\u6D1E\u5BDF\u65E5\u62A5 RSS Feed</title>\r\n    <link>${env.BOOK_LINK}</link>\r\n    <description> \u8FD1 ${days} \u5929\u7684AI\u65E5\u62A5</description>\r\n    <language>zh-cn</language>\r\n    <lastBuildDate>${formatRssDate()}</lastBuildDate>\r\n    <atom:link href=\"${url.origin}/rss\" rel=\"self\" type=\"application/rss+xml\" />\r\n    ${rssItems}\r\n  </channel>\r\n</rss>`;\r\n\r\n  return new Response(rssFeed, {\r\n    headers: {\r\n      'Content-Type': 'application/xml; charset=utf-8',\r\n      'Cache-Control': 'public, max-age=3600' // \u5FEB\u53D6\u4E00\u5C0F\u6642\r\n    }\r\n  });\r\n}\r\n", "// Add new data sources\r\nexport function getSummarizationSimplifyPrompt() {\r\n    return `\r\n\u7B80\u5316\u6BCF\u4E00\u6BB5\u7684\u6587\u5B57\u4E3A\u4E00\u53E5\u8BDD\u63CF\u8FF0\uFF0C\u6BCF\u53E5\u8BDD\u4E0D\u8D85\u8FC730\u4E2A\u5B57\uFF0C\u5C06\u6240\u6709\u7684\u53E5\u5B50\u8FC7\u6E21\u8BCD\u548C\u8FDE\u63A5\u8BCD\u66FF\u6362\u4E3A\u6700\u57FA\u7840\u3001\u6700\u5E38\u7528\u7684\u8BCD\u8BED\u3002\u5C3D\u91CF\u4F7F\u7528\u7B80\u5355\u3001\u76F4\u63A5\u7684\u8868\u8FBE\u65B9\u5F0F\uFF0C\u907F\u514D\u4F7F\u7528\u590D\u6742\u6216\u751F\u50FB\u7684\u8BCD\u6C47\u3002\u786E\u4FDD\u53E5\u5B50\u4E4B\u95F4\u7684\u903B\u8F91\u5173\u7CFB\u6E05\u6670\u3002\r\n\u53EF\u4EE5\u5408\u5E76\u540C\u7C7B\u7684\u8F93\u51FA\u4FE1\u606F\uFF0C\u4FDD\u6301\u539F\u6709\u7684\u5C0F\u6807\u9898\uFF0C\u4E3A\u751F\u6210\u540E\u7684\u6BCF\u4E00\u6BB5\u5185\u5BB9\u4ECE1\u5F00\u59CB\u6392\u5E8F.\r\n    `;\r\n}\r\n", "export function getAppUrl() {\r\n    return `\r\n\r\n---\r\n\r\n**\uD83D\uDCE2 \u5173\u4E8E AI\u65E5\u62A5 \u7684\u4E00\u6B21\u5C0F\u8C03\u6574**\r\n>\r\n\u5766\u767D\u8BF4\uFF0C\u60F3\u8981\u957F\u4E45\u5730\u628A**AI\u65E5\u62A5**\u505A\u4E0B\u53BB\uFF0C\u5355\u9760\u201C\u4E3A\u7231\u53D1\u7535\u201D\u786E\u5B9E\u9762\u4E34\u73B0\u5B9E\u538B\u529B\u3002\u4E3A\u4E86\u66F4\u6709\u70ED\u60C5\u7684**\u6295\u5165\u7CBE\u529B**\uFF0C\u6211\u5728\u7F51\u7AD9\u63A5\u5165\u4E86\u5C11\u91CF Google \u5E7F\u544A\u3002\r\n>\r\n\u7531\u4E8E RSS \u65E0\u6CD5\u5C55\u793A\u5E7F\u544A\u5E26\u6765\u6536\u5165\uFF0C\u5373\u65E5\u8D77 RSS \u5C06**\u8BD5\u8FD0\u884C\u201C\u6458\u8981\u6A21\u5F0F\u201D\u4E00\u6BB5\u65F6\u95F4**\u3002\r\n>\r\n**\uD83D\uDCA1 \u60A8\u7684\u6BCF\u4E00\u6B21\u70B9\u51FB\uFF0C\u90FD\u662F\u5BF9\u6211\u6700\u5927\u7684\u652F\u6301**\r\n\u8BDA\u631A\u9080\u8BF7\u60A8\u79FB\u6B65\u5B98\u7F51\u9605\u8BFB\u5168\u6587\u3002\u90A3\u91CC\u4E0D\u4EC5\u6709\u66F4\u8212\u9002\u7684**\u6392\u7248**\u548C\u6E05\u6670\u7684**\u4EE3\u7801\u9AD8\u4EAE**\uFF0C\u8FD8\u80FD\u5728\u8BC4\u8BBA\u533A\u4E0E\u5927\u5BB6\u4EA4\u6D41\u3002\r\n>\r\n\u611F\u8C22\u60A8\u7684\u7406\u89E3\u4E0E\u966A\u4F34\uFF0C\u8BA9\u6211\u4EEC\u4E00\u8D77\u8D70\u5F97\u66F4\u8FDC\uFF01\r\n>\r\n\uD83D\uDC47 **\u70B9\u51FB\u4E0B\u65B9\u94FE\u63A5\uFF0C\u9605\u8BFB\u4ECA\u65E5\u5B8C\u6574\u8D44\u8BAF**\r\n### [\uD83D\uDE80 \u524D\u5F80\u5B98\u7F51\u67E5\u770B\u5B8C\u6574\u7248 (ai.hubtoday.app)](https://ai.hubtoday.app/)\r\n>\r\n<small>\u5982\u6709\u5EFA\u8BAE\uFF0C\u6B22\u8FCE\u968F\u65F6\u90AE\u4EF6\u6C9F\u901A\uFF1A[justlikemaki@foxmail.com](mailto:justlikemaki@foxmail.com)</small>\r\n<br/>\r\n<small>\u6216\u76F4\u63A5\u626B\u7801\u8FDB\u7FA4\u63D0\u4F9B\u5EFA\u8BAE:</small>\r\n<br/>\r\n![\u8FDB\u7FA4-\u4F55\u59152077AI\u65E5\u62A5\u95EE\u9898\u53CD\u9988](https://source.hubtoday.app/logo/wechat-qun-ex2.jpg)\r\n\r\n    `;\r\n}", "import { replaceImageProxy, formatMarkdownText, formatDateToGMT8WithTime, removeMarkdownCodeBlock } from '../helpers.js';\r\nimport { getDailyReportContent, getGitHubFileSha, createOrUpdateGitHubFile } from '../github.js';\r\nimport { storeInKV } from '../kv.js';\r\nimport { marked } from '../marked.esm.js';\r\nimport { callChatAPI } from '../chatapi.js'; // \u5BFC\u5165 callChatAPI\r\nimport { getSummarizationSimplifyPrompt } from \"../prompt/summarizationSimplifyPrompt\";\r\nimport { getAppUrl } from '../appUrl.js';\r\n\r\n/**\r\n * \u5904\u7406\u751F\u6210RSS\u5185\u5BB9\u7684\u8BF7\u6C42\uFF08\u4ECEdaily\u76EE\u5F55\u8BFB\u53D6\uFF0C\u751F\u6210AI\u5185\u5BB9\uFF0C\u5199\u5165rss\u76EE\u5F55\uFF09\r\n * @param {Request} request - \u8BF7\u6C42\u5BF9\u8C61\r\n * @param {object} env - \u73AF\u5883\u5BF9\u8C61\r\n * @returns {Promise<Response>} \u5305\u542B\u751F\u6210\u5185\u5BB9\u7684\u54CD\u5E94\r\n */\r\nexport async function handleGenerateRssContent(request, env) {\r\n    const url = new URL(request.url);\r\n    const dateStr = url.searchParams.get('date');\r\n    console.log(`[generateRssContent] Received request for date: ${dateStr}`);\r\n\r\n    if (!dateStr) {\r\n        console.error('[generateRssContent] Missing date parameter');\r\n        return new Response('Missing date parameter', { status: 400 });\r\n    }\r\n\r\n    try {\r\n        // \u4ECEdaily\u76EE\u5F55\u8BFB\u53D6\u539F\u59CB\u5185\u5BB9\r\n        const dailyPath = `daily/${dateStr}.md`;\r\n        console.log(`[generateRssContent] Attempting to get content from GitHub path: ${dailyPath}`);\r\n        let content = await getDailyReportContent(env, dailyPath);\r\n\r\n        if (!content) {\r\n            console.warn(`[generateRssContent] No content found for ${dailyPath}. Returning 404.`);\r\n            return new Response(`No content found for ${dailyPath}`, { status: 404 });\r\n        }\r\n        console.log(`[generateRssContent] Successfully retrieved content for ${dailyPath}. Content length: ${content.length}`);\r\n\r\n        content = extractContentFromSecondHash(content);\r\n\r\n        // \u751F\u6210AI\u5185\u5BB9\uFF08\u5185\u90E8\u5DF2\u5305\u542B\u622A\u65AD\u903B\u8F91\uFF09\r\n        const aiContent = await generateAIContent(env, content);\r\n\r\n        // \u5199\u5165\u5230rss\u76EE\u5F55\r\n        const rssPath = `rss/${dateStr}.md`;\r\n        const existingSha = await getGitHubFileSha(env, rssPath);\r\n        const commitMessage = `${existingSha ? 'Update' : 'Create'} RSS content for ${dateStr}`;\r\n        await createOrUpdateGitHubFile(env, rssPath, aiContent, commitMessage, existingSha);\r\n        console.log(`[generateRssContent] Successfully wrote AI content to GitHub: ${rssPath}`);\r\n\r\n        // \u4ECE \"YYYY-MM-DD\" \u683C\u5F0F\u7684 dateStr \u4E2D\u63D0\u53D6 \"YYYY-MM\"\r\n        const yearMonth = dateStr.substring(0, 7);\r\n        const result = {\r\n            report_date: dateStr,\r\n            title: dateStr + '\u65E5\u520A',\r\n            link: '/' + yearMonth + '/' + dateStr + '/',\r\n            content_markdown: aiContent,\r\n            github_path: rssPath,\r\n            published_date: formatDateToGMT8WithTime(new Date())\r\n        };\r\n\r\n        console.log(`[generateRssContent] Successfully generated and saved content for ${dateStr}. Content length: ${aiContent.length}`);\r\n\r\n        return new Response(JSON.stringify(result), {\r\n            headers: { 'Content-Type': 'application/json' },\r\n            status: 200\r\n        });\r\n    } catch (error) {\r\n        console.error('[generateRssContent] Error generating content:', error.message, error.stack);\r\n        return new Response(`Error generating content: ${error.message}`, { status: 500 });\r\n    }\r\n}\r\n\r\n/**\r\n * \u5904\u7406\u5199\u5165RSS\u6570\u636E\u7684\u8BF7\u6C42\uFF08\u4ECErss\u76EE\u5F55\u8BFB\u53D6\u5DF2\u751F\u6210\u7684\u5185\u5BB9\uFF0C\u5199\u5165KV\uFF09\r\n * @param {Request} request - \u8BF7\u6C42\u5BF9\u8C61\r\n * @param {object} env - \u73AF\u5883\u5BF9\u8C61\r\n * @returns {Promise<Response>} \u5305\u542B\u5199\u5165\u7ED3\u679C\u7684\u54CD\u5E94\r\n */\r\nexport async function handleWriteRssData(request, env) {\r\n    const url = new URL(request.url);\r\n    const dateStr = url.searchParams.get('date');\r\n    console.log(`[writeRssData] Received request for date: ${dateStr}`);\r\n\r\n    if (!dateStr) {\r\n        console.error('[writeRssData] Missing date parameter');\r\n        return new Response('Missing date parameter', { status: 400 });\r\n    }\r\n\r\n    try {\r\n        // \u4ECErss\u76EE\u5F55\u8BFB\u53D6\u5DF2\u751F\u6210\u7684AI\u5185\u5BB9\r\n        const rssPath = `rss/${dateStr}.md`;\r\n        console.log(`[writeRssData] Attempting to get content from GitHub path: ${rssPath}`);\r\n        let content = await getDailyReportContent(env, rssPath);\r\n\r\n        if (!content) {\r\n            console.warn(`[writeRssData] No content found for ${rssPath}. Returning 404.`);\r\n            return new Response(`No content found for ${rssPath}. Please run /generateRssContent first.`, { status: 404 });\r\n        }\r\n        console.log(`[writeRssData] Successfully retrieved content for ${rssPath}. Content length: ${content.length}`);\r\n\r\n        // \u4ECE \"YYYY-MM-DD\" \u683C\u5F0F\u7684 dateStr \u4E2D\u63D0\u53D6 \"YYYY-MM\"\r\n        const yearMonth = dateStr.substring(0, 7);\r\n        const report = {\r\n            report_date: dateStr,\r\n            title: dateStr + '\u65E5\u520A',\r\n            link: '/' + yearMonth + '/' + dateStr + '/',\r\n            content_html: marked.parse(formatMarkdownText(content)),\r\n            // \u53EF\u4EE5\u6DFB\u52A0\u5176\u4ED6\u76F8\u95DC\u6B04\u4F4D\uFF0C\u4F8B\u5982\u4F5C\u8005\u3001\u4F86\u6E90\u7B49\r\n            published_date: formatDateToGMT8WithTime(new Date()) // \u8A18\u9304\u4FDD\u5B58\u6642\u9593\r\n        };\r\n\r\n        const kvKey = `${dateStr}-report`;\r\n        console.log(`[writeRssData] Preparing to store report in KV. Key: ${kvKey}, Report object:`, JSON.stringify(report).substring(0, 200) + '...'); // Log first 200 chars\r\n        await storeInKV(env.DATA_KV, kvKey, report);\r\n        console.log(`[writeRssData] Successfully stored report in KV with key: ${kvKey}`);\r\n\r\n        return new Response(JSON.stringify(report), {\r\n            headers: { 'Content-Type': 'application/json' },\r\n            status: 200\r\n        });\r\n    } catch (error) {\r\n        console.error('[writeRssData] Error handling daily report:', error.message, error.stack);\r\n        return new Response(`Error handling daily report: ${error.message}`, { status: 500 });\r\n    }\r\n}\r\n\r\n/**\r\n * \u4ECE\u7B2C\u4E8C\u4E2A ### \u5F00\u59CB\u622A\u53D6\u5185\u5BB9\uFF0C\u5305\u62EC ###\u3002\r\n *\r\n * @param {string} content - \u539F\u59CB\u6587\u672C\u5185\u5BB9\u3002\r\n * @returns {string} \u622A\u53D6\u540E\u7684\u5185\u5BB9\u3002\r\n */\r\nexport function extractContentFromSecondHash(content) {\r\n    const parts = content.split('###');\r\n    if (parts.length > 2) {\r\n        // \u539F\u59CB\u903B\u8F91\uFF1A\u91CD\u65B0\u7EC4\u5408\u4ECE\u7B2C\u4E8C\u4E2A ### \u5F00\u59CB\u7684\u6240\u6709\u90E8\u5206\r\n        let newcontent = '###' + parts.slice(2).join('###');\r\n        const lastHashIndex = newcontent.lastIndexOf('AI\u8D44\u8BAF\u65E5\u62A5\u8BED\u97F3\u7248');\r\n        if (lastHashIndex !== -1) {\r\n            newcontent = newcontent.substring(0, lastHashIndex-10);\r\n        }\r\n        return newcontent;\r\n    }\r\n    return content; // \u5982\u679C\u6CA1\u6709\u627E\u5230 ### \u6216\u4E0D\u7B26\u5408\u4E0A\u8FF0\u6761\u4EF6\uFF0C\u5219\u8FD4\u56DE\u539F\u59CB\u5185\u5BB9\r\n}\r\n\r\n/**\r\n * \u622A\u65AD\u5185\u5BB9\u5230\u6307\u5B9A\u5B57\u6570\uFF0C\u5E76\u6DFB\u52A0\u7701\u7565\u6837\u5F0F\r\n * @param {string} content - \u539F\u59CB\u5185\u5BB9\r\n * @param {number} maxLength - \u6700\u5927\u5B57\u6570\uFF0C\u9ED8\u8BA4150\r\n * @returns {string} \u622A\u65AD\u540E\u7684\u5185\u5BB9\r\n */\r\nexport function truncateContent(content, maxLength = 150) {\r\n    if (!content || content.length <= maxLength) {\r\n        return content;\r\n    }\r\n\r\n    // \u622A\u65AD\u5230\u6307\u5B9A\u957F\u5EA6\r\n    let truncated = content.substring(0, maxLength);\r\n\r\n    // \u5C1D\u8BD5\u5728\u6700\u540E\u4E00\u4E2A\u6362\u884C\u7B26\u5904\u622A\u65AD\r\n    const lastNewlineEnd = truncated.lastIndexOf('\\n');\r\n\r\n    // \u5982\u679C\u627E\u5230\u6362\u884C\u7B26\u4E14\u4F4D\u7F6E\u5408\u7406\uFF08\u81F3\u5C11\u4FDD\u7559\u4E00\u534A\u5185\u5BB9\uFF09\uFF0C\u5219\u5728\u6362\u884C\u7B26\u5904\u622A\u65AD\r\n    if (lastNewlineEnd > maxLength / 2) {\r\n        truncated = content.substring(0, lastNewlineEnd);\r\n    }\r\n\r\n    // \u6DFB\u52A0\u7701\u7565\u6837\u5F0F\r\n    truncated += '\\n\\n......\\n\\n*[\u5269\u4F59\u5185\u5BB9\u5DF2\u7701\u7565]*';\r\n\r\n    return truncated;\r\n}\r\n\r\n/**\r\n * \u8C03\u7528 Gemini \u6216 OpenAI \u6A21\u578B\u751F\u6210\u6307\u5B9A\u63D0\u793A\u8BCD\u7684\u5185\u5BB9\u3002\r\n * \u6B64\u65B9\u6CD5\u53EF\u4F9B\u5916\u90E8\u8C03\u7528\u3002\r\n *\r\n * @param {object} env - \u73AF\u5883\u5BF9\u8C61\uFF0C\u5305\u542B AI \u6A21\u578B\u76F8\u5173\u7684\u914D\u7F6E\u3002\r\n * @param {string} promptText - \u7528\u6237\u63D0\u793A\u8BCD\u3002\r\n * @returns {Promise<string>} AI \u6A21\u578B\u751F\u6210\u7684\u5185\u5BB9\u3002\r\n * @throws {Error} \u5982\u679C API \u8C03\u7528\u5931\u8D25\u6216\u8FD4\u56DE\u7A7A\u5185\u5BB9\u3002\r\n */\r\nexport async function generateAIContent(env, promptText) {\r\n    console.log(`[generateAIContent] Calling AI model with prompt: ${promptText.substring(0, 100)}...`);\r\n    try {\r\n        let result = await callChatAPI(env, promptText, getSummarizationSimplifyPrompt());\r\n        console.log(`[generateAIContent] AI model returned content. Length: ${result.length}`);\r\n        result = removeMarkdownCodeBlock(result);\r\n        // \u622A\u65AD\u5185\u5BB9\u5230360\u5B57\u5E76\u6DFB\u52A0\u7701\u7565\u6837\u5F0F\r\n        result = truncateContent(result, 360);\r\n        result += \"\\n\\n</br>\" + getAppUrl();\r\n        return result;\r\n    } catch (error) {\r\n        console.error('[generateAIContent] Error calling AI model:', error.message, error.stack);\r\n        throw new Error(`Failed to generate AI content: ${error.message}`);\r\n    }\r\n}\r\n", "// src/auth.js\r\nimport { storeInKV, getFromKV} from './kv.js';\r\n\r\nconst SESSION_COOKIE_NAME = 'session_id_89757';\r\nconst SESSION_EXPIRATION_SECONDS = 60 * 60; // 1 hour\r\n\r\n// Function to generate the login page HTML\r\nfunction generateLoginPage(redirectUrl) {\r\n    return `\r\n        <!DOCTYPE html>\r\n        <html lang=\"en\">\r\n        <head>\r\n            <meta charset=\"UTF-8\">\r\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n            <title>Login</title>\r\n            <style>\r\n                body { font-family: sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; background-color: #f4f4f4; margin: 0; }\r\n                .login-container { background-color: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); width: 100%; max-width: 400px; text-align: center; }\r\n                h2 { color: #333; margin-bottom: 20px; }\r\n                .form-group { margin-bottom: 15px; text-align: left; }\r\n                label { display: block; margin-bottom: 5px; color: #555; }\r\n                input[type=\"text\"], input[type=\"password\"] { width: calc(100% - 20px); padding: 10px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }\r\n                button { background-color: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; width: 100%; }\r\n                button:hover { background-color: #0056b3; }\r\n                .error-message { color: red; margin-top: 10px; }\r\n            </style>\r\n        </head>\r\n        <body>\r\n            <div class=\"login-container\">\r\n                <h2>Login</h2>\r\n                <form id=\"loginForm\" method=\"POST\" action=\"/login\">\r\n                    <div class=\"form-group\">\r\n                        <label for=\"username\">Username:</label>\r\n                        <input type=\"text\" id=\"username\" name=\"username\" required>\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                        <label for=\"password\">Password:</label>\r\n                        <input type=\"password\" id=\"password\" name=\"password\" required>\r\n                    </div>\r\n                    <input type=\"hidden\" name=\"redirect\" value=\"${redirectUrl}\">\r\n                    <button type=\"submit\">Login</button>\r\n                    <p id=\"errorMessage\" class=\"error-message\"></p>\r\n                </form>\r\n                <script>\r\n                    const form = document.getElementById('loginForm');\r\n                    const errorMessage = document.getElementById('errorMessage');\r\n                    form.addEventListener('submit', async (event) => {\r\n                        event.preventDefault();\r\n                        const formData = new FormData(form);\r\n                        const response = await fetch('/login', {\r\n                            method: 'POST',\r\n                            body: new URLSearchParams(formData).toString(),\r\n                            headers: {\r\n                                'Content-Type': 'application/x-www-form-urlencoded'\r\n                            }\r\n                        });\r\n                        if (response.ok) {\r\n                            const redirectUrl = response.headers.get('X-Redirect-Url');\r\n                            if (redirectUrl && redirectUrl !== '/') {\r\n                                window.location.href = redirectUrl;\r\n                            } else {\r\n                                window.location.href = '/getContentHtml'; // Fallback to home\r\n                            }\r\n                        } else {\r\n                            const errorText = await response.text();\r\n                            errorMessage.textContent = errorText || 'Login failed. Please try again.';\r\n                        }\r\n                    });\r\n                </script>\r\n            </div>\r\n        </body>\r\n        </html>\r\n    `;\r\n}\r\n\r\n// Function to set or renew the session cookie\r\nfunction setSessionCookie(sessionId) {\r\n    const expirationDate = new Date(Date.now() + SESSION_EXPIRATION_SECONDS * 1000);\r\n    return `${SESSION_COOKIE_NAME}=${sessionId}; Path=/; Expires=${expirationDate.toUTCString()}; HttpOnly; Secure; SameSite=Lax`;\r\n}\r\n\r\n// Function to handle login requests\r\nasync function handleLogin(request, env) {\r\n    if (request.method === 'GET') {\r\n        const url = new URL(request.url);\r\n        const redirectUrl = url.searchParams.get('redirect') || '/getContentHtml';\r\n        return new Response(generateLoginPage(redirectUrl), {\r\n            headers: { 'Content-Type': 'text/html; charset=utf-8' },\r\n        });\r\n    } else if (request.method === 'POST') {\r\n        const formData = await request.formData();\r\n        const username = formData.get('username');\r\n        const password = formData.get('password');\r\n        const redirect = formData.get('redirect') || '/';\r\n\r\n        if (username === env.LOGIN_USERNAME && password === env.LOGIN_PASSWORD) {\r\n            const sessionId = crypto.randomUUID(); // Generate a simple session ID\r\n            \r\n            // Store sessionId in KV store for persistent sessions\r\n            await storeInKV(env.DATA_KV, `session:${sessionId}`, 'valid', SESSION_EXPIRATION_SECONDS);\r\n\r\n            const cookie = setSessionCookie(sessionId);\r\n\r\n            return new Response('Login successful', {\r\n                status: 200,\r\n                headers: {\r\n                    'Set-Cookie': cookie,\r\n                    'X-Redirect-Url': redirect, // Custom header for client-side redirect\r\n                },\r\n            });\r\n        } else {\r\n            return new Response('Invalid username or password', { status: 401 });\r\n        }\r\n    }\r\n    return new Response('Method Not Allowed', { status: 405 });\r\n}\r\n\r\n// Function to check and renew session cookie\r\nasync function isAuthenticated(request, env) {\r\n    const cookieHeader = request.headers.get('Cookie');\r\n    if (!cookieHeader) {\r\n        return { authenticated: false, cookie: null };\r\n    }\r\n\r\n    const cookies = cookieHeader.split(';').map(c => c.trim());\r\n    const sessionCookie = cookies.find(cookie => cookie.startsWith(`${SESSION_COOKIE_NAME}=`));\r\n\r\n    if (!sessionCookie) {\r\n        return { authenticated: false, cookie: null };\r\n    }\r\n\r\n    const sessionId = sessionCookie.split('=')[1];\r\n\r\n    // Validate sessionId against KV store\r\n    const storedSession = await getFromKV(env.DATA_KV, `session:${sessionId}`);\r\n    if (storedSession !== 'valid') {\r\n        return { authenticated: false, cookie: null };\r\n    }\r\n\r\n    // Store sessionId in KV store for persistent sessions\r\n    await storeInKV(env.DATA_KV, `session:${sessionId}`, 'valid', SESSION_EXPIRATION_SECONDS);\r\n    // Renew the session cookie\r\n    const newCookie = setSessionCookie(sessionId);\r\n    return { authenticated: true, cookie: newCookie };\r\n}\r\n\r\n// Function to handle logout requests\r\nasync function handleLogout(request, env) {\r\n    const cookieHeader = request.headers.get('Cookie');\r\n    if (cookieHeader) {\r\n        const cookies = cookieHeader.split(';').map(c => c.trim());\r\n        const sessionCookie = cookies.find(cookie => cookie.startsWith(`${SESSION_COOKIE_NAME}=`));\r\n        if (sessionCookie) {\r\n            const sessionId = sessionCookie.split('=')[1];\r\n            // Delete session from KV store\r\n            await env.DATA_KV.delete(`session:${sessionId}`);\r\n        }\r\n    }\r\n\r\n    const expiredDate = new Date(0); // Set expiration to a past date\r\n    const cookie = `${SESSION_COOKIE_NAME}=; Path=/; Expires=${expiredDate.toUTCString()}; HttpOnly; Secure; SameSite=Lax`;\r\n\r\n    const url = new URL(request.url);\r\n    const redirectUrl = url.searchParams.get('redirect') || '/login'; // Redirect to login page by default\r\n\r\n    return new Response('Logged out', {\r\n        status: 302,\r\n        headers: {\r\n            'Set-Cookie': cookie,\r\n            'Location': redirectUrl,\r\n        },\r\n    });\r\n}\r\n\r\nexport {\r\n    handleLogin,\r\n    isAuthenticated,\r\n    handleLogout,\r\n    SESSION_COOKIE_NAME,\r\n    SESSION_EXPIRATION_SECONDS,\r\n};\r\n", "// src/index.js\r\nimport { handleWriteData } from './handlers/writeData.js';\r\nimport { handleGetContent } from './handlers/getContent.js';\r\nimport { handleGetContentHtml } from './handlers/getContentHtml.js';\r\nimport { handleGenAIContent, handleGenAIPodcastScript, handleGenAIDailyAnalysis } from './handlers/genAIContent.js';\r\nimport { handleGenAIDailyPage } from './handlers/genAIDailyPage.js'; // Import handleGenAIDailyPage\r\nimport { handleCommitToGitHub } from './handlers/commitToGitHub.js';\r\nimport { handleRss } from './handlers/getRss.js';\r\nimport { handleWriteRssData, handleGenerateRssContent } from './handlers/writeRssData.js';\r\nimport { dataSources } from './dataFetchers.js';\r\nimport { handleLogin, isAuthenticated, handleLogout } from './auth.js';\r\n\r\nexport default {\r\n    async fetch(request, env) {\r\n        // Check essential environment variables\r\n        const requiredEnvVars = [\r\n            'DATA_KV', 'GEMINI_API_KEY', 'GEMINI_API_URL', 'DEFAULT_GEMINI_MODEL', 'OPEN_TRANSLATE', 'USE_MODEL_PLATFORM',\r\n            'GITHUB_TOKEN', 'GITHUB_REPO_OWNER', 'GITHUB_REPO_NAME','GITHUB_BRANCH',\r\n            'LOGIN_USERNAME', 'LOGIN_PASSWORD',\r\n            'PODCAST_TITLE','PODCAST_BEGIN','PODCAST_END',\r\n            'FOLO_COOKIE_KV_KEY','FOLO_DATA_API','FOLO_FILTER_DAYS',\r\n        ];\r\n        console.log(env);\r\n        const missingVars = requiredEnvVars.filter(varName => !env[varName]);\r\n\r\n        if (missingVars.length > 0) {\r\n            console.error(`CRITICAL: Missing environment variables/bindings: ${missingVars.join(', ')}`);\r\n            const errorPage = `\r\n                <!DOCTYPE html><html lang=\"en\"><head><meta charset=\"UTF-8\"><title>Configuration Error</title></head>\r\n                <body style=\"font-family: sans-serif; padding: 20px;\"><h1>Server Configuration Error</h1>\r\n                <p>Essential environment variables or bindings are missing: ${missingVars.join(', ')}. The service cannot operate.</p>\r\n                <p>Please contact the administrator.</p></body></html>`;\r\n            return new Response(errorPage, { status: 503, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n\r\n        const url = new URL(request.url);\r\n        const path = url.pathname;\r\n        console.log(`Request received: ${request.method} ${path}`);\r\n\r\n        // Handle login path specifically\r\n        if (path === '/login') {\r\n            return await handleLogin(request, env);\r\n        } else if (path === '/logout') { // Handle logout path\r\n            return await handleLogout(request, env);\r\n        } else if (path === '/getContent' && request.method === 'GET') {\r\n            return await handleGetContent(request, env);\r\n        } else if (path.startsWith('/rss') && request.method === 'GET') {\r\n            return await handleRss(request, env);\r\n        } else if (path === '/writeRssData' && request.method === 'GET') {\r\n            return await handleWriteRssData(request, env);\r\n        } else if (path === '/generateRssContent' && request.method === 'GET') {\r\n            return await handleGenerateRssContent(request, env);\r\n        }\r\n\r\n        // Authentication check for all other paths\r\n        const { authenticated, cookie: newCookie } = await isAuthenticated(request, env);\r\n        if (!authenticated) {\r\n            // Redirect to login page, passing the original URL as a redirect parameter\r\n            const loginUrl = new URL('/login', url.origin);\r\n            loginUrl.searchParams.set('redirect', url.pathname + url.search);\r\n            return Response.redirect(loginUrl.toString(), 302);\r\n        }\r\n\r\n        // Original routing logic for authenticated requests\r\n        let response;\r\n        try {\r\n            if (path === '/writeData' && request.method === 'POST') {\r\n                response = await handleWriteData(request, env);\r\n            } else if (path === '/getContentHtml' && request.method === 'GET') {\r\n                // Prepare dataCategories for the HTML generation\r\n                const dataCategories = Object.keys(dataSources).map(key => ({\r\n                    id: key,\r\n                    name: dataSources[key].name\r\n                }));\r\n                response = await handleGetContentHtml(request, env, dataCategories);\r\n            } else if (path === '/genAIContent' && request.method === 'POST') {\r\n                response = await handleGenAIContent(request, env);\r\n            } else if (path === '/genAIPodcastScript' && request.method === 'POST') { // New route for podcast script\r\n                response = await handleGenAIPodcastScript(request, env);\r\n            } else if (path === '/genAIDailyAnalysis' && request.method === 'POST') { // New route for AI Daily Analysis\r\n                response = await handleGenAIDailyAnalysis(request, env);\r\n            } else if (path === '/genAIDailyPage' && request.method === 'GET') { // New route for AI Daily Page\r\n                response = await handleGenAIDailyPage(request, env);\r\n            } else if (path === '/commitToGitHub' && request.method === 'POST') {\r\n                response = await handleCommitToGitHub(request, env);\r\n            } else {\r\n                return new Response(null, { status: 404, headers: {'Content-Type': 'text/plain; charset=utf-8'} });\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Unhandled error in fetch handler:\", e);\r\n            return new Response(`Internal Server Error: ${e.message}`, { status: 500 });\r\n        }\r\n\r\n        // Renew cookie for authenticated requests\r\n        if (newCookie) {\r\n            response.headers.append('Set-Cookie', newCookie);\r\n        }\r\n        return response;\r\n    }\r\n};\r\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"E:\\\\IdeaProjects\\\\CloudFlare-AI-Insight-Daily\\\\src\\\\index.js\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"C:\\\\Users\\\\\u54C7\u54C8\u54C8\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"C:\\\\Users\\\\\u54C7\u54C8\u54C8\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"E:\\\\IdeaProjects\\\\CloudFlare-AI-Insight-Daily\\\\src\\\\index.js\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"E:\\\\IdeaProjects\\\\CloudFlare-AI-Insight-Daily\\\\.wrangler\\\\tmp\\\\bundle-kIio6R\\\\middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"C:\\\\Users\\\\\u54C7\u54C8\u54C8\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\common.ts\";\nimport type { WorkerEntrypointConstructor } from \"E:\\\\IdeaProjects\\\\CloudFlare-AI-Insight-Daily\\\\.wrangler\\\\tmp\\\\bundle-kIio6R\\\\middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"E:\\\\IdeaProjects\\\\CloudFlare-AI-Insight-Daily\\\\.wrangler\\\\tmp\\\\bundle-kIio6R\\\\middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": ";;;;AAMO,IAAI,YAAY,WAAW;AAE3B,SAAS,aAAa,MAAM;AAC/B,cAAY;AAChB;AAFgB;AAIT,SAAS,eAAe;AAC3B,SAAO;AACX;AAFgB;AAST,SAAS,WAAW,UAAU,oBAAI,KAAK,GAAG;AAC7C,QAAMA,WAAU;AAAA,IACZ,MAAM;AAAA,IACN,OAAO;AAAA,IACP,KAAK;AAAA,IACL,UAAU;AAAA,EACd;AAEA,QAAM,aAAa,QAAQ,mBAAmB,SAASA,QAAO;AAC9D,SAAO;AACX;AAVgB;AAiBT,SAAS,WAAW,QAAQ;AAC/B,MAAI,WAAW,QAAQ,OAAO,WAAW,aAAa;AAClD,WAAO;AAAA,EACX;AACA,QAAM,MAAM,OAAO,MAAM;AACzB,QAAM,MAAM;AAAA,IACR,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,EACT;AACA,SAAO,IAAI,QAAQ,YAAY,CAAC,MAAM,IAAI,CAAC,CAAC;AAChD;AAbgB;AAsBhB,eAAsB,UAAU,KAAKA,WAAU,CAAC,GAAG;AAC/C,QAAM,WAAW,MAAM,MAAM,KAAKA,QAAO;AACzC,MAAI,CAAC,SAAS,IAAI;AACd,UAAM,YAAY,MAAM,SAAS,KAAK;AACtC,UAAM,IAAI,MAAM,uBAAuB,SAAS,MAAM,cAAc,SAAS,UAAU,GAAG,EAAE;AAAA,EAChG;AACA,SAAO,SAAS,KAAK;AACzB;AAPsB;AAcf,SAAS,wBAAwB,MAAM;AAC1C,MAAI,CAAC,KAAM,QAAO;AAClB,MAAI,cAAc,KAAK,KAAK;AAE5B,QAAM,YAAY;AAClB,QAAM,eAAe;AAErB,MAAI,YAAY,WAAW,SAAS,GAAG;AACnC,kBAAc,YAAY,UAAU,UAAU,MAAM;AAAA,EACxD,WAAW,YAAY,WAAW,YAAY,GAAG;AAC7C,kBAAc,YAAY,UAAU,aAAa,MAAM;AAAA,EAC3D;AAEA,MAAI,YAAY,SAAS,YAAY,GAAG;AACpC,kBAAc,YAAY,UAAU,GAAG,YAAY,SAAS,aAAa,MAAM;AAAA,EACnF;AACA,SAAO,YAAY,KAAK;AAC5B;AAjBgB;AAwBT,SAAS,UAAUC,OAAM;AAC5B,MAAI,CAACA,MAAM,QAAO;AAGlB,MAAI,gBAAgBA,MAAK,QAAQ,oDAAoD,CAAC,OAAO,KAAK,QAAQ;AACtG,WAAO,MAAM,kBAAQ,GAAG,IAAI,GAAG,MAAM,kBAAQ,GAAG;AAAA,EACpD,CAAC;AACD,kBAAgB,cAAc,QAAQ,kCAAkC,oBAAU;AAGlF,kBAAgB,cAAc,QAAQ,gDAAgD,oBAAU;AAGhG,SAAO,cAAc,QAAQ,YAAY,GAAG,EAAE,QAAQ,QAAQ,GAAG,EAAE,KAAK;AAC5E;AAdgB;AA4BT,SAAS,sBAAsB,YAAY;AAE9C,QAAM,OAAO,IAAI,KAAK,UAAU;AAGhC,QAAMD,WAAU;AAAA,IACZ,MAAM;AAAA,IACN,OAAO;AAAA,IACP,KAAK;AAAA,IACL,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,QAAQ;AAAA,IACR,QAAQ;AAAA,IACR,UAAU;AAAA,EACd;AAIA,QAAM,qBAAqB,IAAI,KAAK,eAAe,SAASA,QAAO,EAAE,OAAO,IAAI;AAChF,SAAO,IAAI,KAAK,kBAAkB;AACtC;AApBgB;AAsBT,SAAS,kBAAkB;AAE9B,QAAM,OAAO,oBAAI,KAAK;AAGtB,QAAMA,WAAU;AAAA,IACZ,MAAM;AAAA,IACN,OAAO;AAAA,IACP,KAAK;AAAA,IACL,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,QAAQ;AAAA,IACR,QAAQ;AAAA,IACR,UAAU;AAAA,EACd;AAIA,QAAM,qBAAqB,IAAI,KAAK,eAAe,SAASA,QAAO,EAAE,OAAO,IAAI;AAChF,SAAO,IAAI,KAAK,kBAAkB;AACtC;AApBgB;AA4BT,SAAS,qBAAqB,YAAY,MAAM;AAEnD,QAAM,WAAW,sBAAsB,UAAU;AACjD,QAAM,QAAQ,IAAI,KAAK,SAAS;AAGhC,QAAM,SAAS,GAAG,GAAG,GAAG,CAAC;AAEzB,QAAM,WAAW,MAAM,QAAQ,IAAI,SAAS,QAAQ;AACpD,QAAM,WAAW,KAAK,KAAK,YAAY,MAAO,KAAK,KAAK,GAAG;AAE3D,SAAO,YAAY,KAAK,WAAW;AACvC;AAZgB;AAmBT,SAAS,oBAAoB,eAAe;AAC/C,MAAI,CAAC,cAAe,QAAO;AAC3B,QAAM,OAAO,IAAI,KAAK,aAAa;AACnC,QAAMA,WAAU;AAAA,IACZ,MAAM;AAAA,IACN,OAAO;AAAA,IACP,KAAK;AAAA,IACL,UAAU;AAAA,EACd;AACA,SAAO,IAAI,KAAK,eAAe,SAASA,QAAO,EAAE,OAAO,IAAI;AAChE;AAVgB;AAiBT,SAAS,4BAA4B,eAAe;AACvD,MAAI,CAAC,cAAe,QAAO;AAC3B,QAAM,OAAO,IAAI,KAAK,aAAa;AACnC,QAAMA,WAAU;AAAA,IACZ,MAAM;AAAA,IACN,OAAO;AAAA,IACP,KAAK;AAAA,IACL,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,QAAQ;AAAA,IACR,QAAQ;AAAA;AAAA,IACR,UAAU;AAAA;AAAA,EACd;AAEA,SAAO,IAAI,KAAK,eAAe,SAASA,QAAO,EAAE,OAAO,IAAI;AAChE;AAfgB;AAuBT,SAAS,cAAc,MAAM;AAChC,MAAI,CAAC,KAAM,SAAO,oBAAI,KAAK,GAAE,YAAY;AAEzC,SAAO,KAAK,YAAY;AAC1B;AAJc;AAwBP,SAAS,yBAAyB,eAAe;AACtD,MAAI,CAAC,cAAe,QAAO;AAC3B,QAAM,OAAO,IAAI,KAAK,aAAa;AACnC,QAAME,WAAU;AAAA,IACZ,MAAM;AAAA,IACN,OAAO;AAAA,IACP,KAAK;AAAA,IACL,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,QAAQ;AAAA,IACR,QAAQ;AAAA;AAAA,IACR,UAAU;AAAA;AAAA,EACd;AAEA,SAAO,IAAI,KAAK,eAAe,SAASA,QAAO,EAAE,OAAO,IAAI;AAChE;AAfkB;AAsBX,SAAS,8BAA8B,MAAM;AAChD,QAAM,MAAM,OAAO,IAAI;AACvB,SAAO,IAAI,QAAQ,MAAM,QAAG;AAChC;AAHgB;AAKT,SAAS,mBAAmB,MAAM;AACrC,QAAM,MAAM,OAAO,IAAI;AACvB,SAAO,IAAI,QAAQ,MAAM,GAAG;AAChC;AAHgB;AAST,SAAS,qBAAqB;AACjC,QAAM,aAAa;AAAA,IACf;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACJ;AACA,SAAO,WAAW,KAAK,MAAM,KAAK,OAAO,IAAI,WAAW,MAAM,CAAC;AACnE;AAbgB;AAoBT,SAAS,MAAM,IAAI;AACtB,SAAO,IAAI,QAAQ,aAAW,WAAW,SAAS,EAAE,CAAC;AACzD;AAFgB;AAIT,SAAS,kBAAkB,OAAO,SAAS;AAC9C,QAAM,MAAM,OAAO,OAAO;AAC1B,SAAO,IAAI,QAAQ,sBAAsB,gBAAgB,EAAE,QAAQ,6BAA6B,QAAM,wBAA0B;AACpI;AAHgB;;;AC7ThB,IAAM,2BAA2B;AAAA,EAC7B,MAAM;AAAA,EACN,MAAM,MAAM,KAAK,YAAY;AACzB,UAAM,SAAS,IAAI;AACnB,UAAM,aAAa,SAAS,IAAI,+BAA+B,KAAK,EAAE;AACtE,UAAM,eAAe,CAAC;AACtB,UAAM,aAAa,SAAS,IAAI,oBAAoB,KAAK,EAAE;AAE3D,QAAI,CAAC,QAAQ;AACT,cAAQ,KAAK,8FAA8F;AAC3G,aAAO;AAAA,QACH,SAAS;AAAA,QACT,OAAO;AAAA,QACP,eAAe;AAAA,QACf,aAAa;AAAA,QACb,UAAU;AAAA,QACV,OAAO,CAAC;AAAA,MACZ;AAAA,IACJ;AAEA,QAAI,iBAAiB;AACrB,aAAS,IAAI,GAAG,IAAI,YAAY,KAAK;AACjC,YAAM,YAAY,mBAAmB;AACrC,YAAM,UAAU;AAAA,QACZ,cAAc;AAAA,QACd,gBAAgB;AAAA,QAChB,UAAU;AAAA,QACV,mBAAmB;AAAA,QACnB,WAAW;AAAA,QACX,UAAU;AAAA,QACV,YAAY;AAAA,QACZ,aAAa;AAAA,QACb,oBAAoB;AAAA,QACpB,sBAAsB;AAAA,QACtB,kBAAkB;AAAA,QAClB,kBAAkB;AAAA,QAClB,kBAAkB;AAAA,QAClB,cAAc;AAAA,QACd,iBAAiB;AAAA,MACrB;AAEA,UAAI,YAAY;AACZ,gBAAQ,QAAQ,IAAI;AAAA,MACxB;AAEA,YAAM,OAAO;AAAA,QACT;AAAA,QACA,MAAM;AAAA,QACN,aAAa;AAAA,MACjB;AAEA,UAAI,gBAAgB;AAChB,aAAK,iBAAiB;AAAA,MAC1B;AAEA,UAAI;AACA,gBAAQ,IAAI,uCAAuC,IAAI,CAAC,KAAK;AAC7D,cAAM,WAAW,MAAM,MAAM,IAAI,eAAe;AAAA,UAC5C,QAAQ;AAAA,UACR;AAAA,UACA,MAAM,KAAK,UAAU,IAAI;AAAA,QAC7B,CAAC;AAED,YAAI,CAAC,SAAS,IAAI;AACd,kBAAQ,MAAM,8CAA8C,IAAI,CAAC,KAAK,SAAS,UAAU,EAAE;AAC3F;AAAA,QACJ;AACA,cAAM,OAAO,MAAM,SAAS,KAAK;AACjC,YAAI,QAAQ,KAAK,QAAQ,KAAK,KAAK,SAAS,GAAG;AAC3C,gBAAM,gBAAgB,KAAK,KAAK,OAAO,WAAS,qBAAqB,MAAM,QAAQ,aAAa,UAAU,CAAC;AAC3G,uBAAa,KAAK,GAAG,cAAc,IAAI,YAAU;AAAA,YAC7C,IAAI,MAAM,QAAQ;AAAA,YAClB,KAAK,MAAM,QAAQ;AAAA,YACnB,OAAO,MAAM,QAAQ;AAAA,YACrB,cAAc,MAAM,QAAQ;AAAA,YAC5B,gBAAgB,MAAM,QAAQ;AAAA,YAC9B,SAAS,CAAC,EAAE,MAAM,MAAM,QAAQ,OAAO,CAAC;AAAA,YACxC,QAAQ,MAAM,QAAQ,SAAS,GAAG,MAAM,MAAM,KAAK,MAAM,MAAM,QAAQ,MAAM,KAAK,MAAM,MAAM;AAAA,UAClG,EAAE,CAAC;AACH,2BAAiB,KAAK,KAAK,KAAK,KAAK,SAAS,CAAC,EAAE,QAAQ;AAAA,QAC7D,OAAO;AACH,kBAAQ,IAAI,0CAA0C,IAAI,CAAC,GAAG;AAC9D;AAAA,QACJ;AAAA,MACJ,SAAS,OAAO;AACZ,gBAAQ,MAAM,6CAA6C,IAAI,CAAC,KAAK,KAAK;AAC1E;AAAA,MACJ;AAEA,YAAM,MAAM,KAAK,OAAO,IAAI,GAAI;AAAA,IACpC;AAEA,WAAO;AAAA,MACH,SAAS;AAAA,MACT,OAAO;AAAA,MACP,eAAe;AAAA,MACf,aAAa;AAAA,MACb,UAAU;AAAA,MACV,OAAO;AAAA,IACX;AAAA,EACJ;AAAA,EAEA,UAAU,SAAS,YAAY;AAC3B,QAAI,CAAC,WAAW,CAAC,QAAQ,OAAO;AAC5B,aAAO,CAAC;AAAA,IACZ;AAEA,WAAO,QAAQ,MAAM,IAAI,WAAS;AAAA,MAC9B,IAAI,KAAK;AAAA,MACT,MAAM;AAAA,MACN,KAAK,KAAK;AAAA,MACV,OAAO,KAAK;AAAA,MACZ,aAAa,UAAU,KAAK,gBAAgB,EAAE;AAAA,MAC9C,gBAAgB,KAAK;AAAA,MACrB,SAAS,KAAK,UAAU,KAAK,QAAQ,IAAI,YAAU,OAAO,IAAI,EAAE,KAAK,IAAI,IAAI;AAAA,MAC7E,QAAQ,KAAK,UAAU;AAAA,MACvB,SAAS;AAAA,QACL,cAAc,KAAK,gBAAgB;AAAA,MACvC;AAAA,IACJ,EAAE;AAAA,EACN;AAAA,EAEA,cAAc,wBAAC,SAAS;AACpB,WAAO;AAAA,sBACO,WAAW,KAAK,KAAK,CAAC;AAAA,mCACnB,WAAW,KAAK,UAAU,cAAI,CAAC,gCAAY,4BAA4B,KAAK,cAAc,CAAC;AAAA,wCAC5E,KAAK,QAAQ,gBAAgB,0BAAM;AAAA,uBACpD,WAAW,KAAK,GAAG,CAAC;AAAA;AAAA,EAEvC,GAPc;AAQlB;AAEA,IAAO,yBAAQ;;;AC3Hf,eAAe,kBAAkB,KAAK,YAAY,mBAAmB,MAAM;AACvE,MAAI,CAAC,IAAI,gBAAgB;AACrB,UAAM,IAAI,MAAM,iDAAiD;AAAA,EACrE;AACA,MAAI,CAAC,IAAI,gBAAgB;AACrB,UAAM,IAAI,MAAM,mEAAmE;AAAA,EACvF;AACA,QAAM,YAAY,IAAI;AACtB,QAAM,MAAM,GAAG,IAAI,cAAc,kBAAkB,SAAS,wBAAwB,IAAI,cAAc;AACtG,QAAM,UAAU;AAAA,IACZ,UAAU,CAAC;AAAA,MACP,OAAO,CAAC,EAAE,MAAM,WAAW,CAAC;AAAA,IAChC,CAAC;AAAA,EACL;AAEA,MAAI,oBAAoB,OAAO,qBAAqB,YAAY,iBAAiB,KAAK,MAAM,IAAI;AAC5F,YAAQ,oBAAoB;AAAA,MACxB,OAAO,CAAC,EAAE,MAAM,iBAAiB,CAAC;AAAA,IACtC;AACA,YAAQ,IAAI,+CAA+C;AAAA,EAC/D;AAEA,MAAI;AACA,UAAM,WAAW,MAAM,MAAM,KAAK;AAAA,MAC9B,QAAQ;AAAA,MACR,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,MAC9C,MAAM,KAAK,UAAU,OAAO;AAAA,IAChC,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AACd,YAAM,gBAAgB,MAAM,SAAS,KAAK;AAC1C,UAAI;AACJ,UAAI;AACA,oBAAY,KAAK,MAAM,aAAa;AAAA,MACxC,SAAS,GAAG;AACR,oBAAY;AAAA,MAChB;AACA,cAAQ,MAAM,wCAAwC,OAAO,cAAc,WAAW,KAAK,UAAU,WAAW,MAAM,CAAC,IAAI,SAAS;AACpI,YAAM,UAAU,OAAO,cAAc,YAAY,UAAU,OAAO,UAC5D,UAAU,MAAM,UACf,OAAO,cAAc,WAAW,YAAY;AACnD,YAAM,IAAI,MAAM,0BAA0B,SAAS,MAAM,MAAM,OAAO,EAAE;AAAA,IAC5E;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AAGjC,QAAI,KAAK,kBAAkB,KAAK,eAAe,aAAa;AACxD,YAAM,cAAc,KAAK,eAAe;AACxC,YAAM,gBAAgB,KAAK,eAAe,gBAAgB,KAAK,UAAU,KAAK,eAAe,aAAa,IAAI;AAC9G,cAAQ,MAAM,+BAA+B,WAAW,qBAAqB,aAAa,IAAI,KAAK,UAAU,MAAM,MAAM,CAAC,CAAC;AAC3H,YAAM,IAAI,MAAM,+BAA+B,WAAW,qBAAqB,aAAa,EAAE;AAAA,IAClG;AAGA,QAAI,KAAK,cAAc,KAAK,WAAW,SAAS,GAAG;AAC/C,YAAM,YAAY,KAAK,WAAW,CAAC;AAInC,UAAI,UAAU,gBAAgB,UAAU,iBAAiB,QAAQ;AAC7D,cAAM,SAAS,UAAU;AACzB,cAAM,gBAAgB,UAAU,gBAAgB,KAAK,UAAU,UAAU,aAAa,IAAI;AAC1F,gBAAQ,MAAM,wDAAwD,MAAM,qBAAqB,aAAa,IAAI,KAAK,UAAU,MAAM,MAAM,CAAC,CAAC;AAC/I,YAAI,WAAW,UAAU;AACpB,gBAAM,IAAI,MAAM,yDAAyD,MAAM,sBAAsB,aAAa,EAAE;AAAA,QACzH;AACA,cAAM,IAAI,MAAM,mDAAmD,MAAM,qBAAqB,aAAa,EAAE;AAAA,MACjH;AAGA,UAAI,UAAU,WAAW,UAAU,QAAQ,SAAS,UAAU,QAAQ,MAAM,SAAS,KAAK,UAAU,QAAQ,MAAM,CAAC,EAAE,MAAM;AACvH,eAAO,UAAU,QAAQ,MAAM,CAAC,EAAE;AAAA,MACtC,OAAO;AAEH,gBAAQ,KAAK,4HAA4H,KAAK,UAAU,MAAM,MAAM,CAAC,CAAC;AACtK,cAAM,IAAI,MAAM,oFAAoF;AAAA,MACxG;AAAA,IACJ,OAAO;AAGH,cAAQ,KAAK,+FAA+F,KAAK,UAAU,MAAM,MAAM,CAAC,CAAC;AACzI,YAAM,IAAI,MAAM,6EAA6E;AAAA,IACjG;AAAA,EACJ,SAAS,OAAO;AAEZ,QAAI,EAAE,iBAAiB,SAAS,MAAM,QAAQ,WAAW,aAAa,IAAI;AACtE,cAAQ,MAAM,kDAAkD,KAAK;AAAA,IACzE;AACA,UAAM;AAAA,EACV;AACJ;AA3Fe;AAuGf,gBAAgB,wBAAwB,KAAK,YAAY,mBAAmB,MAAM;AAC9E,MAAI,CAAC,IAAI,gBAAgB;AACrB,UAAM,IAAI,MAAM,iDAAiD;AAAA,EACrE;AACA,MAAI,CAAC,IAAI,gBAAgB;AACrB,UAAM,IAAI,MAAM,mEAAmE;AAAA,EACvF;AACA,QAAM,YAAY,IAAI;AACtB,QAAM,MAAM,GAAG,IAAI,cAAc,kBAAkB,SAAS,8BAA8B,IAAI,cAAc;AAE5G,QAAM,UAAU;AAAA,IACZ,UAAU,CAAC;AAAA,MACP,OAAO,CAAC,EAAE,MAAM,WAAW,CAAC;AAAA,IAChC,CAAC;AAAA,IACD,kBAAkB;AAAA,MACd,aAAa;AAAA,MACb,MAAM;AAAA,IACV;AAAA,EACJ;AAEA,MAAI,oBAAoB,OAAO,qBAAqB,YAAY,iBAAiB,KAAK,MAAM,IAAI;AAC5F,YAAQ,oBAAoB;AAAA,MACxB,OAAO,CAAC,EAAE,MAAM,iBAAiB,CAAC;AAAA,IACtC;AACA,YAAQ,IAAI,+CAA+C;AAAA,EAC/D;AAEA,MAAI;AACJ,MAAI;AACA,eAAW,MAAM,MAAM,KAAK;AAAA,MACxB,QAAQ;AAAA,MACR,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,MAC9C,MAAM,KAAK,UAAU,OAAO;AAAA,IAChC,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AACd,YAAM,gBAAgB,MAAM,SAAS,KAAK;AAC1C,UAAI;AACJ,UAAI;AACA,oBAAY,KAAK,MAAM,aAAa;AAAA,MACxC,SAAS,GAAG;AACR,oBAAY;AAAA,MAChB;AACA,cAAQ,MAAM,yDAAyD,OAAO,cAAc,WAAW,KAAK,UAAU,WAAW,MAAM,CAAC,IAAI,SAAS;AACrJ,YAAM,UAAU,OAAO,cAAc,YAAY,UAAU,OAAO,UAC5D,UAAU,MAAM,UACf,OAAO,cAAc,WAAW,YAAY;AACnD,YAAM,IAAI,MAAM,0BAA0B,SAAS,MAAM,MAAM,OAAO,EAAE;AAAA,IAC5E;AAEA,QAAI,CAAC,SAAS,MAAM;AAChB,YAAM,IAAI,MAAM,uCAAuC;AAAA,IAC3D;AAEA,UAAM,SAAS,SAAS,KAAK,UAAU;AACvC,UAAM,UAAU,IAAI,YAAY;AAChC,QAAI,SAAS;AACb,QAAI,oBAAoB;AACxB,QAAI,sBAAsB;AAC1B,QAAI,qBAAqB;AAEzB,UAAM,mBAAmB,wBAAC,eAAe;AACrC,UAAI,WAAW,KAAK,MAAM,GAAI,QAAO;AACrC,UAAI;AACA,eAAO,KAAK,MAAM,UAAU;AAAA,MAChC,SAAS,GAAG;AACR,gBAAQ,KAAK,2CAA2C,YAAY,EAAE,OAAO;AAC7E,eAAO;AAAA,MACX;AAAA,IACJ,GARyB;AAUzB,UAAM,mBAAmB,wBAAC,UAAU;AAChC,UAAI,CAAC,MAAO,QAAO;AAGnB,UAAI,MAAM,kBAAkB,MAAM,eAAe,aAAa;AAC1D,cAAM,cAAc,MAAM,eAAe;AACzC,cAAM,gBAAgB,MAAM,eAAe,gBAAgB,KAAK,UAAU,MAAM,eAAe,aAAa,IAAI;AAChH,gBAAQ,MAAM,6CAA6C,WAAW,qBAAqB,aAAa,IAAI,KAAK,UAAU,OAAO,MAAM,CAAC,CAAC;AAC1I,cAAM,IAAI,MAAM,+BAA+B,WAAW,qBAAqB,aAAa,EAAE;AAAA,MAClG;AAGA,UAAI,MAAM,cAAc,MAAM,WAAW,SAAS,GAAG;AACjD,cAAM,YAAY,MAAM,WAAW,CAAC;AACpC,YAAI,UAAU,cAAc;AACxB,gCAAsB,UAAU;AAChC,+BAAqB,UAAU;AAE/B,cAAI,UAAU,iBAAiB,QAAQ;AACnC,kBAAM,SAAS,UAAU;AACzB,kBAAM,KAAK,UAAU,gBAAgB,KAAK,UAAU,UAAU,aAAa,IAAI;AAC/E,oBAAQ,MAAM,sDAAsD,MAAM,qBAAqB,EAAE,IAAI,KAAK,UAAU,OAAO,MAAM,CAAC,CAAC;AACnI,gBAAI,WAAW,UAAU;AACrB,oBAAM,IAAI,MAAM,yDAAyD,MAAM,sBAAsB,EAAE,EAAE;AAAA,YAC7G;AACA,kBAAM,IAAI,MAAM,uCAAuC,MAAM,qBAAqB,EAAE,EAAE;AAAA,UAC1F;AAAA,QACJ;AAEA,YAAI,UAAU,WAAW,UAAU,QAAQ,SAAS,UAAU,QAAQ,MAAM,SAAS,GAAG;AACpF,gBAAM,WAAW,UAAU,QAAQ,MAAM,CAAC,EAAE;AAC5C,cAAI,YAAY,OAAO,aAAa,UAAU;AAC1C,gCAAoB;AACpB,mBAAO;AAAA,UACX;AAAA,QACJ;AAAA,MACJ,WAAW,MAAM,OAAO;AACpB,gBAAQ,MAAM,uCAAuC,KAAK,UAAU,MAAM,OAAO,MAAM,CAAC,CAAC;AACzF,cAAM,IAAI,MAAM,iCAAiC,MAAM,MAAM,WAAW,yBAAyB,EAAE;AAAA,MACvG;AACA,aAAO;AAAA,IACX,GAzCyB;AA4CzB,WAAO,MAAM;AACT,YAAM,EAAE,MAAM,MAAM,IAAI,MAAM,OAAO,KAAK;AAC1C,UAAI,MAAM;AACN;AAAA,MACJ;AAEA,gBAAU,QAAQ,OAAO,OAAO,EAAE,QAAQ,KAAK,CAAC;AAEhD,UAAI;AACJ,cAAQ,gBAAgB,OAAO,QAAQ,MAAM,OAAO,OAAO,gBAAgB,OAAO,QAAQ,IAAI,OAAO,IAAI;AACrG,cAAM,kBAAmB,OAAO,QAAQ,MAAM,MAAM,gBAAiB,IAAI;AACzE,YAAI,UAAU,OAAO,UAAU,GAAG,aAAa;AAC/C,iBAAS,OAAO,UAAU,gBAAgB,eAAe;AAEzD,YAAI,QAAQ,WAAW,QAAQ,GAAG;AAC9B,oBAAU,QAAQ,UAAU,CAAC,EAAE,KAAK;AAAA,QACxC,OAAO;AACH,oBAAU,QAAQ,KAAK;AAAA,QAC3B;AAEA,YAAI,YAAY,MAAM,YAAY,UAAU;AACxC;AAAA,QACJ;AAEA,cAAM,cAAc,iBAAiB,OAAO;AAC5C,YAAI,aAAa;AACb,gBAAM,cAAc,iBAAiB,WAAW;AAChD,cAAI,gBAAgB,MAAM;AACtB,kBAAM;AAAA,UACV;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAGA,QAAI,OAAO,KAAK,GAAG;AACf,UAAI,eAAe,OAAO,KAAK;AAC9B,UAAI,aAAa,WAAW,QAAQ,GAAG;AACpC,uBAAe,aAAa,UAAU,CAAC,EAAE,KAAK;AAAA,MAClD;AACA,UAAI,iBAAiB,MAAM,iBAAiB,UAAU;AAClD,cAAM,cAAc,iBAAiB,YAAY;AAChD,YAAI,aAAa;AACd,gBAAM,cAAc,iBAAiB,WAAW;AAChD,cAAI,gBAAgB,MAAM;AACtB,kBAAM;AAAA,UACV;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAGA,QAAI,CAAC,mBAAmB;AACpB,UAAI,uBAAuB,wBAAwB,QAAQ;AACvD,cAAM,KAAK,qBAAqB,KAAK,UAAU,kBAAkB,IAAI;AACrE,gBAAQ,KAAK,yCAAyC,mBAAmB,yCAAyC,EAAE,EAAE;AACtH,cAAM,IAAI,MAAM,uCAAuC,mBAAmB,8CAA8C,EAAE,EAAE;AAAA,MAChI,WAAW,wBAAwB,QAAQ;AACvC,gBAAQ,KAAK,uEAAuE,KAAK,UAAU,EAAC,qBAAqB,mBAAkB,GAAG,MAAM,CAAC,CAAC;AACtJ,cAAM,IAAI,MAAM,kEAAkE;AAAA,MACtF,WAAW,CAAC,qBAAqB;AAC7B,gBAAQ,KAAK,iFAAiF;AAC9F,cAAM,IAAI,MAAM,4DAA4D;AAAA,MAChF;AAAA,IACJ;AAAA,EAEJ,SAAS,OAAO;AACX,QAAI,EAAE,iBAAiB,SAAS,MAAM,QAAQ,WAAW,aAAa,IAAI;AACvE,cAAQ,MAAM,oDAAoD,KAAK;AAAA,IAC3E;AACA,UAAM;AAAA,EACV;AACJ;AA3LgB;AAsMhB,eAAe,kBAAkB,KAAK,YAAY,mBAAmB,MAAM;AACvE,MAAI,CAAC,IAAI,gBAAgB;AACrB,UAAM,IAAI,MAAM,iDAAiD;AAAA,EACrE;AACA,MAAI,CAAC,IAAI,gBAAgB;AACrB,UAAM,IAAI,MAAM,mEAAmE;AAAA,EACvF;AACA,QAAM,MAAM,GAAG,IAAI,cAAc;AAEjC,QAAM,WAAW,CAAC;AAClB,MAAI,oBAAoB,OAAO,qBAAqB,YAAY,iBAAiB,KAAK,MAAM,IAAI;AAC5F,aAAS,KAAK,EAAE,MAAM,UAAU,SAAS,iBAAiB,CAAC;AAC3D,YAAQ,IAAI,sDAAsD;AAAA,EACtE;AACA,WAAS,KAAK,EAAE,MAAM,QAAQ,SAAS,WAAW,CAAC;AAEnD,QAAM,YAAY,IAAI;AACtB,QAAM,UAAU;AAAA,IACZ,OAAO;AAAA,IACP;AAAA,IACA,aAAa;AAAA,IACb,YAAY;AAAA,IACZ,OAAO;AAAA,IACP,mBAAmB;AAAA,IACnB,kBAAkB;AAAA,EACtB;AAEA,MAAI;AACA,UAAM,WAAW,MAAM,MAAM,KAAK;AAAA,MAC9B,QAAQ;AAAA,MACR,SAAS;AAAA,QACL,gBAAgB;AAAA,QAChB,iBAAiB,UAAU,IAAI,cAAc;AAAA,MACjD;AAAA,MACA,MAAM,KAAK,UAAU,OAAO;AAAA,IAChC,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AACd,YAAM,gBAAgB,MAAM,SAAS,KAAK;AAC1C,UAAI;AACJ,UAAI;AACA,oBAAY,KAAK,MAAM,aAAa;AAAA,MACxC,SAAS,GAAG;AACR,oBAAY;AAAA,MAChB;AACA,cAAQ,MAAM,wCAAwC,OAAO,cAAc,WAAW,KAAK,UAAU,WAAW,MAAM,CAAC,IAAI,SAAS;AACpI,YAAM,UAAU,OAAO,cAAc,YAAY,UAAU,OAAO,UAC5D,UAAU,MAAM,UACf,OAAO,cAAc,WAAW,YAAY;AACnD,YAAM,IAAI,MAAM,0BAA0B,SAAS,MAAM,MAAM,OAAO,EAAE;AAAA,IAC5E;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AAEjC,QAAI,KAAK,WAAW,KAAK,QAAQ,SAAS,KAAK,KAAK,QAAQ,CAAC,EAAE,WAAW,KAAK,QAAQ,CAAC,EAAE,QAAQ,SAAS;AACvG,aAAO,KAAK,QAAQ,CAAC,EAAE,QAAQ;AAAA,IACnC,OAAO;AACH,cAAQ,KAAK,4EAA4E,KAAK,UAAU,MAAM,MAAM,CAAC,CAAC;AACtH,YAAM,IAAI,MAAM,0DAA0D;AAAA,IAC9E;AAAA,EACJ,SAAS,OAAO;AACZ,QAAI,EAAE,iBAAiB,SAAS,MAAM,QAAQ,WAAW,aAAa,IAAI;AACtE,cAAQ,MAAM,kDAAkD,KAAK;AAAA,IACzE;AACA,UAAM;AAAA,EACV;AACJ;AAlEe;AA6Ef,gBAAgB,wBAAwB,KAAK,YAAY,mBAAmB,MAAM;AAC9E,MAAI,CAAC,IAAI,gBAAgB;AACrB,UAAM,IAAI,MAAM,iDAAiD;AAAA,EACrE;AACA,MAAI,CAAC,IAAI,gBAAgB;AACrB,UAAM,IAAI,MAAM,mEAAmE;AAAA,EACvF;AACA,QAAM,MAAM,GAAG,IAAI,cAAc;AAEjC,QAAM,WAAW,CAAC;AAClB,MAAI,oBAAoB,OAAO,qBAAqB,YAAY,iBAAiB,KAAK,MAAM,IAAI;AAC5F,aAAS,KAAK,EAAE,MAAM,UAAU,SAAS,iBAAiB,CAAC;AAC3D,YAAQ,IAAI,sDAAsD;AAAA,EACtE;AACA,WAAS,KAAK,EAAE,MAAM,QAAQ,SAAS,WAAW,CAAC;AAEnD,QAAM,YAAY,IAAI;AACtB,QAAM,UAAU;AAAA,IACZ,OAAO;AAAA,IACP;AAAA,IACA,aAAa;AAAA,IACb,YAAY;AAAA,IACZ,OAAO;AAAA,IACP,mBAAmB;AAAA,IACnB,kBAAkB;AAAA,IAClB,QAAQ;AAAA,EACZ;AAEA,MAAI;AACJ,MAAI;AACA,eAAW,MAAM,MAAM,KAAK;AAAA,MACxB,QAAQ;AAAA,MACR,SAAS;AAAA,QACL,gBAAgB;AAAA,QAChB,iBAAiB,UAAU,IAAI,cAAc;AAAA,MACjD;AAAA,MACA,MAAM,KAAK,UAAU,OAAO;AAAA,IAChC,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AACd,YAAM,gBAAgB,MAAM,SAAS,KAAK;AAC1C,UAAI;AACJ,UAAI;AACA,oBAAY,KAAK,MAAM,aAAa;AAAA,MACxC,SAAS,GAAG;AACR,oBAAY;AAAA,MAChB;AACA,cAAQ,MAAM,yDAAyD,OAAO,cAAc,WAAW,KAAK,UAAU,WAAW,MAAM,CAAC,IAAI,SAAS;AACrJ,YAAM,UAAU,OAAO,cAAc,YAAY,UAAU,OAAO,UAC5D,UAAU,MAAM,UACf,OAAO,cAAc,WAAW,YAAY;AACnD,YAAM,IAAI,MAAM,0BAA0B,SAAS,MAAM,MAAM,OAAO,EAAE;AAAA,IAC5E;AAEA,QAAI,CAAC,SAAS,MAAM;AAChB,YAAM,IAAI,MAAM,uCAAuC;AAAA,IAC3D;AAEA,UAAM,SAAS,SAAS,KAAK,UAAU;AACvC,UAAM,UAAU,IAAI,YAAY;AAChC,QAAI,SAAS;AACb,QAAI,oBAAoB;AAExB,WAAO,MAAM;AACT,YAAM,EAAE,MAAM,MAAM,IAAI,MAAM,OAAO,KAAK;AAC1C,UAAI,MAAM;AACN;AAAA,MACJ;AAEA,gBAAU,QAAQ,OAAO,OAAO,EAAE,QAAQ,KAAK,CAAC;AAGhD,UAAI;AACJ,cAAQ,gBAAgB,OAAO,QAAQ,MAAM,OAAO,IAAI;AACpD,YAAI,UAAU,OAAO,UAAU,GAAG,aAAa;AAC/C,iBAAS,OAAO,UAAU,gBAAgB,CAAC;AAE3C,YAAI,QAAQ,WAAW,QAAQ,GAAG;AAC9B,oBAAU,QAAQ,UAAU,CAAC,EAAE,KAAK;AAAA,QACxC,OAAO;AACH,oBAAU,QAAQ,KAAK;AAAA,QAC3B;AAEA,YAAI,YAAY,MAAM,YAAY,UAAU;AACxC;AAAA,QACJ;AAEA,YAAI;AACA,gBAAM,cAAc,KAAK,MAAM,OAAO;AACtC,cAAI,YAAY,WAAW,YAAY,QAAQ,SAAS,GAAG;AACvD,kBAAM,QAAQ,YAAY,QAAQ,CAAC,EAAE;AACrC,gBAAI,SAAS,MAAM,SAAS;AACxB,kCAAoB;AACpB,oBAAM,MAAM;AAAA,YAChB;AAAA,UACJ,WAAW,YAAY,OAAO;AAC1B,oBAAQ,MAAM,uCAAuC,KAAK,UAAU,YAAY,OAAO,MAAM,CAAC,CAAC;AAC/F,kBAAM,IAAI,MAAM,iCAAiC,YAAY,MAAM,WAAW,yBAAyB,EAAE;AAAA,UAC7G;AAAA,QACJ,SAAS,GAAG;AACR,kBAAQ,KAAK,kDAAkD,SAAS,EAAE,OAAO;AAAA,QAErF;AAAA,MACJ;AAAA,IACJ;AAGA,QAAI,OAAO,KAAK,GAAG;AACf,UAAI,eAAe,OAAO,KAAK;AAC/B,UAAI,aAAa,WAAW,QAAQ,GAAG;AACnC,uBAAe,aAAa,UAAU,CAAC,EAAE,KAAK;AAAA,MAClD;AACA,UAAI,iBAAiB,MAAM,iBAAiB,UAAU;AAClD,YAAI;AACA,gBAAM,cAAc,KAAK,MAAM,YAAY;AAC3C,cAAI,YAAY,WAAW,YAAY,QAAQ,SAAS,GAAG;AACvD,kBAAM,QAAQ,YAAY,QAAQ,CAAC,EAAE;AACrC,gBAAI,SAAS,MAAM,SAAS;AACxB,kCAAoB;AACpB,oBAAM,MAAM;AAAA,YAChB;AAAA,UACJ,WAAW,YAAY,OAAO;AAC1B,oBAAQ,MAAM,uCAAuC,KAAK,UAAU,YAAY,OAAO,MAAM,CAAC,CAAC;AAC/F,kBAAM,IAAI,MAAM,iCAAiC,YAAY,MAAM,WAAW,yBAAyB,EAAE;AAAA,UAC7G;AAAA,QACJ,SAAS,GAAG;AACR,kBAAQ,KAAK,wDAAwD,cAAc,EAAE,OAAO;AAAA,QAChG;AAAA,MACJ;AAAA,IACJ;AAEA,QAAI,CAAC,mBAAmB;AACpB,cAAQ,KAAK,yDAAyD;AACtE,YAAM,IAAI,MAAM,sDAAsD;AAAA,IAC1E;AAAA,EAEJ,SAAS,OAAO;AACZ,QAAI,EAAE,iBAAiB,SAAS,MAAM,QAAQ,WAAW,aAAa,IAAI;AACtE,cAAQ,MAAM,oDAAoD,KAAK;AAAA,IAC3E;AACA,UAAM;AAAA,EACV;AACJ;AA9IgB;AA2JhB,eAAsB,YAAY,KAAK,YAAY,mBAAmB,MAAM;AACxE,QAAM,WAAW,IAAI;AACrB,MAAI,SAAS,WAAW,MAAM,GAAG;AAC7B,WAAO,kBAAkB,KAAK,YAAY,gBAAgB;AAAA,EAC9D,OAAO;AACH,WAAO,kBAAkB,KAAK,YAAY,gBAAgB;AAAA,EAC9D;AACJ;AAPsB;AAmBtB,gBAAuB,kBAAkB,KAAK,YAAY,mBAAmB,MAAM;AAC/E,QAAM,WAAW,IAAI;AACrB,MAAI,SAAS,WAAW,MAAM,GAAG;AAC7B,WAAO,wBAAwB,KAAK,YAAY,gBAAgB;AAAA,EACpE,OAAO;AACH,WAAO,wBAAwB,KAAK,YAAY,gBAAgB;AAAA,EACpE;AACJ;AAPuB;;;AC/iBvB,IAAM,qBAAqB;AAAA,EACvB,OAAO,8BAAO,QAAQ;AAClB,YAAQ,IAAI,2BAA2B,IAAI,gBAAgB,EAAE;AAC7D,QAAI;AACJ,QAAI;AACA,iBAAW,MAAM,UAAU,IAAI,gBAAgB;AAAA,IACnD,SAAS,OAAO;AACZ,cAAQ,MAAM,iCAAiC,MAAM,OAAO;AAC5D,aAAO,EAAE,OAAO,iCAAiC,SAAS,MAAM,SAAS,OAAO,CAAC,EAAE;AAAA,IACvF;AAEA,QAAI,CAAC,MAAM,QAAQ,QAAQ,GAAG;AAC1B,cAAQ,MAAM,kCAAkC,QAAQ;AACxD,aAAO,EAAE,OAAO,gCAAgC,UAAU,UAAU,OAAO,CAAC,EAAE;AAAA,IAClF;AACC,QAAI,SAAS,WAAW,GAAG;AACxB,cAAQ,IAAI,+BAA+B;AAC3C,aAAO,EAAE,OAAO,CAAC,EAAE;AAAA,IACvB;AAEA,QAAI,CAAC,IAAI,mBAAmB,QAAQ;AAChC,cAAQ,KAAK,8BAA8B;AAC3C,aAAO,SAAS,IAAI,QAAM,EAAE,GAAG,GAAG,gBAAgB,EAAE,eAAe,GAAG,EAAE;AAAA,IAC5E;AAEA,UAAM,0BAA0B,SAC3B,IAAI,OAAK,EAAE,eAAe,EAAE,EAC5B,OAAO,UAAQ,OAAO,SAAS,QAAQ;AAE5C,UAAM,uBAAuB,wBAAwB,OAAO,OAAK,EAAE,KAAK,MAAM,EAAE;AAChF,QAAI,qBAAqB,WAAW,GAAG;AACnC,cAAQ,IAAI,iDAAiD;AAC7D,aAAO,SAAS,IAAI,QAAM,EAAE,GAAG,GAAG,gBAAgB,EAAE,eAAe,GAAG,EAAE;AAAA,IAC5E;AACA,UAAM,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA,EAKzB,KAAK,UAAU,uBAAuB,CAAC;AAAA;AAAA;AAIjC,QAAI,kBAAkB,CAAC;AACvB,QAAI;AACA,cAAQ,IAAI,8BAA8B,wBAAwB,MAAM,wBAAwB;AAChG,YAAM,eAAe,MAAM,YAAY,KAAK,UAAU;AACtD,YAAM,qBAAqB,KAAK,MAAM,wBAAwB,YAAY,CAAC;AAE3E,UAAI,sBAAsB,MAAM,QAAQ,kBAAkB,KAAK,mBAAmB,WAAW,wBAAwB,QAAQ;AACzH,0BAAkB;AAAA,MACtB,OAAO;AACH,gBAAQ,KAAK,kFAAkF,wBAAwB,MAAM,cAAc,qBAAqB,mBAAmB,SAAS,MAAM,iBAAiB;AACnN,0BAAkB,wBAAwB,IAAI,MAAM,IAAI;AAAA,MAC5D;AAAA,IACJ,SAAS,kBAAkB;AACvB,cAAQ,MAAM,sDAAsD,iBAAiB,OAAO;AAC5F,wBAAkB,wBAAwB,IAAI,MAAM,IAAI;AAAA,IAC5D;AAEA,WAAO,SAAS,IAAI,CAAC,SAAS,UAAU;AACpC,YAAM,aAAa,gBAAgB,KAAK;AACxC,aAAO;AAAA,QACH,GAAG;AAAA,QACH,gBAAiB,OAAO,eAAe,WAAY,aAAc,QAAQ,eAAe;AAAA,MAC5F;AAAA,IACJ,CAAC;AAAA,EACL,GAlEO;AAAA,EAmEP,WAAW,wBAAC,cAAc,eAAe;AACrC,UAAM,kBAAkB,CAAC;AACzB,UAAM,MAAM,WAAW;AACvB,QAAI,MAAM,QAAQ,YAAY,GAAG;AAC7B,mBAAa,QAAQ,CAAC,SAAS,UAAU;AACrC,wBAAgB,KAAK;AAAA,UACjB,IAAI,QAAQ;AAAA;AAAA,UACZ,MAAM;AAAA,UACN,KAAK,QAAQ;AAAA,UACb,OAAO,QAAQ;AAAA,UACf,aAAa,QAAQ,kBAAkB,QAAQ,eAAe;AAAA,UAC9D,gBAAgB;AAAA;AAAA,UAChB,SAAS,QAAQ,QAAQ,CAAC,QAAQ,KAAK,IAAI,CAAC;AAAA,UAC5C,QAAQ;AAAA,UACR,SAAS;AAAA,YACL,OAAO,QAAQ;AAAA,YACf,MAAM,QAAQ;AAAA,YACd,UAAU,QAAQ;AAAA,YAClB,eAAe,QAAQ;AAAA,YACvB,YAAY,QAAQ;AAAA,YACpB,OAAO,QAAQ;AAAA,YACf,YAAY,QAAQ;AAAA,YACpB,SAAS,QAAQ,WAAW,CAAC;AAAA,UACjC;AAAA,QACJ,CAAC;AAAA,MACL,CAAC;AAAA,IACL;AACA,WAAO;AAAA,EACX,GA5BW;AAAA,EA8BX,cAAc,wBAAC,SAAS;AACpB,WAAO;AAAA,sBACO,WAAW,KAAK,KAAK,CAAC,kCAAmB,WAAW,KAAK,QAAQ,KAAK,CAAC;AAAA,mCACpE,WAAW,KAAK,QAAQ,UAAU,CAAC,mBAAS,WAAW,KAAK,QAAQ,UAAU,CAAC,qBAAW,WAAW,KAAK,QAAQ,YAAY,KAAK,CAAC;AAAA,4BAC3I,WAAW,KAAK,WAAW,KAAK,KAAK;AAAA,uBAChC,WAAW,KAAK,GAAG,CAAC;AAAA;AAAA,EAEvC,GAPc;AAQlB;AAEA,IAAO,0BAAQ;;;AC9Gf,IAAM,mBAAmB;AAAA,EACrB,MAAM;AAAA,EACN,MAAM,MAAM,KAAK,YAAY;AACzB,UAAM,iBAAiB,IAAI;AAC3B,UAAM,aAAa,SAAS,IAAI,wBAAwB,KAAK,EAAE;AAC/D,UAAM,gBAAgB,CAAC;AACvB,UAAM,aAAa,SAAS,IAAI,oBAAoB,KAAK,EAAE;AAE3D,QAAI,CAAC,gBAAgB;AACjB,cAAQ,KAAK,8EAA8E;AAC3F,aAAO;AAAA,QACH,SAAS;AAAA,QACT,OAAO;AAAA,QACP,eAAe;AAAA,QACf,aAAa;AAAA,QACb,UAAU;AAAA,QACV,OAAO,CAAC;AAAA,MACZ;AAAA,IACJ;AAEA,QAAI,iBAAiB;AACrB,aAAS,IAAI,GAAG,IAAI,YAAY,KAAK;AACjC,YAAM,YAAY,mBAAmB;AACrC,YAAM,UAAU;AAAA,QACZ,cAAc;AAAA,QACd,gBAAgB;AAAA,QAChB,UAAU;AAAA,QACV,mBAAmB;AAAA,QACnB,WAAW;AAAA,QACX,UAAU;AAAA,QACV,YAAY;AAAA,QACZ,aAAa;AAAA,QACb,oBAAoB;AAAA,QACpB,sBAAsB;AAAA,QACtB,kBAAkB;AAAA,QAClB,kBAAkB;AAAA,QAClB,kBAAkB;AAAA,QAClB,cAAc;AAAA,QACd,iBAAiB;AAAA,MACrB;AAEA,UAAI,YAAY;AACZ,gBAAQ,QAAQ,IAAI;AAAA,MACxB;AAEA,YAAM,OAAO;AAAA,QACT,QAAQ;AAAA,QACR,MAAM;AAAA,QACN,aAAa;AAAA,MACjB;AAEA,UAAI,gBAAgB;AAChB,aAAK,iBAAiB;AAAA,MAC1B;AAEA,UAAI;AACA,gBAAQ,IAAI,8BAA8B,IAAI,CAAC,KAAK;AACpD,cAAM,WAAW,MAAM,MAAM,IAAI,eAAe;AAAA,UAC5C,QAAQ;AAAA,UACR;AAAA,UACA,MAAM,KAAK,UAAU,IAAI;AAAA,QAC7B,CAAC;AAED,YAAI,CAAC,SAAS,IAAI;AACd,kBAAQ,MAAM,qCAAqC,IAAI,CAAC,KAAK,SAAS,UAAU,EAAE;AAClF;AAAA,QACJ;AACA,cAAM,OAAO,MAAM,SAAS,KAAK;AACjC,YAAI,QAAQ,KAAK,QAAQ,KAAK,KAAK,SAAS,GAAG;AAC3C,gBAAM,gBAAgB,KAAK,KAAK,OAAO,WAAS,qBAAqB,MAAM,QAAQ,aAAa,UAAU,CAAC;AAC3G,wBAAc,KAAK,GAAG,cAAc,IAAI,YAAU;AAAA,YAC9C,IAAI,MAAM,QAAQ;AAAA,YAClB,KAAK,MAAM,QAAQ;AAAA,YACnB,OAAO,MAAM,QAAQ;AAAA,YACrB,cAAc,MAAM,QAAQ;AAAA,YAC5B,gBAAgB,MAAM,QAAQ;AAAA,YAC9B,SAAS,CAAC,EAAE,MAAM,MAAM,QAAQ,OAAO,CAAC;AAAA,YACxC,QAAQ,MAAM,MAAM;AAAA,UACxB,EAAE,CAAC;AACH,2BAAiB,KAAK,KAAK,KAAK,KAAK,SAAS,CAAC,EAAE,QAAQ;AAAA,QAC7D,OAAO;AACH,kBAAQ,IAAI,iCAAiC,IAAI,CAAC,GAAG;AACrD;AAAA,QACJ;AAAA,MACJ,SAAS,OAAO;AACZ,gBAAQ,MAAM,oCAAoC,IAAI,CAAC,KAAK,KAAK;AACjE;AAAA,MACJ;AAEA,YAAM,MAAM,KAAK,OAAO,IAAI,GAAI;AAAA,IACpC;AAEA,WAAO;AAAA,MACH,SAAS;AAAA,MACT,OAAO;AAAA,MACP,eAAe;AAAA,MACf,aAAa;AAAA,MACb,UAAU;AAAA,MACV,OAAO;AAAA,IACX;AAAA,EACJ;AAAA,EAEA,UAAU,SAAS,YAAY;AAC3B,QAAI,CAAC,WAAW,CAAC,QAAQ,OAAO;AAC5B,aAAO,CAAC;AAAA,IACZ;AAEA,WAAO,QAAQ,MAAM,IAAI,WAAS;AAAA,MAC9B,IAAI,KAAK;AAAA,MACT,MAAM;AAAA,MACN,KAAK,KAAK;AAAA,MACV,OAAO,KAAK;AAAA,MACZ,aAAa,UAAU,KAAK,gBAAgB,EAAE;AAAA,MAC9C,gBAAgB,KAAK;AAAA,MACrB,SAAS,KAAK,UAAU,KAAK,QAAQ,IAAI,YAAU,OAAO,IAAI,EAAE,KAAK,IAAI,IAAI;AAAA,MAC7E,QAAQ,KAAK,UAAU;AAAA,MACvB,SAAS;AAAA,QACL,cAAc,KAAK,gBAAgB;AAAA,MACvC;AAAA,IACJ,EAAE;AAAA,EACN;AAAA,EAEA,cAAc,wBAAC,SAAS;AACpB,WAAO;AAAA,sBACO,WAAW,KAAK,KAAK,CAAC;AAAA,mCACnB,WAAW,KAAK,UAAU,cAAI,CAAC,gCAAY,4BAA4B,KAAK,cAAc,CAAC;AAAA;AAAA,mBAEjG,KAAK,QAAQ,gBAAgB,0BAAM;AAAA;AAAA,uBAE/B,WAAW,KAAK,GAAG,CAAC;AAAA;AAAA,EAEvC,GATc;AAUlB;AAEA,IAAO,iBAAQ;;;ACtIf,IAAM,oBAAoB;AAAA,EACtB,MAAM,MAAM,KAAK,YAAY;AACzB,UAAM,SAAS,IAAI;AACnB,UAAM,aAAa,SAAS,IAAI,uBAAuB,KAAK,EAAE;AAC9D,UAAM,kBAAkB,CAAC;AACzB,UAAM,aAAa,SAAS,IAAI,oBAAoB,KAAK,EAAE;AAE3D,QAAI,CAAC,QAAQ;AACT,cAAQ,MAAM,sDAAsD;AACpE,aAAO;AAAA,QACH,SAAS;AAAA,QACT,OAAO;AAAA,QACP,eAAe;AAAA,QACf,aAAa;AAAA,QACb,UAAU;AAAA,QACV,OAAO,CAAC;AAAA,MACZ;AAAA,IACJ;AAEA,QAAI,iBAAiB;AACrB,aAAS,IAAI,GAAG,IAAI,YAAY,KAAK;AACjC,YAAM,YAAY,mBAAmB;AACrC,YAAM,UAAU;AAAA,QACZ,cAAc;AAAA,QACd,gBAAgB;AAAA,QAChB,UAAU;AAAA,QACV,mBAAmB;AAAA,QACnB,WAAW;AAAA,QACX,UAAU;AAAA,QACV,YAAY;AAAA,QACZ,aAAa;AAAA,QACb,oBAAoB;AAAA,QACpB,sBAAsB;AAAA,QACtB,kBAAkB;AAAA,QAClB,kBAAkB;AAAA,QAClB,kBAAkB;AAAA,QAClB,cAAc;AAAA,QACd,iBAAiB;AAAA,MACrB;AAGA,UAAI,YAAY;AACZ,gBAAQ,QAAQ,IAAI;AAAA,MACxB;AAEA,YAAM,OAAO;AAAA,QACT;AAAA,QACA,MAAM;AAAA,QACN,aAAa;AAAA,MACjB;AAEA,UAAI,gBAAgB;AAChB,aAAK,iBAAiB;AAAA,MAC1B;AAEA,UAAI;AACA,gBAAQ,IAAI,+BAA+B,IAAI,CAAC,KAAK;AACrD,cAAM,WAAW,MAAM,MAAM,IAAI,eAAe;AAAA,UAC5C,QAAQ;AAAA,UACR;AAAA,UACA,MAAM,KAAK,UAAU,IAAI;AAAA,QAC7B,CAAC;AAED,YAAI,CAAC,SAAS,IAAI;AACd,kBAAQ,MAAM,sCAAsC,IAAI,CAAC,KAAK,SAAS,UAAU,EAAE;AACnF;AAAA,QACJ;AACA,cAAM,OAAO,MAAM,SAAS,KAAK;AACjC,YAAI,QAAQ,KAAK,QAAQ,KAAK,KAAK,SAAS,GAAG;AAC3C,gBAAM,gBAAgB,KAAK,KAAK,OAAO,WAAS,qBAAqB,MAAM,QAAQ,aAAa,UAAU,CAAC;AAC3G,0BAAgB,KAAK,GAAG,cAAc,IAAI,YAAU;AAAA,YAChD,IAAI,MAAM,QAAQ;AAAA,YAClB,KAAK,MAAM,QAAQ;AAAA,YACnB,OAAO,MAAM,QAAQ;AAAA,YACrB,cAAc,MAAM,QAAQ;AAAA,YAC5B,gBAAgB,MAAM,QAAQ;AAAA,YAC9B,SAAS,CAAC,EAAE,MAAM,MAAM,QAAQ,OAAO,CAAC;AAAA,YACxC,QAAQ,MAAM,MAAM,SAAS,MAAM,MAAM,MAAM,WAAW,SAAS,IAAI,WAAW,MAAM,QAAQ,MAAM,KAAK,GAAG,MAAM,MAAM,KAAK,MAAM,MAAM,QAAQ,MAAM;AAAA,UAC7J,EAAE,CAAC;AACH,2BAAiB,KAAK,KAAK,KAAK,KAAK,SAAS,CAAC,EAAE,QAAQ;AAAA,QAC7D,OAAO;AACH,kBAAQ,IAAI,kCAAkC,IAAI,CAAC,GAAG;AACtD;AAAA,QACJ;AAAA,MACJ,SAAS,OAAO;AACZ,gBAAQ,MAAM,qCAAqC,IAAI,CAAC,KAAK,KAAK;AAClE;AAAA,MACJ;AAGA,YAAM,MAAM,KAAK,OAAO,IAAI,GAAI;AAAA,IACpC;AAEA,WAAO;AAAA,MACH,SAAS;AAAA,MACT,OAAO;AAAA,MACP,eAAe;AAAA,MACf,aAAa;AAAA,MACb,UAAU;AAAA,MACV,OAAO;AAAA,IACX;AAAA,EACJ;AAAA,EAEA,UAAU,SAAS,YAAY;AAC3B,QAAI,CAAC,WAAW,CAAC,QAAQ,OAAO;AAC5B,aAAO,CAAC;AAAA,IACZ;AAEA,WAAO,QAAQ,MAAM,IAAI,WAAS;AAAA,MAC9B,IAAI,KAAK;AAAA,MACT,MAAM;AAAA,MACN,KAAK,KAAK;AAAA,MACV,OAAO,KAAK;AAAA,MACZ,aAAa,UAAU,KAAK,gBAAgB,EAAE;AAAA,MAC9C,gBAAgB,KAAK;AAAA,MACrB,SAAS,KAAK,UAAU,KAAK,QAAQ,IAAI,YAAU,OAAO,IAAI,EAAE,KAAK,IAAI,IAAI;AAAA,MAC7E,QAAQ,KAAK,UAAU;AAAA;AAAA,MACvB,SAAS;AAAA,QACL,cAAc,KAAK,gBAAgB;AAAA,MACvC;AAAA,IACJ,EAAE;AAAA,EACN;AAAA,EAEA,cAAc,wBAAC,SAAS;AACpB,WAAO;AAAA,sBACO,WAAW,KAAK,KAAK,CAAC;AAAA,mCACnB,WAAW,KAAK,UAAU,cAAI,CAAC,gCAAY,4BAA4B,KAAK,cAAc,CAAC;AAAA;AAAA,kBAElG,KAAK,QAAQ,gBAAgB,0BAAM;AAAA;AAAA,uBAE9B,WAAW,KAAK,GAAG,CAAC;AAAA;AAAA,EAEvC,GATc;AAUlB;AAEA,IAAO,kBAAQ;;;ACvIf,IAAM,mBAAmB;AAAA,EACrB,MAAM,MAAM,KAAK,YAAY;AACzB,UAAM,SAAS,IAAI;AACnB,UAAM,aAAa,SAAS,IAAI,sBAAsB,KAAK,EAAE;AAC7D,UAAM,iBAAiB,CAAC;AACxB,UAAM,aAAa,SAAS,IAAI,oBAAoB,KAAK,EAAE;AAE3D,QAAI,CAAC,QAAQ;AACT,cAAQ,MAAM,qDAAqD;AACnE,aAAO;AAAA,QACH,SAAS;AAAA,QACT,OAAO;AAAA,QACP,eAAe;AAAA,QACf,aAAa;AAAA,QACb,UAAU;AAAA,QACV,OAAO,CAAC;AAAA,MACZ;AAAA,IACJ;AAEA,QAAI,iBAAiB;AACrB,aAAS,IAAI,GAAG,IAAI,YAAY,KAAK;AACjC,YAAM,YAAY,mBAAmB;AACrC,YAAM,UAAU;AAAA,QACZ,cAAc;AAAA,QACd,gBAAgB;AAAA,QAChB,UAAU;AAAA,QACV,mBAAmB;AAAA,QACnB,WAAW;AAAA,QACX,UAAU;AAAA,QACV,YAAY;AAAA,QACZ,aAAa;AAAA,QACb,oBAAoB;AAAA,QACpB,sBAAsB;AAAA,QACtB,kBAAkB;AAAA,QAClB,kBAAkB;AAAA,QAClB,kBAAkB;AAAA,QAClB,cAAc;AAAA,QACd,iBAAiB;AAAA,MACrB;AAEA,UAAI,YAAY;AACZ,gBAAQ,QAAQ,IAAI;AAAA,MACxB;AAEA,YAAM,OAAO;AAAA,QACT;AAAA,QACA,MAAM;AAAA,QACN,aAAa;AAAA,MACjB;AAEA,UAAI,gBAAgB;AAChB,aAAK,iBAAiB;AAAA,MAC1B;AAEA,UAAI;AACA,gBAAQ,IAAI,8BAA8B,IAAI,CAAC,KAAK;AACpD,cAAM,WAAW,MAAM,MAAM,IAAI,eAAe;AAAA,UAC5C,QAAQ;AAAA,UACR;AAAA,UACA,MAAM,KAAK,UAAU,IAAI;AAAA,QAC7B,CAAC;AAED,YAAI,CAAC,SAAS,IAAI;AACd,kBAAQ,MAAM,qCAAqC,IAAI,CAAC,KAAK,SAAS,UAAU,EAAE;AAClF;AAAA,QACJ;AACA,cAAM,OAAO,MAAM,SAAS,KAAK;AACjC,YAAI,QAAQ,KAAK,QAAQ,KAAK,KAAK,SAAS,GAAG;AAC3C,gBAAM,gBAAgB,KAAK,KAAK,OAAO,WAAS,qBAAqB,MAAM,QAAQ,aAAa,UAAU,CAAC;AAC3G,yBAAe,KAAK,GAAG,cAAc,IAAI,YAAU;AAAA,YAC/C,IAAI,MAAM,QAAQ;AAAA,YAClB,KAAK,MAAM,QAAQ;AAAA,YACnB,OAAO,MAAM,QAAQ;AAAA,YACrB,cAAc,MAAM,QAAQ;AAAA,YAC5B,gBAAgB,MAAM,QAAQ;AAAA,YAC9B,SAAS,CAAC,EAAE,MAAM,MAAM,QAAQ,OAAO,CAAC;AAAA,YACxC,QAAQ,GAAG,MAAM,MAAM,KAAK;AAAA,UAChC,EAAE,CAAC;AACH,2BAAiB,KAAK,KAAK,KAAK,KAAK,SAAS,CAAC,EAAE,QAAQ;AAAA,QAC7D,OAAO;AACH,kBAAQ,IAAI,iCAAiC,IAAI,CAAC,GAAG;AACrD;AAAA,QACJ;AAAA,MACJ,SAAS,OAAO;AACZ,gBAAQ,MAAM,oCAAoC,IAAI,CAAC,KAAK,KAAK;AACjE;AAAA,MACJ;AAEA,YAAM,MAAM,KAAK,OAAO,IAAI,GAAI;AAAA,IACpC;AAEA,UAAM,aAAa;AAAA,MACf,SAAS;AAAA,MACT,OAAO;AAAA,MACP,eAAe;AAAA,MACf,aAAa;AAAA,MACb,UAAU;AAAA,MACV,OAAO;AAAA,IACX;AAEA,QAAI,WAAW,MAAM,WAAW,GAAG;AAC/B,cAAQ,IAAI,qDAAqD;AACjE,aAAO;AAAA,IACX;AAEA,eAAW,QAAQ,WAAW,MAAM,IAAI,WAAS;AAAA,MAC7C,GAAG;AAAA,MACH,UAAU,KAAK,SAAS;AAAA,IAC5B,EAAE;AAEF,WAAO;AAAA,EACX;AAAA,EAEA,UAAU,SAAS,YAAY;AAC3B,QAAI,CAAC,WAAW,CAAC,QAAQ,OAAO;AAC5B,aAAO,CAAC;AAAA,IACZ;AAEA,WAAO,QAAQ,MAAM,IAAI,WAAS;AAAA,MAC9B,IAAI,KAAK;AAAA,MACT,MAAM;AAAA,MACN,KAAK,KAAK;AAAA,MACV,OAAO,KAAK;AAAA,MACZ,aAAa,UAAU,KAAK,gBAAgB,EAAE;AAAA,MAC9C,gBAAgB,KAAK;AAAA,MACrB,SAAS,KAAK,UAAU,KAAK,QAAQ,IAAI,YAAU,OAAO,IAAI,EAAE,KAAK,IAAI,IAAI;AAAA,MAC7E,QAAQ,KAAK,UAAU;AAAA,MACvB,SAAS;AAAA,QACL,cAAc,KAAK,gBAAgB;AAAA,MACvC;AAAA,IACJ,EAAE;AAAA,EACN;AAAA,EAEA,cAAc,wBAAC,SAAS;AACpB,WAAO;AAAA,sBACO,WAAW,KAAK,KAAK,CAAC;AAAA,mCACnB,WAAW,KAAK,UAAU,cAAI,CAAC,gCAAY,4BAA4B,KAAK,cAAc,CAAC;AAAA;AAAA,kBAElG,KAAK,QAAQ,gBAAgB,0BAAM;AAAA;AAAA,uBAE9B,WAAW,KAAK,GAAG,CAAC;AAAA;AAAA,EAEvC,GATc;AAUlB;AAEA,IAAO,iBAAQ;;;AC1IR,IAAM,cAAc;AAAA,EACvB,MAAM,EAAE,MAAM,gBAAM,SAAS,CAAC,sBAAwB,EAAE;AAAA,EACxD,SAAS,EAAE,MAAM,gBAAM,SAAS,CAAC,uBAAwB,EAAE;AAAA,EAC3D,OAAO,EAAE,MAAM,gBAAM,SAAS,CAAC,cAAgB,EAAE;AAAA,EACjD,aAAa,EAAE,MAAM,4BAAQ,SAAS,CAAC,iBAAmB,cAAgB,EAAE;AAAA;AAAA;AAGhF;AASA,eAAsB,6BAA6B,YAAY,KAAK,YAAY;AAC5E,QAAM,UAAU,YAAY,UAAU,EAAE;AACxC,MAAI,CAAC,WAAW,CAAC,MAAM,QAAQ,OAAO,GAAG;AACrC,YAAQ,MAAM,wCAAwC,UAAU,EAAE;AAClE,WAAO,CAAC;AAAA,EACZ;AAEA,MAAI,wBAAwB,CAAC;AAC7B,aAAW,cAAc,SAAS;AAC9B,QAAI;AAEA,YAAM,UAAU,MAAM,WAAW,MAAM,KAAK,UAAU;AACtD,YAAM,cAAc,WAAW,UAAU,SAAS,UAAU;AAC5D,8BAAwB,sBAAsB,OAAO,WAAW;AAAA,IACpE,SAAS,OAAO;AACZ,cAAQ,MAAM,mDAAmD,WAAW,IAAI,aAAa,UAAU,KAAK,MAAM,OAAO;AAAA,IAE7H;AAAA,EACJ;AAGA,wBAAsB,KAAK,CAAC,GAAG,MAAM;AACjC,UAAM,QAAQ,IAAI,KAAK,EAAE,cAAc;AACvC,UAAM,QAAQ,IAAI,KAAK,EAAE,cAAc;AACvC,WAAO,MAAM,QAAQ,IAAI,MAAM,QAAQ;AAAA,EAC3C,CAAC;AAED,SAAO;AACX;AA5BsB;AAoCtB,eAAsB,aAAa,KAAK,YAAY;AAChD,QAAM,iBAAiB,CAAC;AACxB,QAAM,gBAAgB,CAAC;AAEvB,aAAW,cAAc,aAAa;AAClC,QAAI,OAAO,eAAe,KAAK,aAAa,UAAU,GAAG;AACrD,oBAAc;AAAA,QACV,6BAA6B,YAAY,KAAK,UAAU,EAAE,KAAK,UAAQ;AACnE,yBAAe,UAAU,IAAI;AAAA,QACjC,CAAC;AAAA,MACL;AAAA,IACJ;AAAA,EACJ;AACA,QAAM,QAAQ,WAAW,aAAa;AACtC,SAAO;AACX;AAfsB;AAwBtB,eAAsB,oBAAoB,KAAK,UAAU,YAAY;AACjE,MAAI,CAAC,YAAY,QAAQ,GAAG;AACxB,YAAQ,KAAK,iDAAiD,QAAQ,EAAE;AACxE,WAAO,CAAC;AAAA,EACZ;AACA,SAAO,MAAM,6BAA6B,UAAU,KAAK,UAAU;AACvE;AANsB;;;ACnFtB,eAAsB,UAAU,aAAa,KAAK,OAAO,gBAAgB,QAAQ,GAAG;AAChF,UAAQ,IAAI,gCAAgC,GAAG,EAAE;AACjD,QAAM,YAAY,IAAI,KAAK,KAAK,UAAU,KAAK,GAAG,EAAE,cAAc,CAAC;AACvE;AAHsB;AAKtB,eAAsB,UAAU,aAAa,KAAK;AAC9C,UAAQ,IAAI,qCAAqC,GAAG,EAAE;AACtD,QAAM,QAAQ,MAAM,YAAY,IAAI,GAAG;AACvC,SAAO,QAAQ,KAAK,MAAM,KAAK,IAAI;AACvC;AAJsB;;;ACFtB,eAAsB,gBAAgB,SAAS,KAAK;AAChD,QAAM,YAAY,aAAa;AAC/B,QAAM,UAAU,YAAY,YAAY,WAAW;AACnD,UAAQ,IAAI,yCAAyC,OAAO,EAAE;AAC9D,MAAI,WAAW;AACf,MAAI,aAAa;AAEjB,MAAI;AAEA,QAAI,QAAQ,QAAQ,IAAI,cAAc,GAAG,SAAS,kBAAkB,GAAG;AACnE,YAAM,cAAc,MAAM,QAAQ,KAAK;AACvC,iBAAW,YAAY;AACvB,mBAAa,YAAY;AAAA,IAC7B;AAEA,YAAQ,IAAI,6CAA6C,YAAY,KAAK,8BAA8B,CAAC,CAAC,UAAU,EAAE;AAEtH,QAAI,cAAc,CAAC;AACnB,QAAI,gBAAgB,CAAC;AACrB,QAAI,iBAAiB;AAErB,QAAI,UAAU;AAEV,YAAM,cAAc,MAAM,oBAAoB,KAAK,UAAU,UAAU;AACvE,kBAAY,QAAQ,IAAI;AACxB,oBAAc,KAAK,UAAU,IAAI,SAAS,GAAG,OAAO,IAAI,QAAQ,IAAI,WAAW,CAAC;AAChF,uBAAiB,sBAAsB,QAAQ;AAC/C,cAAQ,IAAI,eAAe,QAAQ,KAAK,YAAY,MAAM,SAAS;AAAA,IACvE,OAAO;AAEH,YAAM,iBAAiB,MAAM,aAAa,KAAK,UAAU;AAEzD,iBAAW,cAAc,aAAa;AAClC,YAAI,OAAO,eAAe,KAAK,aAAa,UAAU,GAAG;AACrD,sBAAY,UAAU,IAAI,eAAe,UAAU,KAAK,CAAC;AACzD,wBAAc,KAAK,UAAU,IAAI,SAAS,GAAG,OAAO,IAAI,UAAU,IAAI,YAAY,UAAU,CAAC,CAAC;AAC9F,kBAAQ,IAAI,eAAe,UAAU,KAAK,YAAY,UAAU,EAAE,MAAM,SAAS;AAAA,QACrF;AAAA,MACJ;AACA,uBAAiB;AAAA,IACrB;AAEA,UAAM,QAAQ,IAAI,aAAa;AAE/B,UAAM,SAAS,CAAC;AAEhB,QAAI,OAAO,SAAS,GAAG;AACnB,cAAQ,KAAK,qCAAqC,MAAM;AACxD,aAAO,IAAI,SAAS,KAAK,UAAU;AAAA,QAC/B,SAAS;AAAA,QACT,SAAS,GAAG,cAAc;AAAA,QAC1B;AAAA,QACA,GAAG,OAAO,YAAY,OAAO,QAAQ,WAAW,EAAE,IAAI,CAAC,CAAC,KAAK,KAAK,MAAM,CAAC,GAAG,GAAG,aAAa,MAAM,MAAM,CAAC,CAAC;AAAA,MAC9G,CAAC,GAAG;AAAA,QACA,QAAQ;AAAA,QAAK,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,MAC/D,CAAC;AAAA,IACL,OAAO;AACH,cAAQ,IAAI,4CAA4C;AACxD,aAAO,IAAI,SAAS,KAAK,UAAU;AAAA,QAC/B,SAAS;AAAA,QACT,SAAS;AAAA,QACT,GAAG,OAAO,YAAY,OAAO,QAAQ,WAAW,EAAE,IAAI,CAAC,CAAC,KAAK,KAAK,MAAM,CAAC,GAAG,GAAG,aAAa,MAAM,MAAM,CAAC,CAAC;AAAA,MAC9G,CAAC,GAAG;AAAA,QACA,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,MAClD,CAAC;AAAA,IACL;AAAA,EACJ,SAAS,OAAO;AACZ,YAAQ,MAAM,kCAAkC,KAAK;AACrD,WAAO,IAAI,SAAS,KAAK,UAAU,EAAE,SAAS,OAAO,SAAS,uDAAuD,OAAO,MAAM,SAAS,SAAS,MAAM,MAAM,CAAC,GAAG;AAAA,MAChK,QAAQ;AAAA,MAAK,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,IAC/D,CAAC;AAAA,EACL;AACJ;AAxEsB;;;ACAtB,eAAsB,iBAAiB,SAAS,KAAK;AACjD,QAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,QAAM,YAAY,IAAI,aAAa,IAAI,MAAM;AAC7C,QAAM,UAAU,YAAY,YAAY,WAAW;AACnD,UAAQ,IAAI,6BAA6B,OAAO,EAAE;AAClD,MAAI;AACA,UAAM,eAAe;AAAA,MACjB,MAAM;AAAA,MACN,SAAS,mCAAmC,OAAO;AAAA,IACvD;AAEA,UAAM,gBAAgB,CAAC;AACvB,eAAW,cAAc,aAAa;AAClC,UAAI,OAAO,eAAe,KAAK,aAAa,UAAU,GAAG;AACrD,sBAAc;AAAA,UACV,UAAU,IAAI,SAAS,GAAG,OAAO,IAAI,UAAU,EAAE,EAAE,KAAK,UAAQ;AAC5D,yBAAa,UAAU,IAAI,QAAQ,CAAC;AAAA,UACxC,CAAC;AAAA,QACL;AAAA,MACJ;AAAA,IACJ;AACA,UAAM,QAAQ,WAAW,aAAa;AAEtC,WAAO,IAAI,SAAS,KAAK,UAAU,YAAY,GAAG,EAAE,SAAS,EAAE,gBAAgB,mBAAmB,EAAE,CAAC;AAAA,EACzG,SAAS,OAAO;AACZ,YAAQ,MAAM,yBAAyB,KAAK;AAC5C,WAAO,IAAI,SAAS,KAAK,UAAU,EAAE,SAAS,OAAO,SAAS,0BAA0B,OAAO,MAAM,SAAS,MAAM,QAAQ,CAAC,GAAG;AAAA,MAC5H,QAAQ;AAAA,MAAK,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,IAC/D,CAAC;AAAA,EACL;AACJ;AA9BsB;;;ACQtB,SAAS,eAAe;AACtB,SAAO;AAAA,IACL,OAAO;AAAA,IACP,QAAQ;AAAA,IACR,YAAY;AAAA,IACZ,KAAK;AAAA,IACL,OAAO;AAAA,IACP,UAAU;AAAA,IACV,UAAU;AAAA,IACV,QAAQ;AAAA,IACR,WAAW;AAAA,IACX,YAAY;AAAA,EACd;AACF;AAbS;AAcT,IAAI,YAAY,aAAa;AAC7B,SAAS,eAAe,aAAa;AACnC,cAAY;AACd;AAFS;AAKT,IAAI,WAAW,EAAE,MAAM,6BAAM,MAAN,QAAW;AAClC,SAAS,KAAK,OAAO,MAAM,IAAI;AAC7B,MAAI,SAAS,OAAO,UAAU,WAAW,QAAQ,MAAM;AACvD,QAAM,MAAM;AAAA,IACV,SAAS,wBAAC,MAAM,QAAQ;AACtB,UAAI,YAAY,OAAO,QAAQ,WAAW,MAAM,IAAI;AACpD,kBAAY,UAAU,QAAQ,MAAM,OAAO,IAAI;AAC/C,eAAS,OAAO,QAAQ,MAAM,SAAS;AACvC,aAAO;AAAA,IACT,GALS;AAAA,IAMT,UAAU,6BAAM;AACd,aAAO,IAAI,OAAO,QAAQ,GAAG;AAAA,IAC/B,GAFU;AAAA,EAGZ;AACA,SAAO;AACT;AAdS;AAeT,IAAI,QAAQ;AAAA,EACV,kBAAkB;AAAA,EAClB,mBAAmB;AAAA,EACnB,wBAAwB;AAAA,EACxB,gBAAgB;AAAA,EAChB,YAAY;AAAA,EACZ,mBAAmB;AAAA,EACnB,iBAAiB;AAAA,EACjB,cAAc;AAAA,EACd,mBAAmB;AAAA,EACnB,eAAe;AAAA,EACf,qBAAqB;AAAA,EACrB,WAAW;AAAA,EACX,iBAAiB;AAAA,EACjB,iBAAiB;AAAA,EACjB,yBAAyB;AAAA,EACzB,0BAA0B;AAAA,EAC1B,iBAAiB;AAAA,EACjB,oBAAoB;AAAA,EACpB,YAAY;AAAA,EACZ,iBAAiB;AAAA,EACjB,SAAS;AAAA,EACT,cAAc;AAAA,EACd,gBAAgB;AAAA,EAChB,iBAAiB;AAAA,EACjB,mBAAmB;AAAA,EACnB,iBAAiB;AAAA,EACjB,kBAAkB;AAAA,EAClB,gBAAgB;AAAA,EAChB,WAAW;AAAA,EACX,SAAS;AAAA,EACT,mBAAmB;AAAA,EACnB,iBAAiB;AAAA,EACjB,mBAAmB;AAAA,EACnB,iBAAiB;AAAA,EACjB,mBAAmB;AAAA,EACnB,qBAAqB;AAAA,EACrB,YAAY;AAAA,EACZ,eAAe;AAAA,EACf,oBAAoB;AAAA,EACpB,uBAAuB;AAAA,EACvB,cAAc;AAAA,EACd,OAAO;AAAA,EACP,eAAe;AAAA,EACf,UAAU;AAAA,EACV,WAAW;AAAA,EACX,WAAW;AAAA,EACX,gBAAgB;AAAA,EAChB,WAAW;AAAA,EACX,eAAe;AAAA,EACf,eAAe;AAAA,EACf,eAAe,wBAAC,SAAS,IAAI,OAAO,WAAW,IAAI,8BAA8B,GAAlE;AAAA,EACf,iBAAiB,wBAAC,WAAW,IAAI,OAAO,QAAQ,KAAK,IAAI,GAAG,SAAS,CAAC,CAAC,oDAAoD,GAA1G;AAAA,EACjB,SAAS,wBAAC,WAAW,IAAI,OAAO,QAAQ,KAAK,IAAI,GAAG,SAAS,CAAC,CAAC,oDAAoD,GAA1G;AAAA,EACT,kBAAkB,wBAAC,WAAW,IAAI,OAAO,QAAQ,KAAK,IAAI,GAAG,SAAS,CAAC,CAAC,iBAAiB,GAAvE;AAAA,EAClB,mBAAmB,wBAAC,WAAW,IAAI,OAAO,QAAQ,KAAK,IAAI,GAAG,SAAS,CAAC,CAAC,IAAI,GAA1D;AAAA,EACnB,gBAAgB,wBAAC,WAAW,IAAI,OAAO,QAAQ,KAAK,IAAI,GAAG,SAAS,CAAC,CAAC,sBAAsB,GAAG,GAA/E;AAClB;AACA,IAAI,UAAU;AACd,IAAI,YAAY;AAChB,IAAI,SAAS;AACb,IAAI,KAAK;AACT,IAAI,UAAU;AACd,IAAI,SAAS;AACb,IAAI,eAAe;AACnB,IAAI,WAAW,KAAK,YAAY,EAAE,QAAQ,SAAS,MAAM,EAAE,QAAQ,cAAc,mBAAmB,EAAE,QAAQ,WAAW,uBAAuB,EAAE,QAAQ,eAAe,SAAS,EAAE,QAAQ,YAAY,cAAc,EAAE,QAAQ,SAAS,mBAAmB,EAAE,QAAQ,YAAY,EAAE,EAAE,SAAS;AAC/R,IAAI,cAAc,KAAK,YAAY,EAAE,QAAQ,SAAS,MAAM,EAAE,QAAQ,cAAc,mBAAmB,EAAE,QAAQ,WAAW,uBAAuB,EAAE,QAAQ,eAAe,SAAS,EAAE,QAAQ,YAAY,cAAc,EAAE,QAAQ,SAAS,mBAAmB,EAAE,QAAQ,UAAU,mCAAmC,EAAE,SAAS;AACjU,IAAI,aAAa;AACjB,IAAI,YAAY;AAChB,IAAI,cAAc;AAClB,IAAI,MAAM,KAAK,6GAA6G,EAAE,QAAQ,SAAS,WAAW,EAAE,QAAQ,SAAS,8DAA8D,EAAE,SAAS;AACtP,IAAI,OAAO,KAAK,sCAAsC,EAAE,QAAQ,SAAS,MAAM,EAAE,SAAS;AAC1F,IAAI,OAAO;AACX,IAAI,WAAW;AACf,IAAI,OAAO;AAAA,EACT;AAAA,EACA;AACF,EAAE,QAAQ,WAAW,QAAQ,EAAE,QAAQ,OAAO,IAAI,EAAE,QAAQ,aAAa,0EAA0E,EAAE,SAAS;AAC9J,IAAI,YAAY,KAAK,UAAU,EAAE,QAAQ,MAAM,EAAE,EAAE,QAAQ,WAAW,uBAAuB,EAAE,QAAQ,aAAa,EAAE,EAAE,QAAQ,UAAU,EAAE,EAAE,QAAQ,cAAc,SAAS,EAAE,QAAQ,UAAU,gDAAgD,EAAE,QAAQ,QAAQ,wBAAwB,EAAE,QAAQ,QAAQ,6DAA6D,EAAE,QAAQ,OAAO,IAAI,EAAE,SAAS;AAC1Y,IAAI,aAAa,KAAK,yCAAyC,EAAE,QAAQ,aAAa,SAAS,EAAE,SAAS;AAC1G,IAAI,cAAc;AAAA,EAChB;AAAA,EACA,MAAM;AAAA,EACN;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,OAAO;AAAA,EACP,MAAM;AACR;AACA,IAAI,WAAW;AAAA,EACb;AACF,EAAE,QAAQ,MAAM,EAAE,EAAE,QAAQ,WAAW,uBAAuB,EAAE,QAAQ,cAAc,SAAS,EAAE,QAAQ,QAAQ,wBAAwB,EAAE,QAAQ,UAAU,gDAAgD,EAAE,QAAQ,QAAQ,wBAAwB,EAAE,QAAQ,QAAQ,6DAA6D,EAAE,QAAQ,OAAO,IAAI,EAAE,SAAS;AACtW,IAAI,WAAW;AAAA,EACb,GAAG;AAAA,EACH,UAAU;AAAA,EACV,OAAO;AAAA,EACP,WAAW,KAAK,UAAU,EAAE,QAAQ,MAAM,EAAE,EAAE,QAAQ,WAAW,uBAAuB,EAAE,QAAQ,aAAa,EAAE,EAAE,QAAQ,SAAS,QAAQ,EAAE,QAAQ,cAAc,SAAS,EAAE,QAAQ,UAAU,gDAAgD,EAAE,QAAQ,QAAQ,wBAAwB,EAAE,QAAQ,QAAQ,6DAA6D,EAAE,QAAQ,OAAO,IAAI,EAAE,SAAS;AAC5Y;AACA,IAAI,gBAAgB;AAAA,EAClB,GAAG;AAAA,EACH,MAAM;AAAA,IACJ;AAAA,EACF,EAAE,QAAQ,WAAW,QAAQ,EAAE,QAAQ,QAAQ,mKAAmK,EAAE,SAAS;AAAA,EAC7N,KAAK;AAAA,EACL,SAAS;AAAA,EACT,QAAQ;AAAA;AAAA,EAER,UAAU;AAAA,EACV,WAAW,KAAK,UAAU,EAAE,QAAQ,MAAM,EAAE,EAAE,QAAQ,WAAW,iBAAiB,EAAE,QAAQ,YAAY,QAAQ,EAAE,QAAQ,UAAU,EAAE,EAAE,QAAQ,cAAc,SAAS,EAAE,QAAQ,WAAW,EAAE,EAAE,QAAQ,SAAS,EAAE,EAAE,QAAQ,SAAS,EAAE,EAAE,QAAQ,QAAQ,EAAE,EAAE,SAAS;AACzQ;AACA,IAAI,SAAS;AACb,IAAI,aAAa;AACjB,IAAI,KAAK;AACT,IAAI,aAAa;AACjB,IAAI,eAAe;AACnB,IAAI,sBAAsB;AAC1B,IAAI,yBAAyB;AAC7B,IAAI,cAAc,KAAK,yBAAyB,GAAG,EAAE,QAAQ,eAAe,mBAAmB,EAAE,SAAS;AAC1G,IAAI,0BAA0B;AAC9B,IAAI,iCAAiC;AACrC,IAAI,oCAAoC;AACxC,IAAI,YAAY;AAChB,IAAI,qBAAqB;AACzB,IAAI,iBAAiB,KAAK,oBAAoB,GAAG,EAAE,QAAQ,UAAU,YAAY,EAAE,SAAS;AAC5F,IAAI,oBAAoB,KAAK,oBAAoB,GAAG,EAAE,QAAQ,UAAU,uBAAuB,EAAE,SAAS;AAC1G,IAAI,wBAAwB;AAC5B,IAAI,oBAAoB,KAAK,uBAAuB,IAAI,EAAE,QAAQ,kBAAkB,sBAAsB,EAAE,QAAQ,eAAe,mBAAmB,EAAE,QAAQ,UAAU,YAAY,EAAE,SAAS;AACjM,IAAI,uBAAuB,KAAK,uBAAuB,IAAI,EAAE,QAAQ,kBAAkB,iCAAiC,EAAE,QAAQ,eAAe,8BAA8B,EAAE,QAAQ,UAAU,uBAAuB,EAAE,SAAS;AACrO,IAAI,oBAAoB;AAAA,EACtB;AAAA,EACA;AACF,EAAE,QAAQ,kBAAkB,sBAAsB,EAAE,QAAQ,eAAe,mBAAmB,EAAE,QAAQ,UAAU,YAAY,EAAE,SAAS;AACzI,IAAI,iBAAiB,KAAK,aAAa,IAAI,EAAE,QAAQ,UAAU,YAAY,EAAE,SAAS;AACtF,IAAI,WAAW,KAAK,qCAAqC,EAAE,QAAQ,UAAU,8BAA8B,EAAE,QAAQ,SAAS,8IAA8I,EAAE,SAAS;AACvR,IAAI,iBAAiB,KAAK,QAAQ,EAAE,QAAQ,aAAa,KAAK,EAAE,SAAS;AACzE,IAAI,MAAM;AAAA,EACR;AACF,EAAE,QAAQ,WAAW,cAAc,EAAE,QAAQ,aAAa,6EAA6E,EAAE,SAAS;AAClJ,IAAI,eAAe;AACnB,IAAI,OAAO,KAAK,mEAAmE,EAAE,QAAQ,SAAS,YAAY,EAAE,QAAQ,QAAQ,yCAAyC,EAAE,QAAQ,SAAS,6DAA6D,EAAE,SAAS;AACxQ,IAAI,UAAU,KAAK,yBAAyB,EAAE,QAAQ,SAAS,YAAY,EAAE,QAAQ,OAAO,WAAW,EAAE,SAAS;AAClH,IAAI,SAAS,KAAK,uBAAuB,EAAE,QAAQ,OAAO,WAAW,EAAE,SAAS;AAChF,IAAI,gBAAgB,KAAK,yBAAyB,GAAG,EAAE,QAAQ,WAAW,OAAO,EAAE,QAAQ,UAAU,MAAM,EAAE,SAAS;AACtH,IAAI,eAAe;AAAA,EACjB,YAAY;AAAA;AAAA,EAEZ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,MAAM;AAAA,EACN,KAAK;AAAA,EACL;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,MAAM;AAAA,EACN,KAAK;AACP;AACA,IAAI,iBAAiB;AAAA,EACnB,GAAG;AAAA,EACH,MAAM,KAAK,yBAAyB,EAAE,QAAQ,SAAS,YAAY,EAAE,SAAS;AAAA,EAC9E,SAAS,KAAK,+BAA+B,EAAE,QAAQ,SAAS,YAAY,EAAE,SAAS;AACzF;AACA,IAAI,YAAY;AAAA,EACd,GAAG;AAAA,EACH,mBAAmB;AAAA,EACnB,gBAAgB;AAAA,EAChB,KAAK,KAAK,oEAAoE,GAAG,EAAE,QAAQ,SAAS,2EAA2E,EAAE,SAAS;AAAA,EAC1L,YAAY;AAAA,EACZ,KAAK;AAAA,EACL,MAAM;AACR;AACA,IAAI,eAAe;AAAA,EACjB,GAAG;AAAA,EACH,IAAI,KAAK,EAAE,EAAE,QAAQ,QAAQ,GAAG,EAAE,SAAS;AAAA,EAC3C,MAAM,KAAK,UAAU,IAAI,EAAE,QAAQ,QAAQ,eAAe,EAAE,QAAQ,WAAW,GAAG,EAAE,SAAS;AAC/F;AACA,IAAI,QAAQ;AAAA,EACV,QAAQ;AAAA,EACR,KAAK;AAAA,EACL,UAAU;AACZ;AACA,IAAI,SAAS;AAAA,EACX,QAAQ;AAAA,EACR,KAAK;AAAA,EACL,QAAQ;AAAA,EACR,UAAU;AACZ;AAGA,IAAI,qBAAqB;AAAA,EACvB,KAAK;AAAA,EACL,KAAK;AAAA,EACL,KAAK;AAAA,EACL,KAAK;AAAA,EACL,KAAK;AACP;AACA,IAAI,uBAAuB,wBAAC,OAAO,mBAAmB,EAAE,GAA7B;AAC3B,SAAS,QAAQ,OAAO,QAAQ;AAC9B,MAAI,QAAQ;AACV,QAAI,MAAM,WAAW,KAAK,KAAK,GAAG;AAChC,aAAO,MAAM,QAAQ,MAAM,eAAe,oBAAoB;AAAA,IAChE;AAAA,EACF,OAAO;AACL,QAAI,MAAM,mBAAmB,KAAK,KAAK,GAAG;AACxC,aAAO,MAAM,QAAQ,MAAM,uBAAuB,oBAAoB;AAAA,IACxE;AAAA,EACF;AACA,SAAO;AACT;AAXS;AAYT,SAAS,SAAS,MAAM;AACtB,MAAI;AACF,WAAO,UAAU,IAAI,EAAE,QAAQ,MAAM,eAAe,GAAG;AAAA,EACzD,QAAQ;AACN,WAAO;AAAA,EACT;AACA,SAAO;AACT;AAPS;AAQT,SAAS,WAAW,UAAU,OAAO;AACnC,QAAM,MAAM,SAAS,QAAQ,MAAM,UAAU,CAAC,OAAO,QAAQ,QAAQ;AACnE,QAAI,UAAU;AACd,QAAI,OAAO;AACX,WAAO,EAAE,QAAQ,KAAK,IAAI,IAAI,MAAM,KAAM,WAAU,CAAC;AACrD,QAAI,SAAS;AACX,aAAO;AAAA,IACT,OAAO;AACL,aAAO;AAAA,IACT;AAAA,EACF,CAAC,GAAG,QAAQ,IAAI,MAAM,MAAM,SAAS;AACrC,MAAI,IAAI;AACR,MAAI,CAAC,MAAM,CAAC,EAAE,KAAK,GAAG;AACpB,UAAM,MAAM;AAAA,EACd;AACA,MAAI,MAAM,SAAS,KAAK,CAAC,MAAM,GAAG,EAAE,GAAG,KAAK,GAAG;AAC7C,UAAM,IAAI;AAAA,EACZ;AACA,MAAI,OAAO;AACT,QAAI,MAAM,SAAS,OAAO;AACxB,YAAM,OAAO,KAAK;AAAA,IACpB,OAAO;AACL,aAAO,MAAM,SAAS,MAAO,OAAM,KAAK,EAAE;AAAA,IAC5C;AAAA,EACF;AACA,SAAO,IAAI,MAAM,QAAQ,KAAK;AAC5B,UAAM,CAAC,IAAI,MAAM,CAAC,EAAE,KAAK,EAAE,QAAQ,MAAM,WAAW,GAAG;AAAA,EACzD;AACA,SAAO;AACT;AA7BS;AA8BT,SAAS,MAAM,KAAK,GAAG,QAAQ;AAC7B,QAAM,IAAI,IAAI;AACd,MAAI,MAAM,GAAG;AACX,WAAO;AAAA,EACT;AACA,MAAI,UAAU;AACd,SAAO,UAAU,GAAG;AAClB,UAAM,WAAW,IAAI,OAAO,IAAI,UAAU,CAAC;AAC3C,QAAI,aAAa,KAAK,CAAC,QAAQ;AAC7B;AAAA,IACF,WAAW,aAAa,KAAK,QAAQ;AACnC;AAAA,IACF,OAAO;AACL;AAAA,IACF;AAAA,EACF;AACA,SAAO,IAAI,MAAM,GAAG,IAAI,OAAO;AACjC;AAjBS;AAkBT,SAAS,mBAAmB,KAAK,GAAG;AAClC,MAAI,IAAI,QAAQ,EAAE,CAAC,CAAC,MAAM,IAAI;AAC5B,WAAO;AAAA,EACT;AACA,MAAI,QAAQ;AACZ,WAAS,IAAI,GAAG,IAAI,IAAI,QAAQ,KAAK;AACnC,QAAI,IAAI,CAAC,MAAM,MAAM;AACnB;AAAA,IACF,WAAW,IAAI,CAAC,MAAM,EAAE,CAAC,GAAG;AAC1B;AAAA,IACF,WAAW,IAAI,CAAC,MAAM,EAAE,CAAC,GAAG;AAC1B;AACA,UAAI,QAAQ,GAAG;AACb,eAAO;AAAA,MACT;AAAA,IACF;AAAA,EACF;AACA,MAAI,QAAQ,GAAG;AACb,WAAO;AAAA,EACT;AACA,SAAO;AACT;AArBS;AAwBT,SAAS,WAAW,KAAK,OAAO,KAAK,QAAQ,OAAO;AAClD,QAAM,OAAO,MAAM;AACnB,QAAM,QAAQ,MAAM,SAAS;AAC7B,QAAM,OAAO,IAAI,CAAC,EAAE,QAAQ,MAAM,MAAM,mBAAmB,IAAI;AAC/D,SAAO,MAAM,SAAS;AACtB,QAAM,QAAQ;AAAA,IACZ,MAAM,IAAI,CAAC,EAAE,OAAO,CAAC,MAAM,MAAM,UAAU;AAAA,IAC3C;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,QAAQ,OAAO,aAAa,IAAI;AAAA,EAClC;AACA,SAAO,MAAM,SAAS;AACtB,SAAO;AACT;AAfS;AAgBT,SAAS,uBAAuB,KAAK,MAAM,OAAO;AAChD,QAAM,oBAAoB,IAAI,MAAM,MAAM,MAAM,sBAAsB;AACtE,MAAI,sBAAsB,MAAM;AAC9B,WAAO;AAAA,EACT;AACA,QAAM,eAAe,kBAAkB,CAAC;AACxC,SAAO,KAAK,MAAM,IAAI,EAAE,IAAI,CAAC,SAAS;AACpC,UAAM,oBAAoB,KAAK,MAAM,MAAM,MAAM,cAAc;AAC/D,QAAI,sBAAsB,MAAM;AAC9B,aAAO;AAAA,IACT;AACA,UAAM,CAAC,YAAY,IAAI;AACvB,QAAI,aAAa,UAAU,aAAa,QAAQ;AAC9C,aAAO,KAAK,MAAM,aAAa,MAAM;AAAA,IACvC;AACA,WAAO;AAAA,EACT,CAAC,EAAE,KAAK,IAAI;AACd;AAjBS;AAkBT,IAAI,aAAa,MAAM;AAAA,EAlYvB,OAkYuB;AAAA;AAAA;AAAA,EACrB;AAAA,EACA;AAAA;AAAA,EAEA;AAAA;AAAA,EAEA,YAAY,UAAU;AACpB,SAAK,UAAU,YAAY;AAAA,EAC7B;AAAA,EACA,MAAM,KAAK;AACT,UAAM,MAAM,KAAK,MAAM,MAAM,QAAQ,KAAK,GAAG;AAC7C,QAAI,OAAO,IAAI,CAAC,EAAE,SAAS,GAAG;AAC5B,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,MACZ;AAAA,IACF;AAAA,EACF;AAAA,EACA,KAAK,KAAK;AACR,UAAM,MAAM,KAAK,MAAM,MAAM,KAAK,KAAK,GAAG;AAC1C,QAAI,KAAK;AACP,YAAM,OAAO,IAAI,CAAC,EAAE,QAAQ,KAAK,MAAM,MAAM,kBAAkB,EAAE;AACjE,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,QACV,gBAAgB;AAAA,QAChB,MAAM,CAAC,KAAK,QAAQ,WAAW,MAAM,MAAM,IAAI,IAAI;AAAA,MACrD;AAAA,IACF;AAAA,EACF;AAAA,EACA,OAAO,KAAK;AACV,UAAM,MAAM,KAAK,MAAM,MAAM,OAAO,KAAK,GAAG;AAC5C,QAAI,KAAK;AACP,YAAM,MAAM,IAAI,CAAC;AACjB,YAAM,OAAO,uBAAuB,KAAK,IAAI,CAAC,KAAK,IAAI,KAAK,KAAK;AACjE,aAAO;AAAA,QACL,MAAM;AAAA,QACN;AAAA,QACA,MAAM,IAAI,CAAC,IAAI,IAAI,CAAC,EAAE,KAAK,EAAE,QAAQ,KAAK,MAAM,OAAO,gBAAgB,IAAI,IAAI,IAAI,CAAC;AAAA,QACpF;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,EACA,QAAQ,KAAK;AACX,UAAM,MAAM,KAAK,MAAM,MAAM,QAAQ,KAAK,GAAG;AAC7C,QAAI,KAAK;AACP,UAAI,OAAO,IAAI,CAAC,EAAE,KAAK;AACvB,UAAI,KAAK,MAAM,MAAM,WAAW,KAAK,IAAI,GAAG;AAC1C,cAAM,UAAU,MAAM,MAAM,GAAG;AAC/B,YAAI,KAAK,QAAQ,UAAU;AACzB,iBAAO,QAAQ,KAAK;AAAA,QACtB,WAAW,CAAC,WAAW,KAAK,MAAM,MAAM,gBAAgB,KAAK,OAAO,GAAG;AACrE,iBAAO,QAAQ,KAAK;AAAA,QACtB;AAAA,MACF;AACA,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,QACV,OAAO,IAAI,CAAC,EAAE;AAAA,QACd;AAAA,QACA,QAAQ,KAAK,MAAM,OAAO,IAAI;AAAA,MAChC;AAAA,IACF;AAAA,EACF;AAAA,EACA,GAAG,KAAK;AACN,UAAM,MAAM,KAAK,MAAM,MAAM,GAAG,KAAK,GAAG;AACxC,QAAI,KAAK;AACP,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,MAAM,IAAI,CAAC,GAAG,IAAI;AAAA,MACzB;AAAA,IACF;AAAA,EACF;AAAA,EACA,WAAW,KAAK;AACd,UAAM,MAAM,KAAK,MAAM,MAAM,WAAW,KAAK,GAAG;AAChD,QAAI,KAAK;AACP,UAAI,QAAQ,MAAM,IAAI,CAAC,GAAG,IAAI,EAAE,MAAM,IAAI;AAC1C,UAAI,MAAM;AACV,UAAI,OAAO;AACX,YAAM,SAAS,CAAC;AAChB,aAAO,MAAM,SAAS,GAAG;AACvB,YAAI,eAAe;AACnB,cAAM,eAAe,CAAC;AACtB,YAAI;AACJ,aAAK,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACjC,cAAI,KAAK,MAAM,MAAM,gBAAgB,KAAK,MAAM,CAAC,CAAC,GAAG;AACnD,yBAAa,KAAK,MAAM,CAAC,CAAC;AAC1B,2BAAe;AAAA,UACjB,WAAW,CAAC,cAAc;AACxB,yBAAa,KAAK,MAAM,CAAC,CAAC;AAAA,UAC5B,OAAO;AACL;AAAA,UACF;AAAA,QACF;AACA,gBAAQ,MAAM,MAAM,CAAC;AACrB,cAAM,aAAa,aAAa,KAAK,IAAI;AACzC,cAAM,cAAc,WAAW,QAAQ,KAAK,MAAM,MAAM,yBAAyB,UAAU,EAAE,QAAQ,KAAK,MAAM,MAAM,0BAA0B,EAAE;AAClJ,cAAM,MAAM,GAAG,GAAG;AAAA,EACxB,UAAU,KAAK;AACT,eAAO,OAAO,GAAG,IAAI;AAAA,EAC3B,WAAW,KAAK;AACV,cAAM,MAAM,KAAK,MAAM,MAAM;AAC7B,aAAK,MAAM,MAAM,MAAM;AACvB,aAAK,MAAM,YAAY,aAAa,QAAQ,IAAI;AAChD,aAAK,MAAM,MAAM,MAAM;AACvB,YAAI,MAAM,WAAW,GAAG;AACtB;AAAA,QACF;AACA,cAAM,YAAY,OAAO,GAAG,EAAE;AAC9B,YAAI,WAAW,SAAS,QAAQ;AAC9B;AAAA,QACF,WAAW,WAAW,SAAS,cAAc;AAC3C,gBAAM,WAAW;AACjB,gBAAM,UAAU,SAAS,MAAM,OAAO,MAAM,KAAK,IAAI;AACrD,gBAAM,WAAW,KAAK,WAAW,OAAO;AACxC,iBAAO,OAAO,SAAS,CAAC,IAAI;AAC5B,gBAAM,IAAI,UAAU,GAAG,IAAI,SAAS,SAAS,IAAI,MAAM,IAAI,SAAS;AACpE,iBAAO,KAAK,UAAU,GAAG,KAAK,SAAS,SAAS,KAAK,MAAM,IAAI,SAAS;AACxE;AAAA,QACF,WAAW,WAAW,SAAS,QAAQ;AACrC,gBAAM,WAAW;AACjB,gBAAM,UAAU,SAAS,MAAM,OAAO,MAAM,KAAK,IAAI;AACrD,gBAAM,WAAW,KAAK,KAAK,OAAO;AAClC,iBAAO,OAAO,SAAS,CAAC,IAAI;AAC5B,gBAAM,IAAI,UAAU,GAAG,IAAI,SAAS,UAAU,IAAI,MAAM,IAAI,SAAS;AACrE,iBAAO,KAAK,UAAU,GAAG,KAAK,SAAS,SAAS,IAAI,MAAM,IAAI,SAAS;AACvE,kBAAQ,QAAQ,UAAU,OAAO,GAAG,EAAE,EAAE,IAAI,MAAM,EAAE,MAAM,IAAI;AAC9D;AAAA,QACF;AAAA,MACF;AACA,aAAO;AAAA,QACL,MAAM;AAAA,QACN;AAAA,QACA;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,EACA,KAAK,KAAK;AACR,QAAI,MAAM,KAAK,MAAM,MAAM,KAAK,KAAK,GAAG;AACxC,QAAI,KAAK;AACP,UAAI,OAAO,IAAI,CAAC,EAAE,KAAK;AACvB,YAAM,YAAY,KAAK,SAAS;AAChC,YAAM,QAAQ;AAAA,QACZ,MAAM;AAAA,QACN,KAAK;AAAA,QACL,SAAS;AAAA,QACT,OAAO,YAAY,CAAC,KAAK,MAAM,GAAG,EAAE,IAAI;AAAA,QACxC,OAAO;AAAA,QACP,OAAO,CAAC;AAAA,MACV;AACA,aAAO,YAAY,aAAa,KAAK,MAAM,EAAE,CAAC,KAAK,KAAK,IAAI;AAC5D,UAAI,KAAK,QAAQ,UAAU;AACzB,eAAO,YAAY,OAAO;AAAA,MAC5B;AACA,YAAM,YAAY,KAAK,MAAM,MAAM,cAAc,IAAI;AACrD,UAAI,oBAAoB;AACxB,aAAO,KAAK;AACV,YAAI,WAAW;AACf,YAAI,MAAM;AACV,YAAI,eAAe;AACnB,YAAI,EAAE,MAAM,UAAU,KAAK,GAAG,IAAI;AAChC;AAAA,QACF;AACA,YAAI,KAAK,MAAM,MAAM,GAAG,KAAK,GAAG,GAAG;AACjC;AAAA,QACF;AACA,cAAM,IAAI,CAAC;AACX,cAAM,IAAI,UAAU,IAAI,MAAM;AAC9B,YAAI,OAAO,IAAI,CAAC,EAAE,MAAM,MAAM,CAAC,EAAE,CAAC,EAAE,QAAQ,KAAK,MAAM,MAAM,iBAAiB,CAAC,MAAM,IAAI,OAAO,IAAI,EAAE,MAAM,CAAC;AAC7G,YAAI,WAAW,IAAI,MAAM,MAAM,CAAC,EAAE,CAAC;AACnC,YAAI,YAAY,CAAC,KAAK,KAAK;AAC3B,YAAI,SAAS;AACb,YAAI,KAAK,QAAQ,UAAU;AACzB,mBAAS;AACT,yBAAe,KAAK,UAAU;AAAA,QAChC,WAAW,WAAW;AACpB,mBAAS,IAAI,CAAC,EAAE,SAAS;AAAA,QAC3B,OAAO;AACL,mBAAS,IAAI,CAAC,EAAE,OAAO,KAAK,MAAM,MAAM,YAAY;AACpD,mBAAS,SAAS,IAAI,IAAI;AAC1B,yBAAe,KAAK,MAAM,MAAM;AAChC,oBAAU,IAAI,CAAC,EAAE;AAAA,QACnB;AACA,YAAI,aAAa,KAAK,MAAM,MAAM,UAAU,KAAK,QAAQ,GAAG;AAC1D,iBAAO,WAAW;AAClB,gBAAM,IAAI,UAAU,SAAS,SAAS,CAAC;AACvC,qBAAW;AAAA,QACb;AACA,YAAI,CAAC,UAAU;AACb,gBAAM,kBAAkB,KAAK,MAAM,MAAM,gBAAgB,MAAM;AAC/D,gBAAM,UAAU,KAAK,MAAM,MAAM,QAAQ,MAAM;AAC/C,gBAAM,mBAAmB,KAAK,MAAM,MAAM,iBAAiB,MAAM;AACjE,gBAAM,oBAAoB,KAAK,MAAM,MAAM,kBAAkB,MAAM;AACnE,gBAAM,iBAAiB,KAAK,MAAM,MAAM,eAAe,MAAM;AAC7D,iBAAO,KAAK;AACV,kBAAM,UAAU,IAAI,MAAM,MAAM,CAAC,EAAE,CAAC;AACpC,gBAAI;AACJ,uBAAW;AACX,gBAAI,KAAK,QAAQ,UAAU;AACzB,yBAAW,SAAS,QAAQ,KAAK,MAAM,MAAM,oBAAoB,IAAI;AACrE,oCAAsB;AAAA,YACxB,OAAO;AACL,oCAAsB,SAAS,QAAQ,KAAK,MAAM,MAAM,eAAe,MAAM;AAAA,YAC/E;AACA,gBAAI,iBAAiB,KAAK,QAAQ,GAAG;AACnC;AAAA,YACF;AACA,gBAAI,kBAAkB,KAAK,QAAQ,GAAG;AACpC;AAAA,YACF;AACA,gBAAI,eAAe,KAAK,QAAQ,GAAG;AACjC;AAAA,YACF;AACA,gBAAI,gBAAgB,KAAK,QAAQ,GAAG;AAClC;AAAA,YACF;AACA,gBAAI,QAAQ,KAAK,QAAQ,GAAG;AAC1B;AAAA,YACF;AACA,gBAAI,oBAAoB,OAAO,KAAK,MAAM,MAAM,YAAY,KAAK,UAAU,CAAC,SAAS,KAAK,GAAG;AAC3F,8BAAgB,OAAO,oBAAoB,MAAM,MAAM;AAAA,YACzD,OAAO;AACL,kBAAI,WAAW;AACb;AAAA,cACF;AACA,kBAAI,KAAK,QAAQ,KAAK,MAAM,MAAM,eAAe,MAAM,EAAE,OAAO,KAAK,MAAM,MAAM,YAAY,KAAK,GAAG;AACnG;AAAA,cACF;AACA,kBAAI,iBAAiB,KAAK,IAAI,GAAG;AAC/B;AAAA,cACF;AACA,kBAAI,kBAAkB,KAAK,IAAI,GAAG;AAChC;AAAA,cACF;AACA,kBAAI,QAAQ,KAAK,IAAI,GAAG;AACtB;AAAA,cACF;AACA,8BAAgB,OAAO;AAAA,YACzB;AACA,gBAAI,CAAC,aAAa,CAAC,SAAS,KAAK,GAAG;AAClC,0BAAY;AAAA,YACd;AACA,mBAAO,UAAU;AACjB,kBAAM,IAAI,UAAU,QAAQ,SAAS,CAAC;AACtC,mBAAO,oBAAoB,MAAM,MAAM;AAAA,UACzC;AAAA,QACF;AACA,YAAI,CAAC,MAAM,OAAO;AAChB,cAAI,mBAAmB;AACrB,kBAAM,QAAQ;AAAA,UAChB,WAAW,KAAK,MAAM,MAAM,gBAAgB,KAAK,GAAG,GAAG;AACrD,gCAAoB;AAAA,UACtB;AAAA,QACF;AACA,YAAI,SAAS;AACb,YAAI;AACJ,YAAI,KAAK,QAAQ,KAAK;AACpB,mBAAS,KAAK,MAAM,MAAM,WAAW,KAAK,YAAY;AACtD,cAAI,QAAQ;AACV,wBAAY,OAAO,CAAC,MAAM;AAC1B,2BAAe,aAAa,QAAQ,KAAK,MAAM,MAAM,iBAAiB,EAAE;AAAA,UAC1E;AAAA,QACF;AACA,cAAM,MAAM,KAAK;AAAA,UACf,MAAM;AAAA,UACN;AAAA,UACA,MAAM,CAAC,CAAC;AAAA,UACR,SAAS;AAAA,UACT,OAAO;AAAA,UACP,MAAM;AAAA,UACN,QAAQ,CAAC;AAAA,QACX,CAAC;AACD,cAAM,OAAO;AAAA,MACf;AACA,YAAM,WAAW,MAAM,MAAM,GAAG,EAAE;AAClC,UAAI,UAAU;AACZ,iBAAS,MAAM,SAAS,IAAI,QAAQ;AACpC,iBAAS,OAAO,SAAS,KAAK,QAAQ;AAAA,MACxC,OAAO;AACL;AAAA,MACF;AACA,YAAM,MAAM,MAAM,IAAI,QAAQ;AAC9B,eAAS,IAAI,GAAG,IAAI,MAAM,MAAM,QAAQ,KAAK;AAC3C,aAAK,MAAM,MAAM,MAAM;AACvB,cAAM,MAAM,CAAC,EAAE,SAAS,KAAK,MAAM,YAAY,MAAM,MAAM,CAAC,EAAE,MAAM,CAAC,CAAC;AACtE,YAAI,CAAC,MAAM,OAAO;AAChB,gBAAM,UAAU,MAAM,MAAM,CAAC,EAAE,OAAO,OAAO,CAAC,MAAM,EAAE,SAAS,OAAO;AACtE,gBAAM,wBAAwB,QAAQ,SAAS,KAAK,QAAQ,KAAK,CAAC,MAAM,KAAK,MAAM,MAAM,QAAQ,KAAK,EAAE,GAAG,CAAC;AAC5G,gBAAM,QAAQ;AAAA,QAChB;AAAA,MACF;AACA,UAAI,MAAM,OAAO;AACf,iBAAS,IAAI,GAAG,IAAI,MAAM,MAAM,QAAQ,KAAK;AAC3C,gBAAM,MAAM,CAAC,EAAE,QAAQ;AAAA,QACzB;AAAA,MACF;AACA,aAAO;AAAA,IACT;AAAA,EACF;AAAA,EACA,KAAK,KAAK;AACR,UAAM,MAAM,KAAK,MAAM,MAAM,KAAK,KAAK,GAAG;AAC1C,QAAI,KAAK;AACP,YAAM,QAAQ;AAAA,QACZ,MAAM;AAAA,QACN,OAAO;AAAA,QACP,KAAK,IAAI,CAAC;AAAA,QACV,KAAK,IAAI,CAAC,MAAM,SAAS,IAAI,CAAC,MAAM,YAAY,IAAI,CAAC,MAAM;AAAA,QAC3D,MAAM,IAAI,CAAC;AAAA,MACb;AACA,aAAO;AAAA,IACT;AAAA,EACF;AAAA,EACA,IAAI,KAAK;AACP,UAAM,MAAM,KAAK,MAAM,MAAM,IAAI,KAAK,GAAG;AACzC,QAAI,KAAK;AACP,YAAM,OAAO,IAAI,CAAC,EAAE,YAAY,EAAE,QAAQ,KAAK,MAAM,MAAM,qBAAqB,GAAG;AACnF,YAAM,OAAO,IAAI,CAAC,IAAI,IAAI,CAAC,EAAE,QAAQ,KAAK,MAAM,MAAM,cAAc,IAAI,EAAE,QAAQ,KAAK,MAAM,OAAO,gBAAgB,IAAI,IAAI;AAC5H,YAAM,QAAQ,IAAI,CAAC,IAAI,IAAI,CAAC,EAAE,UAAU,GAAG,IAAI,CAAC,EAAE,SAAS,CAAC,EAAE,QAAQ,KAAK,MAAM,OAAO,gBAAgB,IAAI,IAAI,IAAI,CAAC;AACrH,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK;AAAA,QACL,KAAK,IAAI,CAAC;AAAA,QACV;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,EACA,MAAM,KAAK;AACT,UAAM,MAAM,KAAK,MAAM,MAAM,MAAM,KAAK,GAAG;AAC3C,QAAI,CAAC,KAAK;AACR;AAAA,IACF;AACA,QAAI,CAAC,KAAK,MAAM,MAAM,eAAe,KAAK,IAAI,CAAC,CAAC,GAAG;AACjD;AAAA,IACF;AACA,UAAM,UAAU,WAAW,IAAI,CAAC,CAAC;AACjC,UAAM,SAAS,IAAI,CAAC,EAAE,QAAQ,KAAK,MAAM,MAAM,iBAAiB,EAAE,EAAE,MAAM,GAAG;AAC7E,UAAM,OAAO,IAAI,CAAC,GAAG,KAAK,IAAI,IAAI,CAAC,EAAE,QAAQ,KAAK,MAAM,MAAM,mBAAmB,EAAE,EAAE,MAAM,IAAI,IAAI,CAAC;AACpG,UAAM,OAAO;AAAA,MACX,MAAM;AAAA,MACN,KAAK,IAAI,CAAC;AAAA,MACV,QAAQ,CAAC;AAAA,MACT,OAAO,CAAC;AAAA,MACR,MAAM,CAAC;AAAA,IACT;AACA,QAAI,QAAQ,WAAW,OAAO,QAAQ;AACpC;AAAA,IACF;AACA,eAAW,SAAS,QAAQ;AAC1B,UAAI,KAAK,MAAM,MAAM,gBAAgB,KAAK,KAAK,GAAG;AAChD,aAAK,MAAM,KAAK,OAAO;AAAA,MACzB,WAAW,KAAK,MAAM,MAAM,iBAAiB,KAAK,KAAK,GAAG;AACxD,aAAK,MAAM,KAAK,QAAQ;AAAA,MAC1B,WAAW,KAAK,MAAM,MAAM,eAAe,KAAK,KAAK,GAAG;AACtD,aAAK,MAAM,KAAK,MAAM;AAAA,MACxB,OAAO;AACL,aAAK,MAAM,KAAK,IAAI;AAAA,MACtB;AAAA,IACF;AACA,aAAS,IAAI,GAAG,IAAI,QAAQ,QAAQ,KAAK;AACvC,WAAK,OAAO,KAAK;AAAA,QACf,MAAM,QAAQ,CAAC;AAAA,QACf,QAAQ,KAAK,MAAM,OAAO,QAAQ,CAAC,CAAC;AAAA,QACpC,QAAQ;AAAA,QACR,OAAO,KAAK,MAAM,CAAC;AAAA,MACrB,CAAC;AAAA,IACH;AACA,eAAW,OAAO,MAAM;AACtB,WAAK,KAAK,KAAK,WAAW,KAAK,KAAK,OAAO,MAAM,EAAE,IAAI,CAAC,MAAM,MAAM;AAClE,eAAO;AAAA,UACL,MAAM;AAAA,UACN,QAAQ,KAAK,MAAM,OAAO,IAAI;AAAA,UAC9B,QAAQ;AAAA,UACR,OAAO,KAAK,MAAM,CAAC;AAAA,QACrB;AAAA,MACF,CAAC,CAAC;AAAA,IACJ;AACA,WAAO;AAAA,EACT;AAAA,EACA,SAAS,KAAK;AACZ,UAAM,MAAM,KAAK,MAAM,MAAM,SAAS,KAAK,GAAG;AAC9C,QAAI,KAAK;AACP,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,QACV,OAAO,IAAI,CAAC,EAAE,OAAO,CAAC,MAAM,MAAM,IAAI;AAAA,QACtC,MAAM,IAAI,CAAC;AAAA,QACX,QAAQ,KAAK,MAAM,OAAO,IAAI,CAAC,CAAC;AAAA,MAClC;AAAA,IACF;AAAA,EACF;AAAA,EACA,UAAU,KAAK;AACb,UAAM,MAAM,KAAK,MAAM,MAAM,UAAU,KAAK,GAAG;AAC/C,QAAI,KAAK;AACP,YAAM,OAAO,IAAI,CAAC,EAAE,OAAO,IAAI,CAAC,EAAE,SAAS,CAAC,MAAM,OAAO,IAAI,CAAC,EAAE,MAAM,GAAG,EAAE,IAAI,IAAI,CAAC;AACpF,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,QACV;AAAA,QACA,QAAQ,KAAK,MAAM,OAAO,IAAI;AAAA,MAChC;AAAA,IACF;AAAA,EACF;AAAA,EACA,KAAK,KAAK;AACR,UAAM,MAAM,KAAK,MAAM,MAAM,KAAK,KAAK,GAAG;AAC1C,QAAI,KAAK;AACP,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,QACV,MAAM,IAAI,CAAC;AAAA,QACX,QAAQ,KAAK,MAAM,OAAO,IAAI,CAAC,CAAC;AAAA,MAClC;AAAA,IACF;AAAA,EACF;AAAA,EACA,OAAO,KAAK;AACV,UAAM,MAAM,KAAK,MAAM,OAAO,OAAO,KAAK,GAAG;AAC7C,QAAI,KAAK;AACP,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,QACV,MAAM,IAAI,CAAC;AAAA,MACb;AAAA,IACF;AAAA,EACF;AAAA,EACA,IAAI,KAAK;AACP,UAAM,MAAM,KAAK,MAAM,OAAO,IAAI,KAAK,GAAG;AAC1C,QAAI,KAAK;AACP,UAAI,CAAC,KAAK,MAAM,MAAM,UAAU,KAAK,MAAM,MAAM,UAAU,KAAK,IAAI,CAAC,CAAC,GAAG;AACvE,aAAK,MAAM,MAAM,SAAS;AAAA,MAC5B,WAAW,KAAK,MAAM,MAAM,UAAU,KAAK,MAAM,MAAM,QAAQ,KAAK,IAAI,CAAC,CAAC,GAAG;AAC3E,aAAK,MAAM,MAAM,SAAS;AAAA,MAC5B;AACA,UAAI,CAAC,KAAK,MAAM,MAAM,cAAc,KAAK,MAAM,MAAM,kBAAkB,KAAK,IAAI,CAAC,CAAC,GAAG;AACnF,aAAK,MAAM,MAAM,aAAa;AAAA,MAChC,WAAW,KAAK,MAAM,MAAM,cAAc,KAAK,MAAM,MAAM,gBAAgB,KAAK,IAAI,CAAC,CAAC,GAAG;AACvF,aAAK,MAAM,MAAM,aAAa;AAAA,MAChC;AACA,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,QACV,QAAQ,KAAK,MAAM,MAAM;AAAA,QACzB,YAAY,KAAK,MAAM,MAAM;AAAA,QAC7B,OAAO;AAAA,QACP,MAAM,IAAI,CAAC;AAAA,MACb;AAAA,IACF;AAAA,EACF;AAAA,EACA,KAAK,KAAK;AACR,UAAM,MAAM,KAAK,MAAM,OAAO,KAAK,KAAK,GAAG;AAC3C,QAAI,KAAK;AACP,YAAM,aAAa,IAAI,CAAC,EAAE,KAAK;AAC/B,UAAI,CAAC,KAAK,QAAQ,YAAY,KAAK,MAAM,MAAM,kBAAkB,KAAK,UAAU,GAAG;AACjF,YAAI,CAAC,KAAK,MAAM,MAAM,gBAAgB,KAAK,UAAU,GAAG;AACtD;AAAA,QACF;AACA,cAAM,aAAa,MAAM,WAAW,MAAM,GAAG,EAAE,GAAG,IAAI;AACtD,aAAK,WAAW,SAAS,WAAW,UAAU,MAAM,GAAG;AACrD;AAAA,QACF;AAAA,MACF,OAAO;AACL,cAAM,iBAAiB,mBAAmB,IAAI,CAAC,GAAG,IAAI;AACtD,YAAI,mBAAmB,IAAI;AACzB;AAAA,QACF;AACA,YAAI,iBAAiB,IAAI;AACvB,gBAAM,QAAQ,IAAI,CAAC,EAAE,QAAQ,GAAG,MAAM,IAAI,IAAI;AAC9C,gBAAM,UAAU,QAAQ,IAAI,CAAC,EAAE,SAAS;AACxC,cAAI,CAAC,IAAI,IAAI,CAAC,EAAE,UAAU,GAAG,cAAc;AAC3C,cAAI,CAAC,IAAI,IAAI,CAAC,EAAE,UAAU,GAAG,OAAO,EAAE,KAAK;AAC3C,cAAI,CAAC,IAAI;AAAA,QACX;AAAA,MACF;AACA,UAAI,OAAO,IAAI,CAAC;AAChB,UAAI,QAAQ;AACZ,UAAI,KAAK,QAAQ,UAAU;AACzB,cAAM,QAAQ,KAAK,MAAM,MAAM,kBAAkB,KAAK,IAAI;AAC1D,YAAI,OAAO;AACT,iBAAO,MAAM,CAAC;AACd,kBAAQ,MAAM,CAAC;AAAA,QACjB;AAAA,MACF,OAAO;AACL,gBAAQ,IAAI,CAAC,IAAI,IAAI,CAAC,EAAE,MAAM,GAAG,EAAE,IAAI;AAAA,MACzC;AACA,aAAO,KAAK,KAAK;AACjB,UAAI,KAAK,MAAM,MAAM,kBAAkB,KAAK,IAAI,GAAG;AACjD,YAAI,KAAK,QAAQ,YAAY,CAAC,KAAK,MAAM,MAAM,gBAAgB,KAAK,UAAU,GAAG;AAC/E,iBAAO,KAAK,MAAM,CAAC;AAAA,QACrB,OAAO;AACL,iBAAO,KAAK,MAAM,GAAG,EAAE;AAAA,QACzB;AAAA,MACF;AACA,aAAO,WAAW,KAAK;AAAA,QACrB,MAAM,OAAO,KAAK,QAAQ,KAAK,MAAM,OAAO,gBAAgB,IAAI,IAAI;AAAA,QACpE,OAAO,QAAQ,MAAM,QAAQ,KAAK,MAAM,OAAO,gBAAgB,IAAI,IAAI;AAAA,MACzE,GAAG,IAAI,CAAC,GAAG,KAAK,OAAO,KAAK,KAAK;AAAA,IACnC;AAAA,EACF;AAAA,EACA,QAAQ,KAAK,OAAO;AAClB,QAAI;AACJ,SAAK,MAAM,KAAK,MAAM,OAAO,QAAQ,KAAK,GAAG,OAAO,MAAM,KAAK,MAAM,OAAO,OAAO,KAAK,GAAG,IAAI;AAC7F,YAAM,cAAc,IAAI,CAAC,KAAK,IAAI,CAAC,GAAG,QAAQ,KAAK,MAAM,MAAM,qBAAqB,GAAG;AACvF,YAAM,QAAQ,MAAM,WAAW,YAAY,CAAC;AAC5C,UAAI,CAAC,OAAO;AACV,cAAM,OAAO,IAAI,CAAC,EAAE,OAAO,CAAC;AAC5B,eAAO;AAAA,UACL,MAAM;AAAA,UACN,KAAK;AAAA,UACL;AAAA,QACF;AAAA,MACF;AACA,aAAO,WAAW,KAAK,OAAO,IAAI,CAAC,GAAG,KAAK,OAAO,KAAK,KAAK;AAAA,IAC9D;AAAA,EACF;AAAA,EACA,SAAS,KAAK,WAAW,WAAW,IAAI;AACtC,QAAI,QAAQ,KAAK,MAAM,OAAO,eAAe,KAAK,GAAG;AACrD,QAAI,CAAC,MAAO;AACZ,QAAI,MAAM,CAAC,KAAK,SAAS,MAAM,KAAK,MAAM,MAAM,mBAAmB,EAAG;AACtE,UAAM,WAAW,MAAM,CAAC,KAAK,MAAM,CAAC,KAAK;AACzC,QAAI,CAAC,YAAY,CAAC,YAAY,KAAK,MAAM,OAAO,YAAY,KAAK,QAAQ,GAAG;AAC1E,YAAM,UAAU,CAAC,GAAG,MAAM,CAAC,CAAC,EAAE,SAAS;AACvC,UAAI,QAAQ,SAAS,aAAa,SAAS,gBAAgB;AAC3D,YAAM,SAAS,MAAM,CAAC,EAAE,CAAC,MAAM,MAAM,KAAK,MAAM,OAAO,oBAAoB,KAAK,MAAM,OAAO;AAC7F,aAAO,YAAY;AACnB,kBAAY,UAAU,MAAM,KAAK,IAAI,SAAS,OAAO;AACrD,cAAQ,QAAQ,OAAO,KAAK,SAAS,MAAM,MAAM;AAC/C,iBAAS,MAAM,CAAC,KAAK,MAAM,CAAC,KAAK,MAAM,CAAC,KAAK,MAAM,CAAC,KAAK,MAAM,CAAC,KAAK,MAAM,CAAC;AAC5E,YAAI,CAAC,OAAQ;AACb,kBAAU,CAAC,GAAG,MAAM,EAAE;AACtB,YAAI,MAAM,CAAC,KAAK,MAAM,CAAC,GAAG;AACxB,wBAAc;AACd;AAAA,QACF,WAAW,MAAM,CAAC,KAAK,MAAM,CAAC,GAAG;AAC/B,cAAI,UAAU,KAAK,GAAG,UAAU,WAAW,IAAI;AAC7C,6BAAiB;AACjB;AAAA,UACF;AAAA,QACF;AACA,sBAAc;AACd,YAAI,aAAa,EAAG;AACpB,kBAAU,KAAK,IAAI,SAAS,UAAU,aAAa,aAAa;AAChE,cAAM,iBAAiB,CAAC,GAAG,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE;AACxC,cAAM,MAAM,IAAI,MAAM,GAAG,UAAU,MAAM,QAAQ,iBAAiB,OAAO;AACzE,YAAI,KAAK,IAAI,SAAS,OAAO,IAAI,GAAG;AAClC,gBAAM,QAAQ,IAAI,MAAM,GAAG,EAAE;AAC7B,iBAAO;AAAA,YACL,MAAM;AAAA,YACN;AAAA,YACA,MAAM;AAAA,YACN,QAAQ,KAAK,MAAM,aAAa,KAAK;AAAA,UACvC;AAAA,QACF;AACA,cAAM,OAAO,IAAI,MAAM,GAAG,EAAE;AAC5B,eAAO;AAAA,UACL,MAAM;AAAA,UACN;AAAA,UACA;AAAA,UACA,QAAQ,KAAK,MAAM,aAAa,IAAI;AAAA,QACtC;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,EACA,SAAS,KAAK;AACZ,UAAM,MAAM,KAAK,MAAM,OAAO,KAAK,KAAK,GAAG;AAC3C,QAAI,KAAK;AACP,UAAI,OAAO,IAAI,CAAC,EAAE,QAAQ,KAAK,MAAM,MAAM,mBAAmB,GAAG;AACjE,YAAM,mBAAmB,KAAK,MAAM,MAAM,aAAa,KAAK,IAAI;AAChE,YAAM,0BAA0B,KAAK,MAAM,MAAM,kBAAkB,KAAK,IAAI,KAAK,KAAK,MAAM,MAAM,gBAAgB,KAAK,IAAI;AAC3H,UAAI,oBAAoB,yBAAyB;AAC/C,eAAO,KAAK,UAAU,GAAG,KAAK,SAAS,CAAC;AAAA,MAC1C;AACA,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,QACV;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,EACA,GAAG,KAAK;AACN,UAAM,MAAM,KAAK,MAAM,OAAO,GAAG,KAAK,GAAG;AACzC,QAAI,KAAK;AACP,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,MACZ;AAAA,IACF;AAAA,EACF;AAAA,EACA,IAAI,KAAK;AACP,UAAM,MAAM,KAAK,MAAM,OAAO,IAAI,KAAK,GAAG;AAC1C,QAAI,KAAK;AACP,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,QACV,MAAM,IAAI,CAAC;AAAA,QACX,QAAQ,KAAK,MAAM,aAAa,IAAI,CAAC,CAAC;AAAA,MACxC;AAAA,IACF;AAAA,EACF;AAAA,EACA,SAAS,KAAK;AACZ,UAAM,MAAM,KAAK,MAAM,OAAO,SAAS,KAAK,GAAG;AAC/C,QAAI,KAAK;AACP,UAAI,MAAM;AACV,UAAI,IAAI,CAAC,MAAM,KAAK;AAClB,eAAO,IAAI,CAAC;AACZ,eAAO,YAAY;AAAA,MACrB,OAAO;AACL,eAAO,IAAI,CAAC;AACZ,eAAO;AAAA,MACT;AACA,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,QACV;AAAA,QACA;AAAA,QACA,QAAQ;AAAA,UACN;AAAA,YACE,MAAM;AAAA,YACN,KAAK;AAAA,YACL;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,EACA,IAAI,KAAK;AACP,QAAI;AACJ,QAAI,MAAM,KAAK,MAAM,OAAO,IAAI,KAAK,GAAG,GAAG;AACzC,UAAI,MAAM;AACV,UAAI,IAAI,CAAC,MAAM,KAAK;AAClB,eAAO,IAAI,CAAC;AACZ,eAAO,YAAY;AAAA,MACrB,OAAO;AACL,YAAI;AACJ,WAAG;AACD,wBAAc,IAAI,CAAC;AACnB,cAAI,CAAC,IAAI,KAAK,MAAM,OAAO,WAAW,KAAK,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK;AAAA,QAC7D,SAAS,gBAAgB,IAAI,CAAC;AAC9B,eAAO,IAAI,CAAC;AACZ,YAAI,IAAI,CAAC,MAAM,QAAQ;AACrB,iBAAO,YAAY,IAAI,CAAC;AAAA,QAC1B,OAAO;AACL,iBAAO,IAAI,CAAC;AAAA,QACd;AAAA,MACF;AACA,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,QACV;AAAA,QACA;AAAA,QACA,QAAQ;AAAA,UACN;AAAA,YACE,MAAM;AAAA,YACN,KAAK;AAAA,YACL;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA,EACA,WAAW,KAAK;AACd,UAAM,MAAM,KAAK,MAAM,OAAO,KAAK,KAAK,GAAG;AAC3C,QAAI,KAAK;AACP,YAAM,UAAU,KAAK,MAAM,MAAM;AACjC,aAAO;AAAA,QACL,MAAM;AAAA,QACN,KAAK,IAAI,CAAC;AAAA,QACV,MAAM,IAAI,CAAC;AAAA,QACX;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF;AAGA,IAAI,SAAS,MAAM,QAAQ;AAAA,EApiC3B,OAoiC2B;AAAA;AAAA;AAAA,EACzB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,UAAU;AACpB,SAAK,SAAS,CAAC;AACf,SAAK,OAAO,QAAwB,uBAAO,OAAO,IAAI;AACtD,SAAK,UAAU,YAAY;AAC3B,SAAK,QAAQ,YAAY,KAAK,QAAQ,aAAa,IAAI,WAAW;AAClE,SAAK,YAAY,KAAK,QAAQ;AAC9B,SAAK,UAAU,UAAU,KAAK;AAC9B,SAAK,UAAU,QAAQ;AACvB,SAAK,cAAc,CAAC;AACpB,SAAK,QAAQ;AAAA,MACX,QAAQ;AAAA,MACR,YAAY;AAAA,MACZ,KAAK;AAAA,IACP;AACA,UAAM,QAAQ;AAAA,MACZ;AAAA,MACA,OAAO,MAAM;AAAA,MACb,QAAQ,OAAO;AAAA,IACjB;AACA,QAAI,KAAK,QAAQ,UAAU;AACzB,YAAM,QAAQ,MAAM;AACpB,YAAM,SAAS,OAAO;AAAA,IACxB,WAAW,KAAK,QAAQ,KAAK;AAC3B,YAAM,QAAQ,MAAM;AACpB,UAAI,KAAK,QAAQ,QAAQ;AACvB,cAAM,SAAS,OAAO;AAAA,MACxB,OAAO;AACL,cAAM,SAAS,OAAO;AAAA,MACxB;AAAA,IACF;AACA,SAAK,UAAU,QAAQ;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA,EAIA,WAAW,QAAQ;AACjB,WAAO;AAAA,MACL;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAIA,OAAO,IAAI,KAAK,UAAU;AACxB,UAAM,SAAS,IAAI,QAAQ,QAAQ;AACnC,WAAO,OAAO,IAAI,GAAG;AAAA,EACvB;AAAA;AAAA;AAAA;AAAA,EAIA,OAAO,UAAU,KAAK,UAAU;AAC9B,UAAM,SAAS,IAAI,QAAQ,QAAQ;AACnC,WAAO,OAAO,aAAa,GAAG;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA,EAIA,IAAI,KAAK;AACP,UAAM,IAAI,QAAQ,MAAM,gBAAgB,IAAI;AAC5C,SAAK,YAAY,KAAK,KAAK,MAAM;AACjC,aAAS,IAAI,GAAG,IAAI,KAAK,YAAY,QAAQ,KAAK;AAChD,YAAM,OAAO,KAAK,YAAY,CAAC;AAC/B,WAAK,aAAa,KAAK,KAAK,KAAK,MAAM;AAAA,IACzC;AACA,SAAK,cAAc,CAAC;AACpB,WAAO,KAAK;AAAA,EACd;AAAA,EACA,YAAY,KAAK,SAAS,CAAC,GAAG,uBAAuB,OAAO;AAC1D,QAAI,KAAK,QAAQ,UAAU;AACzB,YAAM,IAAI,QAAQ,MAAM,eAAe,MAAM,EAAE,QAAQ,MAAM,WAAW,EAAE;AAAA,IAC5E;AACA,WAAO,KAAK;AACV,UAAI;AACJ,UAAI,KAAK,QAAQ,YAAY,OAAO,KAAK,CAAC,iBAAiB;AACzD,YAAI,QAAQ,aAAa,KAAK,EAAE,OAAO,KAAK,GAAG,KAAK,MAAM,GAAG;AAC3D,gBAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,iBAAO,KAAK,KAAK;AACjB,iBAAO;AAAA,QACT;AACA,eAAO;AAAA,MACT,CAAC,GAAG;AACF;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,MAAM,GAAG,GAAG;AACrC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,cAAM,YAAY,OAAO,GAAG,EAAE;AAC9B,YAAI,MAAM,IAAI,WAAW,KAAK,cAAc,QAAQ;AAClD,oBAAU,OAAO;AAAA,QACnB,OAAO;AACL,iBAAO,KAAK,KAAK;AAAA,QACnB;AACA;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,KAAK,GAAG,GAAG;AACpC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,cAAM,YAAY,OAAO,GAAG,EAAE;AAC9B,YAAI,WAAW,SAAS,eAAe,WAAW,SAAS,QAAQ;AACjE,oBAAU,OAAO,OAAO,MAAM;AAC9B,oBAAU,QAAQ,OAAO,MAAM;AAC/B,eAAK,YAAY,GAAG,EAAE,EAAE,MAAM,UAAU;AAAA,QAC1C,OAAO;AACL,iBAAO,KAAK,KAAK;AAAA,QACnB;AACA;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,OAAO,GAAG,GAAG;AACtC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,QAAQ,GAAG,GAAG;AACvC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,GAAG,GAAG,GAAG;AAClC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,WAAW,GAAG,GAAG;AAC1C,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,KAAK,GAAG,GAAG;AACpC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,KAAK,GAAG,GAAG;AACpC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,IAAI,GAAG,GAAG;AACnC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,cAAM,YAAY,OAAO,GAAG,EAAE;AAC9B,YAAI,WAAW,SAAS,eAAe,WAAW,SAAS,QAAQ;AACjE,oBAAU,OAAO,OAAO,MAAM;AAC9B,oBAAU,QAAQ,OAAO,MAAM;AAC/B,eAAK,YAAY,GAAG,EAAE,EAAE,MAAM,UAAU;AAAA,QAC1C,WAAW,CAAC,KAAK,OAAO,MAAM,MAAM,GAAG,GAAG;AACxC,eAAK,OAAO,MAAM,MAAM,GAAG,IAAI;AAAA,YAC7B,MAAM,MAAM;AAAA,YACZ,OAAO,MAAM;AAAA,UACf;AAAA,QACF;AACA;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,MAAM,GAAG,GAAG;AACrC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,SAAS,GAAG,GAAG;AACxC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,SAAS;AACb,UAAI,KAAK,QAAQ,YAAY,YAAY;AACvC,YAAI,aAAa;AACjB,cAAM,UAAU,IAAI,MAAM,CAAC;AAC3B,YAAI;AACJ,aAAK,QAAQ,WAAW,WAAW,QAAQ,CAAC,kBAAkB;AAC5D,sBAAY,cAAc,KAAK,EAAE,OAAO,KAAK,GAAG,OAAO;AACvD,cAAI,OAAO,cAAc,YAAY,aAAa,GAAG;AACnD,yBAAa,KAAK,IAAI,YAAY,SAAS;AAAA,UAC7C;AAAA,QACF,CAAC;AACD,YAAI,aAAa,YAAY,cAAc,GAAG;AAC5C,mBAAS,IAAI,UAAU,GAAG,aAAa,CAAC;AAAA,QAC1C;AAAA,MACF;AACA,UAAI,KAAK,MAAM,QAAQ,QAAQ,KAAK,UAAU,UAAU,MAAM,IAAI;AAChE,cAAM,YAAY,OAAO,GAAG,EAAE;AAC9B,YAAI,wBAAwB,WAAW,SAAS,aAAa;AAC3D,oBAAU,OAAO,OAAO,MAAM;AAC9B,oBAAU,QAAQ,OAAO,MAAM;AAC/B,eAAK,YAAY,IAAI;AACrB,eAAK,YAAY,GAAG,EAAE,EAAE,MAAM,UAAU;AAAA,QAC1C,OAAO;AACL,iBAAO,KAAK,KAAK;AAAA,QACnB;AACA,+BAAuB,OAAO,WAAW,IAAI;AAC7C,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,KAAK,GAAG,GAAG;AACpC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,cAAM,YAAY,OAAO,GAAG,EAAE;AAC9B,YAAI,WAAW,SAAS,QAAQ;AAC9B,oBAAU,OAAO,OAAO,MAAM;AAC9B,oBAAU,QAAQ,OAAO,MAAM;AAC/B,eAAK,YAAY,IAAI;AACrB,eAAK,YAAY,GAAG,EAAE,EAAE,MAAM,UAAU;AAAA,QAC1C,OAAO;AACL,iBAAO,KAAK,KAAK;AAAA,QACnB;AACA;AAAA,MACF;AACA,UAAI,KAAK;AACP,cAAM,SAAS,4BAA4B,IAAI,WAAW,CAAC;AAC3D,YAAI,KAAK,QAAQ,QAAQ;AACvB,kBAAQ,MAAM,MAAM;AACpB;AAAA,QACF,OAAO;AACL,gBAAM,IAAI,MAAM,MAAM;AAAA,QACxB;AAAA,MACF;AAAA,IACF;AACA,SAAK,MAAM,MAAM;AACjB,WAAO;AAAA,EACT;AAAA,EACA,OAAO,KAAK,SAAS,CAAC,GAAG;AACvB,SAAK,YAAY,KAAK,EAAE,KAAK,OAAO,CAAC;AACrC,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAIA,aAAa,KAAK,SAAS,CAAC,GAAG;AAC7B,QAAI,YAAY;AAChB,QAAI,QAAQ;AACZ,QAAI,KAAK,OAAO,OAAO;AACrB,YAAM,QAAQ,OAAO,KAAK,KAAK,OAAO,KAAK;AAC3C,UAAI,MAAM,SAAS,GAAG;AACpB,gBAAQ,QAAQ,KAAK,UAAU,MAAM,OAAO,cAAc,KAAK,SAAS,MAAM,MAAM;AAClF,cAAI,MAAM,SAAS,MAAM,CAAC,EAAE,MAAM,MAAM,CAAC,EAAE,YAAY,GAAG,IAAI,GAAG,EAAE,CAAC,GAAG;AACrE,wBAAY,UAAU,MAAM,GAAG,MAAM,KAAK,IAAI,MAAM,IAAI,OAAO,MAAM,CAAC,EAAE,SAAS,CAAC,IAAI,MAAM,UAAU,MAAM,KAAK,UAAU,MAAM,OAAO,cAAc,SAAS;AAAA,UACjK;AAAA,QACF;AAAA,MACF;AAAA,IACF;AACA,YAAQ,QAAQ,KAAK,UAAU,MAAM,OAAO,eAAe,KAAK,SAAS,MAAM,MAAM;AACnF,kBAAY,UAAU,MAAM,GAAG,MAAM,KAAK,IAAI,OAAO,UAAU,MAAM,KAAK,UAAU,MAAM,OAAO,eAAe,SAAS;AAAA,IAC3H;AACA,YAAQ,QAAQ,KAAK,UAAU,MAAM,OAAO,UAAU,KAAK,SAAS,MAAM,MAAM;AAC9E,kBAAY,UAAU,MAAM,GAAG,MAAM,KAAK,IAAI,MAAM,IAAI,OAAO,MAAM,CAAC,EAAE,SAAS,CAAC,IAAI,MAAM,UAAU,MAAM,KAAK,UAAU,MAAM,OAAO,UAAU,SAAS;AAAA,IAC7J;AACA,QAAI,eAAe;AACnB,QAAI,WAAW;AACf,WAAO,KAAK;AACV,UAAI,CAAC,cAAc;AACjB,mBAAW;AAAA,MACb;AACA,qBAAe;AACf,UAAI;AACJ,UAAI,KAAK,QAAQ,YAAY,QAAQ,KAAK,CAAC,iBAAiB;AAC1D,YAAI,QAAQ,aAAa,KAAK,EAAE,OAAO,KAAK,GAAG,KAAK,MAAM,GAAG;AAC3D,gBAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,iBAAO,KAAK,KAAK;AACjB,iBAAO;AAAA,QACT;AACA,eAAO;AAAA,MACT,CAAC,GAAG;AACF;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,OAAO,GAAG,GAAG;AACtC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,IAAI,GAAG,GAAG;AACnC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,KAAK,GAAG,GAAG;AACpC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,QAAQ,KAAK,KAAK,OAAO,KAAK,GAAG;AAC1D,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,cAAM,YAAY,OAAO,GAAG,EAAE;AAC9B,YAAI,MAAM,SAAS,UAAU,WAAW,SAAS,QAAQ;AACvD,oBAAU,OAAO,MAAM;AACvB,oBAAU,QAAQ,MAAM;AAAA,QAC1B,OAAO;AACL,iBAAO,KAAK,KAAK;AAAA,QACnB;AACA;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,SAAS,KAAK,WAAW,QAAQ,GAAG;AAC7D,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,SAAS,GAAG,GAAG;AACxC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,GAAG,GAAG,GAAG;AAClC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,IAAI,GAAG,GAAG;AACnC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,SAAS,GAAG,GAAG;AACxC,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,CAAC,KAAK,MAAM,WAAW,QAAQ,KAAK,UAAU,IAAI,GAAG,IAAI;AAC3D,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,eAAO,KAAK,KAAK;AACjB;AAAA,MACF;AACA,UAAI,SAAS;AACb,UAAI,KAAK,QAAQ,YAAY,aAAa;AACxC,YAAI,aAAa;AACjB,cAAM,UAAU,IAAI,MAAM,CAAC;AAC3B,YAAI;AACJ,aAAK,QAAQ,WAAW,YAAY,QAAQ,CAAC,kBAAkB;AAC7D,sBAAY,cAAc,KAAK,EAAE,OAAO,KAAK,GAAG,OAAO;AACvD,cAAI,OAAO,cAAc,YAAY,aAAa,GAAG;AACnD,yBAAa,KAAK,IAAI,YAAY,SAAS;AAAA,UAC7C;AAAA,QACF,CAAC;AACD,YAAI,aAAa,YAAY,cAAc,GAAG;AAC5C,mBAAS,IAAI,UAAU,GAAG,aAAa,CAAC;AAAA,QAC1C;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,UAAU,WAAW,MAAM,GAAG;AAC7C,cAAM,IAAI,UAAU,MAAM,IAAI,MAAM;AACpC,YAAI,MAAM,IAAI,MAAM,EAAE,MAAM,KAAK;AAC/B,qBAAW,MAAM,IAAI,MAAM,EAAE;AAAA,QAC/B;AACA,uBAAe;AACf,cAAM,YAAY,OAAO,GAAG,EAAE;AAC9B,YAAI,WAAW,SAAS,QAAQ;AAC9B,oBAAU,OAAO,MAAM;AACvB,oBAAU,QAAQ,MAAM;AAAA,QAC1B,OAAO;AACL,iBAAO,KAAK,KAAK;AAAA,QACnB;AACA;AAAA,MACF;AACA,UAAI,KAAK;AACP,cAAM,SAAS,4BAA4B,IAAI,WAAW,CAAC;AAC3D,YAAI,KAAK,QAAQ,QAAQ;AACvB,kBAAQ,MAAM,MAAM;AACpB;AAAA,QACF,OAAO;AACL,gBAAM,IAAI,MAAM,MAAM;AAAA,QACxB;AAAA,MACF;AAAA,IACF;AACA,WAAO;AAAA,EACT;AACF;AAGA,IAAI,YAAY,MAAM;AAAA,EAn5CtB,OAm5CsB;AAAA;AAAA;AAAA,EACpB;AAAA,EACA;AAAA;AAAA,EAEA,YAAY,UAAU;AACpB,SAAK,UAAU,YAAY;AAAA,EAC7B;AAAA,EACA,MAAM,OAAO;AACX,WAAO;AAAA,EACT;AAAA,EACA,KAAK,EAAE,MAAM,MAAM,QAAQ,GAAG;AAC5B,UAAM,cAAc,QAAQ,IAAI,MAAM,MAAM,aAAa,IAAI,CAAC;AAC9D,UAAM,OAAO,KAAK,QAAQ,MAAM,eAAe,EAAE,IAAI;AACrD,QAAI,CAAC,YAAY;AACf,aAAO,iBAAiB,UAAU,OAAO,QAAQ,MAAM,IAAI,KAAK;AAAA,IAClE;AACA,WAAO,gCAAgC,QAAQ,UAAU,IAAI,QAAQ,UAAU,OAAO,QAAQ,MAAM,IAAI,KAAK;AAAA,EAC/G;AAAA,EACA,WAAW,EAAE,OAAO,GAAG;AACrB,UAAM,OAAO,KAAK,OAAO,MAAM,MAAM;AACrC,WAAO;AAAA,EACT,IAAI;AAAA;AAAA,EAEJ;AAAA,EACA,KAAK,EAAE,KAAK,GAAG;AACb,WAAO;AAAA,EACT;AAAA,EACA,QAAQ,EAAE,QAAQ,MAAM,GAAG;AACzB,WAAO,KAAK,KAAK,IAAI,KAAK,OAAO,YAAY,MAAM,CAAC,MAAM,KAAK;AAAA;AAAA,EAEjE;AAAA,EACA,GAAG,OAAO;AACR,WAAO;AAAA,EACT;AAAA,EACA,KAAK,OAAO;AACV,UAAM,UAAU,MAAM;AACtB,UAAM,QAAQ,MAAM;AACpB,QAAI,OAAO;AACX,aAAS,IAAI,GAAG,IAAI,MAAM,MAAM,QAAQ,KAAK;AAC3C,YAAM,OAAO,MAAM,MAAM,CAAC;AAC1B,cAAQ,KAAK,SAAS,IAAI;AAAA,IAC5B;AACA,UAAM,OAAO,UAAU,OAAO;AAC9B,UAAM,YAAY,WAAW,UAAU,IAAI,aAAa,QAAQ,MAAM;AACtE,WAAO,MAAM,OAAO,YAAY,QAAQ,OAAO,OAAO,OAAO;AAAA,EAC/D;AAAA,EACA,SAAS,MAAM;AACb,QAAI,WAAW;AACf,QAAI,KAAK,MAAM;AACb,YAAM,WAAW,KAAK,SAAS,EAAE,SAAS,CAAC,CAAC,KAAK,QAAQ,CAAC;AAC1D,UAAI,KAAK,OAAO;AACd,YAAI,KAAK,OAAO,CAAC,GAAG,SAAS,aAAa;AACxC,eAAK,OAAO,CAAC,EAAE,OAAO,WAAW,MAAM,KAAK,OAAO,CAAC,EAAE;AACtD,cAAI,KAAK,OAAO,CAAC,EAAE,UAAU,KAAK,OAAO,CAAC,EAAE,OAAO,SAAS,KAAK,KAAK,OAAO,CAAC,EAAE,OAAO,CAAC,EAAE,SAAS,QAAQ;AACzG,iBAAK,OAAO,CAAC,EAAE,OAAO,CAAC,EAAE,OAAO,WAAW,MAAM,QAAQ,KAAK,OAAO,CAAC,EAAE,OAAO,CAAC,EAAE,IAAI;AACtF,iBAAK,OAAO,CAAC,EAAE,OAAO,CAAC,EAAE,UAAU;AAAA,UACrC;AAAA,QACF,OAAO;AACL,eAAK,OAAO,QAAQ;AAAA,YAClB,MAAM;AAAA,YACN,KAAK,WAAW;AAAA,YAChB,MAAM,WAAW;AAAA,YACjB,SAAS;AAAA,UACX,CAAC;AAAA,QACH;AAAA,MACF,OAAO;AACL,oBAAY,WAAW;AAAA,MACzB;AAAA,IACF;AACA,gBAAY,KAAK,OAAO,MAAM,KAAK,QAAQ,CAAC,CAAC,KAAK,KAAK;AACvD,WAAO,OAAO,QAAQ;AAAA;AAAA,EAExB;AAAA,EACA,SAAS,EAAE,QAAQ,GAAG;AACpB,WAAO,aAAa,UAAU,gBAAgB,MAAM;AAAA,EACtD;AAAA,EACA,UAAU,EAAE,OAAO,GAAG;AACpB,WAAO,MAAM,KAAK,OAAO,YAAY,MAAM,CAAC;AAAA;AAAA,EAE9C;AAAA,EACA,MAAM,OAAO;AACX,QAAI,SAAS;AACb,QAAI,OAAO;AACX,aAAS,IAAI,GAAG,IAAI,MAAM,OAAO,QAAQ,KAAK;AAC5C,cAAQ,KAAK,UAAU,MAAM,OAAO,CAAC,CAAC;AAAA,IACxC;AACA,cAAU,KAAK,SAAS,EAAE,MAAM,KAAK,CAAC;AACtC,QAAI,OAAO;AACX,aAAS,IAAI,GAAG,IAAI,MAAM,KAAK,QAAQ,KAAK;AAC1C,YAAM,MAAM,MAAM,KAAK,CAAC;AACxB,aAAO;AACP,eAAS,IAAI,GAAG,IAAI,IAAI,QAAQ,KAAK;AACnC,gBAAQ,KAAK,UAAU,IAAI,CAAC,CAAC;AAAA,MAC/B;AACA,cAAQ,KAAK,SAAS,EAAE,MAAM,KAAK,CAAC;AAAA,IACtC;AACA,QAAI,KAAM,QAAO,UAAU,IAAI;AAC/B,WAAO,uBAAuB,SAAS,eAAe,OAAO;AAAA,EAC/D;AAAA,EACA,SAAS,EAAE,KAAK,GAAG;AACjB,WAAO;AAAA,EACT,IAAI;AAAA;AAAA,EAEJ;AAAA,EACA,UAAU,OAAO;AACf,UAAM,UAAU,KAAK,OAAO,YAAY,MAAM,MAAM;AACpD,UAAM,OAAO,MAAM,SAAS,OAAO;AACnC,UAAM,OAAO,MAAM,QAAQ,IAAI,IAAI,WAAW,MAAM,KAAK,OAAO,IAAI,IAAI;AACxE,WAAO,OAAO,UAAU,KAAK,IAAI;AAAA;AAAA,EAEnC;AAAA;AAAA;AAAA;AAAA,EAIA,OAAO,EAAE,OAAO,GAAG;AACjB,WAAO,WAAW,KAAK,OAAO,YAAY,MAAM,CAAC;AAAA,EACnD;AAAA,EACA,GAAG,EAAE,OAAO,GAAG;AACb,WAAO,OAAO,KAAK,OAAO,YAAY,MAAM,CAAC;AAAA,EAC/C;AAAA,EACA,SAAS,EAAE,KAAK,GAAG;AACjB,WAAO,SAAS,QAAQ,MAAM,IAAI,CAAC;AAAA,EACrC;AAAA,EACA,GAAG,OAAO;AACR,WAAO;AAAA,EACT;AAAA,EACA,IAAI,EAAE,OAAO,GAAG;AACd,WAAO,QAAQ,KAAK,OAAO,YAAY,MAAM,CAAC;AAAA,EAChD;AAAA,EACA,KAAK,EAAE,MAAM,OAAO,OAAO,GAAG;AAC5B,UAAM,OAAO,KAAK,OAAO,YAAY,MAAM;AAC3C,UAAM,YAAY,SAAS,IAAI;AAC/B,QAAI,cAAc,MAAM;AACtB,aAAO;AAAA,IACT;AACA,WAAO;AACP,QAAI,MAAM,cAAc,OAAO;AAC/B,QAAI,OAAO;AACT,aAAO,aAAa,QAAQ,KAAK,IAAI;AAAA,IACvC;AACA,WAAO,MAAM,OAAO;AACpB,WAAO;AAAA,EACT;AAAA,EACA,MAAM,EAAE,MAAM,OAAO,MAAM,OAAO,GAAG;AACnC,QAAI,QAAQ;AACV,aAAO,KAAK,OAAO,YAAY,QAAQ,KAAK,OAAO,YAAY;AAAA,IACjE;AACA,UAAM,YAAY,SAAS,IAAI;AAC/B,QAAI,cAAc,MAAM;AACtB,aAAO,QAAQ,IAAI;AAAA,IACrB;AACA,WAAO;AACP,QAAI,MAAM,aAAa,IAAI,UAAU,IAAI;AACzC,QAAI,OAAO;AACT,aAAO,WAAW,QAAQ,KAAK,CAAC;AAAA,IAClC;AACA,WAAO;AACP,WAAO;AAAA,EACT;AAAA,EACA,KAAK,OAAO;AACV,WAAO,YAAY,SAAS,MAAM,SAAS,KAAK,OAAO,YAAY,MAAM,MAAM,IAAI,aAAa,SAAS,MAAM,UAAU,MAAM,OAAO,QAAQ,MAAM,IAAI;AAAA,EAC1J;AACF;AAGA,IAAI,gBAAgB,MAAM;AAAA,EAxjD1B,OAwjD0B;AAAA;AAAA;AAAA;AAAA,EAExB,OAAO,EAAE,KAAK,GAAG;AACf,WAAO;AAAA,EACT;AAAA,EACA,GAAG,EAAE,KAAK,GAAG;AACX,WAAO;AAAA,EACT;AAAA,EACA,SAAS,EAAE,KAAK,GAAG;AACjB,WAAO;AAAA,EACT;AAAA,EACA,IAAI,EAAE,KAAK,GAAG;AACZ,WAAO;AAAA,EACT;AAAA,EACA,KAAK,EAAE,KAAK,GAAG;AACb,WAAO;AAAA,EACT;AAAA,EACA,KAAK,EAAE,KAAK,GAAG;AACb,WAAO;AAAA,EACT;AAAA,EACA,KAAK,EAAE,KAAK,GAAG;AACb,WAAO,KAAK;AAAA,EACd;AAAA,EACA,MAAM,EAAE,KAAK,GAAG;AACd,WAAO,KAAK;AAAA,EACd;AAAA,EACA,KAAK;AACH,WAAO;AAAA,EACT;AACF;AAGA,IAAI,UAAU,MAAM,SAAS;AAAA,EAxlD7B,OAwlD6B;AAAA;AAAA;AAAA,EAC3B;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY,UAAU;AACpB,SAAK,UAAU,YAAY;AAC3B,SAAK,QAAQ,WAAW,KAAK,QAAQ,YAAY,IAAI,UAAU;AAC/D,SAAK,WAAW,KAAK,QAAQ;AAC7B,SAAK,SAAS,UAAU,KAAK;AAC7B,SAAK,SAAS,SAAS;AACvB,SAAK,eAAe,IAAI,cAAc;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA,EAIA,OAAO,MAAM,QAAQ,UAAU;AAC7B,UAAM,UAAU,IAAI,SAAS,QAAQ;AACrC,WAAO,QAAQ,MAAM,MAAM;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA,EAIA,OAAO,YAAY,QAAQ,UAAU;AACnC,UAAM,UAAU,IAAI,SAAS,QAAQ;AACrC,WAAO,QAAQ,YAAY,MAAM;AAAA,EACnC;AAAA;AAAA;AAAA;AAAA,EAIA,MAAM,QAAQ,MAAM,MAAM;AACxB,QAAI,MAAM;AACV,aAAS,IAAI,GAAG,IAAI,OAAO,QAAQ,KAAK;AACtC,YAAM,WAAW,OAAO,CAAC;AACzB,UAAI,KAAK,QAAQ,YAAY,YAAY,SAAS,IAAI,GAAG;AACvD,cAAM,eAAe;AACrB,cAAM,MAAM,KAAK,QAAQ,WAAW,UAAU,aAAa,IAAI,EAAE,KAAK,EAAE,QAAQ,KAAK,GAAG,YAAY;AACpG,YAAI,QAAQ,SAAS,CAAC,CAAC,SAAS,MAAM,WAAW,QAAQ,SAAS,cAAc,QAAQ,QAAQ,aAAa,MAAM,EAAE,SAAS,aAAa,IAAI,GAAG;AAChJ,iBAAO,OAAO;AACd;AAAA,QACF;AAAA,MACF;AACA,YAAM,QAAQ;AACd,cAAQ,MAAM,MAAM;AAAA,QAClB,KAAK,SAAS;AACZ,iBAAO,KAAK,SAAS,MAAM,KAAK;AAChC;AAAA,QACF;AAAA,QACA,KAAK,MAAM;AACT,iBAAO,KAAK,SAAS,GAAG,KAAK;AAC7B;AAAA,QACF;AAAA,QACA,KAAK,WAAW;AACd,iBAAO,KAAK,SAAS,QAAQ,KAAK;AAClC;AAAA,QACF;AAAA,QACA,KAAK,QAAQ;AACX,iBAAO,KAAK,SAAS,KAAK,KAAK;AAC/B;AAAA,QACF;AAAA,QACA,KAAK,SAAS;AACZ,iBAAO,KAAK,SAAS,MAAM,KAAK;AAChC;AAAA,QACF;AAAA,QACA,KAAK,cAAc;AACjB,iBAAO,KAAK,SAAS,WAAW,KAAK;AACrC;AAAA,QACF;AAAA,QACA,KAAK,QAAQ;AACX,iBAAO,KAAK,SAAS,KAAK,KAAK;AAC/B;AAAA,QACF;AAAA,QACA,KAAK,QAAQ;AACX,iBAAO,KAAK,SAAS,KAAK,KAAK;AAC/B;AAAA,QACF;AAAA,QACA,KAAK,aAAa;AAChB,iBAAO,KAAK,SAAS,UAAU,KAAK;AACpC;AAAA,QACF;AAAA,QACA,KAAK,QAAQ;AACX,cAAI,YAAY;AAChB,cAAI,OAAO,KAAK,SAAS,KAAK,SAAS;AACvC,iBAAO,IAAI,IAAI,OAAO,UAAU,OAAO,IAAI,CAAC,EAAE,SAAS,QAAQ;AAC7D,wBAAY,OAAO,EAAE,CAAC;AACtB,oBAAQ,OAAO,KAAK,SAAS,KAAK,SAAS;AAAA,UAC7C;AACA,cAAI,KAAK;AACP,mBAAO,KAAK,SAAS,UAAU;AAAA,cAC7B,MAAM;AAAA,cACN,KAAK;AAAA,cACL,MAAM;AAAA,cACN,QAAQ,CAAC,EAAE,MAAM,QAAQ,KAAK,MAAM,MAAM,MAAM,SAAS,KAAK,CAAC;AAAA,YACjE,CAAC;AAAA,UACH,OAAO;AACL,mBAAO;AAAA,UACT;AACA;AAAA,QACF;AAAA,QACA,SAAS;AACP,gBAAM,SAAS,iBAAiB,MAAM,OAAO;AAC7C,cAAI,KAAK,QAAQ,QAAQ;AACvB,oBAAQ,MAAM,MAAM;AACpB,mBAAO;AAAA,UACT,OAAO;AACL,kBAAM,IAAI,MAAM,MAAM;AAAA,UACxB;AAAA,QACF;AAAA,MACF;AAAA,IACF;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAIA,YAAY,QAAQ,WAAW,KAAK,UAAU;AAC5C,QAAI,MAAM;AACV,aAAS,IAAI,GAAG,IAAI,OAAO,QAAQ,KAAK;AACtC,YAAM,WAAW,OAAO,CAAC;AACzB,UAAI,KAAK,QAAQ,YAAY,YAAY,SAAS,IAAI,GAAG;AACvD,cAAM,MAAM,KAAK,QAAQ,WAAW,UAAU,SAAS,IAAI,EAAE,KAAK,EAAE,QAAQ,KAAK,GAAG,QAAQ;AAC5F,YAAI,QAAQ,SAAS,CAAC,CAAC,UAAU,QAAQ,QAAQ,SAAS,UAAU,MAAM,YAAY,MAAM,OAAO,MAAM,EAAE,SAAS,SAAS,IAAI,GAAG;AAClI,iBAAO,OAAO;AACd;AAAA,QACF;AAAA,MACF;AACA,YAAM,QAAQ;AACd,cAAQ,MAAM,MAAM;AAAA,QAClB,KAAK,UAAU;AACb,iBAAO,SAAS,KAAK,KAAK;AAC1B;AAAA,QACF;AAAA,QACA,KAAK,QAAQ;AACX,iBAAO,SAAS,KAAK,KAAK;AAC1B;AAAA,QACF;AAAA,QACA,KAAK,QAAQ;AACX,iBAAO,SAAS,KAAK,KAAK;AAC1B;AAAA,QACF;AAAA,QACA,KAAK,SAAS;AACZ,iBAAO,SAAS,MAAM,KAAK;AAC3B;AAAA,QACF;AAAA,QACA,KAAK,UAAU;AACb,iBAAO,SAAS,OAAO,KAAK;AAC5B;AAAA,QACF;AAAA,QACA,KAAK,MAAM;AACT,iBAAO,SAAS,GAAG,KAAK;AACxB;AAAA,QACF;AAAA,QACA,KAAK,YAAY;AACf,iBAAO,SAAS,SAAS,KAAK;AAC9B;AAAA,QACF;AAAA,QACA,KAAK,MAAM;AACT,iBAAO,SAAS,GAAG,KAAK;AACxB;AAAA,QACF;AAAA,QACA,KAAK,OAAO;AACV,iBAAO,SAAS,IAAI,KAAK;AACzB;AAAA,QACF;AAAA,QACA,KAAK,QAAQ;AACX,iBAAO,SAAS,KAAK,KAAK;AAC1B;AAAA,QACF;AAAA,QACA,SAAS;AACP,gBAAM,SAAS,iBAAiB,MAAM,OAAO;AAC7C,cAAI,KAAK,QAAQ,QAAQ;AACvB,oBAAQ,MAAM,MAAM;AACpB,mBAAO;AAAA,UACT,OAAO;AACL,kBAAM,IAAI,MAAM,MAAM;AAAA,UACxB;AAAA,QACF;AAAA,MACF;AAAA,IACF;AACA,WAAO;AAAA,EACT;AACF;AAGA,IAAI,SAAS,MAAM;AAAA,EA/wDnB,OA+wDmB;AAAA;AAAA;AAAA,EACjB;AAAA,EACA;AAAA,EACA,YAAY,UAAU;AACpB,SAAK,UAAU,YAAY;AAAA,EAC7B;AAAA,EACA,OAAO,mBAAmC,oBAAI,IAAI;AAAA,IAChD;AAAA,IACA;AAAA,IACA;AAAA,EACF,CAAC;AAAA;AAAA;AAAA;AAAA,EAID,WAAW,UAAU;AACnB,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAIA,YAAY,OAAO;AACjB,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAIA,iBAAiB,QAAQ;AACvB,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAIA,eAAe;AACb,WAAO,KAAK,QAAQ,OAAO,MAAM,OAAO;AAAA,EAC1C;AAAA;AAAA;AAAA;AAAA,EAIA,gBAAgB;AACd,WAAO,KAAK,QAAQ,QAAQ,QAAQ,QAAQ;AAAA,EAC9C;AACF;AAGA,IAAI,SAAS,MAAM;AAAA,EA3zDnB,OA2zDmB;AAAA;AAAA;AAAA,EACjB,WAAW,aAAa;AAAA,EACxB,UAAU,KAAK;AAAA,EACf,QAAQ,KAAK,cAAc,IAAI;AAAA,EAC/B,cAAc,KAAK,cAAc,KAAK;AAAA,EACtC,SAAS;AAAA,EACT,WAAW;AAAA,EACX,eAAe;AAAA,EACf,QAAQ;AAAA,EACR,YAAY;AAAA,EACZ,QAAQ;AAAA,EACR,eAAe,MAAM;AACnB,SAAK,IAAI,GAAG,IAAI;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA,EAIA,WAAW,QAAQ,UAAU;AAC3B,QAAI,SAAS,CAAC;AACd,eAAW,SAAS,QAAQ;AAC1B,eAAS,OAAO,OAAO,SAAS,KAAK,MAAM,KAAK,CAAC;AACjD,cAAQ,MAAM,MAAM;AAAA,QAClB,KAAK,SAAS;AACZ,gBAAM,aAAa;AACnB,qBAAW,QAAQ,WAAW,QAAQ;AACpC,qBAAS,OAAO,OAAO,KAAK,WAAW,KAAK,QAAQ,QAAQ,CAAC;AAAA,UAC/D;AACA,qBAAW,OAAO,WAAW,MAAM;AACjC,uBAAW,QAAQ,KAAK;AACtB,uBAAS,OAAO,OAAO,KAAK,WAAW,KAAK,QAAQ,QAAQ,CAAC;AAAA,YAC/D;AAAA,UACF;AACA;AAAA,QACF;AAAA,QACA,KAAK,QAAQ;AACX,gBAAM,YAAY;AAClB,mBAAS,OAAO,OAAO,KAAK,WAAW,UAAU,OAAO,QAAQ,CAAC;AACjE;AAAA,QACF;AAAA,QACA,SAAS;AACP,gBAAM,eAAe;AACrB,cAAI,KAAK,SAAS,YAAY,cAAc,aAAa,IAAI,GAAG;AAC9D,iBAAK,SAAS,WAAW,YAAY,aAAa,IAAI,EAAE,QAAQ,CAAC,gBAAgB;AAC/E,oBAAM,UAAU,aAAa,WAAW,EAAE,KAAK,QAAQ;AACvD,uBAAS,OAAO,OAAO,KAAK,WAAW,SAAS,QAAQ,CAAC;AAAA,YAC3D,CAAC;AAAA,UACH,WAAW,aAAa,QAAQ;AAC9B,qBAAS,OAAO,OAAO,KAAK,WAAW,aAAa,QAAQ,QAAQ,CAAC;AAAA,UACvE;AAAA,QACF;AAAA,MACF;AAAA,IACF;AACA,WAAO;AAAA,EACT;AAAA,EACA,OAAO,MAAM;AACX,UAAM,aAAa,KAAK,SAAS,cAAc,EAAE,WAAW,CAAC,GAAG,aAAa,CAAC,EAAE;AAChF,SAAK,QAAQ,CAAC,SAAS;AACrB,YAAM,OAAO,EAAE,GAAG,KAAK;AACvB,WAAK,QAAQ,KAAK,SAAS,SAAS,KAAK,SAAS;AAClD,UAAI,KAAK,YAAY;AACnB,aAAK,WAAW,QAAQ,CAAC,QAAQ;AAC/B,cAAI,CAAC,IAAI,MAAM;AACb,kBAAM,IAAI,MAAM,yBAAyB;AAAA,UAC3C;AACA,cAAI,cAAc,KAAK;AACrB,kBAAM,eAAe,WAAW,UAAU,IAAI,IAAI;AAClD,gBAAI,cAAc;AAChB,yBAAW,UAAU,IAAI,IAAI,IAAI,YAAY,OAAO;AAClD,oBAAI,MAAM,IAAI,SAAS,MAAM,MAAM,KAAK;AACxC,oBAAI,QAAQ,OAAO;AACjB,wBAAM,aAAa,MAAM,MAAM,KAAK;AAAA,gBACtC;AACA,uBAAO;AAAA,cACT;AAAA,YACF,OAAO;AACL,yBAAW,UAAU,IAAI,IAAI,IAAI,IAAI;AAAA,YACvC;AAAA,UACF;AACA,cAAI,eAAe,KAAK;AACtB,gBAAI,CAAC,IAAI,SAAS,IAAI,UAAU,WAAW,IAAI,UAAU,UAAU;AACjE,oBAAM,IAAI,MAAM,6CAA6C;AAAA,YAC/D;AACA,kBAAM,WAAW,WAAW,IAAI,KAAK;AACrC,gBAAI,UAAU;AACZ,uBAAS,QAAQ,IAAI,SAAS;AAAA,YAChC,OAAO;AACL,yBAAW,IAAI,KAAK,IAAI,CAAC,IAAI,SAAS;AAAA,YACxC;AACA,gBAAI,IAAI,OAAO;AACb,kBAAI,IAAI,UAAU,SAAS;AACzB,oBAAI,WAAW,YAAY;AACzB,6BAAW,WAAW,KAAK,IAAI,KAAK;AAAA,gBACtC,OAAO;AACL,6BAAW,aAAa,CAAC,IAAI,KAAK;AAAA,gBACpC;AAAA,cACF,WAAW,IAAI,UAAU,UAAU;AACjC,oBAAI,WAAW,aAAa;AAC1B,6BAAW,YAAY,KAAK,IAAI,KAAK;AAAA,gBACvC,OAAO;AACL,6BAAW,cAAc,CAAC,IAAI,KAAK;AAAA,gBACrC;AAAA,cACF;AAAA,YACF;AAAA,UACF;AACA,cAAI,iBAAiB,OAAO,IAAI,aAAa;AAC3C,uBAAW,YAAY,IAAI,IAAI,IAAI,IAAI;AAAA,UACzC;AAAA,QACF,CAAC;AACD,aAAK,aAAa;AAAA,MACpB;AACA,UAAI,KAAK,UAAU;AACjB,cAAM,WAAW,KAAK,SAAS,YAAY,IAAI,UAAU,KAAK,QAAQ;AACtE,mBAAW,QAAQ,KAAK,UAAU;AAChC,cAAI,EAAE,QAAQ,WAAW;AACvB,kBAAM,IAAI,MAAM,aAAa,IAAI,kBAAkB;AAAA,UACrD;AACA,cAAI,CAAC,WAAW,QAAQ,EAAE,SAAS,IAAI,GAAG;AACxC;AAAA,UACF;AACA,gBAAM,eAAe;AACrB,gBAAM,eAAe,KAAK,SAAS,YAAY;AAC/C,gBAAM,eAAe,SAAS,YAAY;AAC1C,mBAAS,YAAY,IAAI,IAAI,UAAU;AACrC,gBAAI,MAAM,aAAa,MAAM,UAAU,KAAK;AAC5C,gBAAI,QAAQ,OAAO;AACjB,oBAAM,aAAa,MAAM,UAAU,KAAK;AAAA,YAC1C;AACA,mBAAO,OAAO;AAAA,UAChB;AAAA,QACF;AACA,aAAK,WAAW;AAAA,MAClB;AACA,UAAI,KAAK,WAAW;AAClB,cAAM,YAAY,KAAK,SAAS,aAAa,IAAI,WAAW,KAAK,QAAQ;AACzE,mBAAW,QAAQ,KAAK,WAAW;AACjC,cAAI,EAAE,QAAQ,YAAY;AACxB,kBAAM,IAAI,MAAM,cAAc,IAAI,kBAAkB;AAAA,UACtD;AACA,cAAI,CAAC,WAAW,SAAS,OAAO,EAAE,SAAS,IAAI,GAAG;AAChD;AAAA,UACF;AACA,gBAAM,gBAAgB;AACtB,gBAAM,gBAAgB,KAAK,UAAU,aAAa;AAClD,gBAAM,gBAAgB,UAAU,aAAa;AAC7C,oBAAU,aAAa,IAAI,IAAI,UAAU;AACvC,gBAAI,MAAM,cAAc,MAAM,WAAW,KAAK;AAC9C,gBAAI,QAAQ,OAAO;AACjB,oBAAM,cAAc,MAAM,WAAW,KAAK;AAAA,YAC5C;AACA,mBAAO;AAAA,UACT;AAAA,QACF;AACA,aAAK,YAAY;AAAA,MACnB;AACA,UAAI,KAAK,OAAO;AACd,cAAM,QAAQ,KAAK,SAAS,SAAS,IAAI,OAAO;AAChD,mBAAW,QAAQ,KAAK,OAAO;AAC7B,cAAI,EAAE,QAAQ,QAAQ;AACpB,kBAAM,IAAI,MAAM,SAAS,IAAI,kBAAkB;AAAA,UACjD;AACA,cAAI,CAAC,WAAW,OAAO,EAAE,SAAS,IAAI,GAAG;AACvC;AAAA,UACF;AACA,gBAAM,YAAY;AAClB,gBAAM,YAAY,KAAK,MAAM,SAAS;AACtC,gBAAM,WAAW,MAAM,SAAS;AAChC,cAAI,OAAO,iBAAiB,IAAI,IAAI,GAAG;AACrC,kBAAM,SAAS,IAAI,CAAC,QAAQ;AAC1B,kBAAI,KAAK,SAAS,OAAO;AACvB,uBAAO,QAAQ,QAAQ,UAAU,KAAK,OAAO,GAAG,CAAC,EAAE,KAAK,CAAC,SAAS;AAChE,yBAAO,SAAS,KAAK,OAAO,IAAI;AAAA,gBAClC,CAAC;AAAA,cACH;AACA,oBAAM,MAAM,UAAU,KAAK,OAAO,GAAG;AACrC,qBAAO,SAAS,KAAK,OAAO,GAAG;AAAA,YACjC;AAAA,UACF,OAAO;AACL,kBAAM,SAAS,IAAI,IAAI,UAAU;AAC/B,kBAAI,MAAM,UAAU,MAAM,OAAO,KAAK;AACtC,kBAAI,QAAQ,OAAO;AACjB,sBAAM,SAAS,MAAM,OAAO,KAAK;AAAA,cACnC;AACA,qBAAO;AAAA,YACT;AAAA,UACF;AAAA,QACF;AACA,aAAK,QAAQ;AAAA,MACf;AACA,UAAI,KAAK,YAAY;AACnB,cAAM,cAAc,KAAK,SAAS;AAClC,cAAM,iBAAiB,KAAK;AAC5B,aAAK,aAAa,SAAS,OAAO;AAChC,cAAI,SAAS,CAAC;AACd,iBAAO,KAAK,eAAe,KAAK,MAAM,KAAK,CAAC;AAC5C,cAAI,aAAa;AACf,qBAAS,OAAO,OAAO,YAAY,KAAK,MAAM,KAAK,CAAC;AAAA,UACtD;AACA,iBAAO;AAAA,QACT;AAAA,MACF;AACA,WAAK,WAAW,EAAE,GAAG,KAAK,UAAU,GAAG,KAAK;AAAA,IAC9C,CAAC;AACD,WAAO;AAAA,EACT;AAAA,EACA,WAAW,KAAK;AACd,SAAK,WAAW,EAAE,GAAG,KAAK,UAAU,GAAG,IAAI;AAC3C,WAAO;AAAA,EACT;AAAA,EACA,MAAM,KAAK,UAAU;AACnB,WAAO,OAAO,IAAI,KAAK,YAAY,KAAK,QAAQ;AAAA,EAClD;AAAA,EACA,OAAO,QAAQ,UAAU;AACvB,WAAO,QAAQ,MAAM,QAAQ,YAAY,KAAK,QAAQ;AAAA,EACxD;AAAA,EACA,cAAc,WAAW;AACvB,UAAM,SAAS,wBAAC,KAAK,aAAa;AAChC,YAAM,UAAU,EAAE,GAAG,SAAS;AAC9B,YAAM,MAAM,EAAE,GAAG,KAAK,UAAU,GAAG,QAAQ;AAC3C,YAAM,aAAa,KAAK,QAAQ,CAAC,CAAC,IAAI,QAAQ,CAAC,CAAC,IAAI,KAAK;AACzD,UAAI,KAAK,SAAS,UAAU,QAAQ,QAAQ,UAAU,OAAO;AAC3D,eAAO,WAAW,IAAI,MAAM,oIAAoI,CAAC;AAAA,MACnK;AACA,UAAI,OAAO,QAAQ,eAAe,QAAQ,MAAM;AAC9C,eAAO,WAAW,IAAI,MAAM,gDAAgD,CAAC;AAAA,MAC/E;AACA,UAAI,OAAO,QAAQ,UAAU;AAC3B,eAAO,WAAW,IAAI,MAAM,0CAA0C,OAAO,UAAU,SAAS,KAAK,GAAG,IAAI,mBAAmB,CAAC;AAAA,MAClI;AACA,UAAI,IAAI,OAAO;AACb,YAAI,MAAM,UAAU;AACpB,YAAI,MAAM,QAAQ;AAAA,MACpB;AACA,YAAM,SAAS,IAAI,QAAQ,IAAI,MAAM,aAAa,IAAI,YAAY,OAAO,MAAM,OAAO;AACtF,YAAM,UAAU,IAAI,QAAQ,IAAI,MAAM,cAAc,IAAI,YAAY,QAAQ,QAAQ,QAAQ;AAC5F,UAAI,IAAI,OAAO;AACb,eAAO,QAAQ,QAAQ,IAAI,QAAQ,IAAI,MAAM,WAAW,GAAG,IAAI,GAAG,EAAE,KAAK,CAAC,SAAS,OAAO,MAAM,GAAG,CAAC,EAAE,KAAK,CAAC,WAAW,IAAI,QAAQ,IAAI,MAAM,iBAAiB,MAAM,IAAI,MAAM,EAAE,KAAK,CAAC,WAAW,IAAI,aAAa,QAAQ,IAAI,KAAK,WAAW,QAAQ,IAAI,UAAU,CAAC,EAAE,KAAK,MAAM,MAAM,IAAI,MAAM,EAAE,KAAK,CAAC,WAAW,QAAQ,QAAQ,GAAG,CAAC,EAAE,KAAK,CAAC,UAAU,IAAI,QAAQ,IAAI,MAAM,YAAY,KAAK,IAAI,KAAK,EAAE,MAAM,UAAU;AAAA,MAC/Z;AACA,UAAI;AACF,YAAI,IAAI,OAAO;AACb,gBAAM,IAAI,MAAM,WAAW,GAAG;AAAA,QAChC;AACA,YAAI,SAAS,OAAO,KAAK,GAAG;AAC5B,YAAI,IAAI,OAAO;AACb,mBAAS,IAAI,MAAM,iBAAiB,MAAM;AAAA,QAC5C;AACA,YAAI,IAAI,YAAY;AAClB,eAAK,WAAW,QAAQ,IAAI,UAAU;AAAA,QACxC;AACA,YAAI,QAAQ,QAAQ,QAAQ,GAAG;AAC/B,YAAI,IAAI,OAAO;AACb,kBAAQ,IAAI,MAAM,YAAY,KAAK;AAAA,QACrC;AACA,eAAO;AAAA,MACT,SAAS,GAAG;AACV,eAAO,WAAW,CAAC;AAAA,MACrB;AAAA,IACF,GAzCe;AA0Cf,WAAO;AAAA,EACT;AAAA,EACA,QAAQ,QAAQ,OAAO;AACrB,WAAO,CAAC,MAAM;AACZ,QAAE,WAAW;AACb,UAAI,QAAQ;AACV,cAAM,MAAM,mCAAmC,QAAQ,EAAE,UAAU,IAAI,IAAI,IAAI;AAC/E,YAAI,OAAO;AACT,iBAAO,QAAQ,QAAQ,GAAG;AAAA,QAC5B;AACA,eAAO;AAAA,MACT;AACA,UAAI,OAAO;AACT,eAAO,QAAQ,OAAO,CAAC;AAAA,MACzB;AACA,YAAM;AAAA,IACR;AAAA,EACF;AACF;AAGA,IAAI,iBAAiB,IAAI,OAAO;AAChC,SAAS,OAAO,KAAK,KAAK;AACxB,SAAO,eAAe,MAAM,KAAK,GAAG;AACtC;AAFS;AAGT,OAAO,UAAU,OAAO,aAAa,SAAS,UAAU;AACtD,iBAAe,WAAW,QAAQ;AAClC,SAAO,WAAW,eAAe;AACjC,iBAAe,OAAO,QAAQ;AAC9B,SAAO;AACT;AACA,OAAO,cAAc;AACrB,OAAO,WAAW;AAClB,OAAO,MAAM,YAAY,MAAM;AAC7B,iBAAe,IAAI,GAAG,IAAI;AAC1B,SAAO,WAAW,eAAe;AACjC,iBAAe,OAAO,QAAQ;AAC9B,SAAO;AACT;AACA,OAAO,aAAa,SAAS,QAAQ,UAAU;AAC7C,SAAO,eAAe,WAAW,QAAQ,QAAQ;AACnD;AACA,OAAO,cAAc,eAAe;AACpC,OAAO,SAAS;AAChB,OAAO,SAAS,QAAQ;AACxB,OAAO,WAAW;AAClB,OAAO,eAAe;AACtB,OAAO,QAAQ;AACf,OAAO,QAAQ,OAAO;AACtB,OAAO,YAAY;AACnB,OAAO,QAAQ;AACf,OAAO,QAAQ;AACf,IAAI,UAAU,OAAO;AACrB,IAAI,aAAa,OAAO;AACxB,IAAI,MAAM,OAAO;AACjB,IAAI,aAAa,OAAO;AACxB,IAAI,cAAc,OAAO;AAEzB,IAAI,SAAS,QAAQ;AACrB,IAAI,QAAQ,OAAO;;;AClnEnB,SAAS,+BAA+B,OAAO,SAAS;AACpD,MAAI,WAAW;AAEf,MAAI,CAAC,MAAM,QAAQ,KAAK,KAAK,MAAM,WAAW,GAAG;AAC7C,gBAAY;AACZ,WAAO;AAAA,EACX;AAEA,cAAY;AACZ,QAAM,QAAQ,CAAC,MAAM,UAAU;AAC3B,QAAI,iBAAiB;AACrB,QAAI,SAAS,KAAK;AAGlB,UAAM,mBAAmB,YAAY,KAAK,IAAI;AAG9C,QAAI,oBAAoB,iBAAiB,WAAW,iBAAiB,QAAQ,SAAS,KAAK,iBAAiB,QAAQ,CAAC,EAAE,cAAc;AACjI,uBAAiB,iBAAiB,QAAQ,CAAC,EAAE,aAAa,IAAI;AAAA,IAClE,OAAO;AAEH,uBAAiB,iDAAmB,WAAW,KAAK,IAAI,CAAC,gBAAgB,WAAW,KAAK,SAAS,KAAK,eAAe,KAAK,UAAU,IAAI,CAAC,CAAC;AAAA,IAC/I;AAEA,gBAAY;AAAA;AAAA,qEAEiD,KAAK,IAAI,IAAI,MAAM;AAAA,4CAC5C,cAAc;AAAA;AAAA;AAAA,EAGtD,CAAC;AACD,cAAY;AACZ,SAAO;AACX;AAjCS;AAmCF,SAAS,iCAAiC,KAAK,SAAS,SAAS,gBAAgB;AAEpF,QAAM,OAAO,WAAW,CAAC;AACzB,QAAM,aAAa,MAAM,QAAQ,cAAc,IAAI,iBAAiB,CAAC;AAGrE,QAAM,iBAAiB,WAAW,IAAI,CAAC,UAAU,UAAU;AAAA;AAAA,sDAET,UAAU,IAAI,WAAW,EAAE,8BAA8B,SAAS,EAAE,sDAAsD,SAAS,EAAE,OAAO,WAAW,SAAS,IAAI,CAAC;AAAA;AAAA,KAEtN,EAAE,KAAK,EAAE;AAEV,QAAM,kBAAkB,WAAW,IAAI,CAAC,UAAU,UAAU;AAAA,mBAC7C,SAAS,EAAE,4BAA4B,UAAU,IAAI,WAAW,EAAE;AAAA,cACvE,+BAA+B,KAAK,SAAS,EAAE,GAAG,OAAO,CAAC;AAAA;AAAA,KAEnE,EAAE,KAAK,EAAE;AAEV,SAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAMU,oBAAoB,WAAW,OAAO,CAAC,CAAC,IAAI,IAAI,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8DA+CvB,WAAW,OAAO,CAAC;AAAA;AAAA;AAAA,8BAGnD,oBAAoB,WAAW,OAAO,CAAC,CAAC,IAAI,IAAI,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAUpE,cAAc;AAAA;AAAA,sBAElB,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gDAgDW,IAAI,kBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gEAYN,IAAI,kBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+DAiBvB,IAAI,kBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAwDrF;AA3NgB;AA8NhB,SAAS,kCAAkC,cAAc,YAAY,aAAa,gBAAgB;AAC9F,MAAI,CAAC,gBAAgB,CAAC,WAAY,QAAO;AACzC,MAAI,wBAAwB;AAC5B,MAAI,aAAc,0BAAyB;AAAA,EAAU,YAAY;AAAA;AAAA;AACjE,MAAI,WAAY,0BAAyB;AAAA,EAAU,UAAU;AAC7D,0BAAwB,sBAAsB,KAAK;AAEnD,SAAO;AAAA;AAAA,iFAEsE,WAAW,WAAW,CAAC;AAAA,yHACiB,cAAc;AAAA,mJACY,WAAW,qBAAqB,CAAC;AAAA,qCAC/I,cAAc;AAAA,kBACjC,eAAe,iPAA6N,WAAW,YAAY,CAAC,WAAW,8EAA4B;AAAA,kBAC3S,aAAa,4NAAwM,WAAW,UAAU,CAAC,WAAW,8EAA4B;AAAA;AAAA;AAGpS;AAjBS;AAoBF,SAAS,sBAAsB,KAAK,OAAO,aAAa,UAAU,cAAc,OAAO,yBAAyB,MACtF,WAAW,MAAM,SAAS,MAAM,WAAW,MAAM,SAAS,MAC1D,YAAY,MAAM,UAAU,MAAM,YAAY,MAAM,aAAa,MAAM;AAGpG,MAAI,mBAAmB;AAEvB,MAAI,MAAM,SAAS,gBAAM,KAAK,0BAA0B,MAAM,QAAQ,sBAAsB,KAAK,uBAAuB,SAAS,GAAG;AAChI,uBAAmB;AAAA;AAAA,0DAE+B,WAAW,QAAQ,CAAC;AAAA,kBAC5D,uBAAuB,IAAI,UAAQ,oDAAoD,WAAW,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,CAAC;AAAA,8EACzD,cAAc,6BAAS,0BAAM;AAAA;AAAA,EAEvG,WAES,MAAM,SAAS,gBAAM,KAAK,0BAA0B,MAAM,QAAQ,sBAAsB,KAAK,uBAAuB,SAAS,GAAG;AACrI,uBAAmB;AAAA;AAAA,0DAE+B,WAAW,QAAQ,CAAC;AAAA,kBAC5D,uBAAuB,IAAI,UAAQ,oDAAoD,WAAW,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,CAAC;AAAA,uEAChE,WAAW,8BAA8B,OAAO,CAAC,CAAC;AAAA,8EAC3C,cAAc,6BAAS,0BAAM;AAAA;AAAA;AAAA,EAGvG;AAEA,MAAI,qBAAqB;AACzB,MAAI,4BAA4B;AAChC,MAAI,4BAA4B;AAChC,MAAI,uBAAuB;AAM3B,MAAI,CAAC,aAAa;AACd,QAAI,UAAU,oBAAU,aAAa,SAAS;AAC1C,2BAAqB;AAAA,kEACiC,WAAW,SAAS,CAAC;AAAA,2DAC5B,WAAW,OAAO,CAAC;AAAA,wGAC0B,QAAQ;AAAA,IACxG,WAAW,UAAU,gCAAY,aAAa,WAAW;AACrD,2BAAqB;AAAA,kEACiC,WAAW,SAAS,CAAC;AAAA,6DAC1B,WAAW,SAAS,CAAC;AAAA,wGACsB,QAAQ;AAAA,IACxG;AAAA,EACJ;AAEA,MAAI,UAAU,oBAAU,CAAC,eAAe,cAAc,MAAM;AACxD,gCAA4B;AAAA;AAAA,0DAEsB,WAAW,QAAQ,CAAC;AAAA,gEACd,UAAU;AAAA,kBACxD,uBAAuB,IAAI,UAAQ,oDAAoD,WAAW,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,CAAC;AAAA,uEAChE,WAAW,8BAA8B,WAAW,CAAC,CAAC;AAAA;AAAA;AAGrH,gCAA4B;AAAA,sEACkC,WAAW,8BAA8B,WAAW,CAAC,CAAC;AAAA,0FAClC,WAAW,QAAQ,CAAC;AAAA;AAEtG,2BAAuB;AAAA;AAAA;AAAA,EAG3B;AAEA,MAAI,oBAAoB;AACxB,MAAI,UAAU,oBAAU,MAAM,SAAS,yCAAW,GAAG;AACjD,QAAI,YAAY,QAAQ;AACpB,0BAAoB;AAAA;AAAA;AAAA,sBAGV,kCAAkC,8BAA8B,QAAQ,GAAG,8BAA8B,MAAM,GAAG,gCAAY,OAAO,CAAC;AAAA;AAAA,IAEpJ;AAAA,EACJ,WAAW,UAAU,8BAAU;AAC3B,QAAI,YAAY,QAAQ;AACpB,0BAAoB;AAAA;AAAA;AAAA,sBAGV,kCAAkC,8BAA8B,QAAQ,GAAG,8BAA8B,MAAM,GAAG,kDAAe,OAAO,CAAC;AAAA;AAAA,IAEvJ;AAAA,EACJ;AAEA,SAAO;AAAA;AAAA,qBAEU,WAAW,KAAK,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,iDAKW,cAAc,YAAY,kBAAkB;AAAA;AAAA,sFAEP,cAAc,YAAY,SAAS,uBAAuB,cAAc,YAAY,SAAS,YAAY,cAAc,YAAY,kBAAkB,sGAAsG,cAAc,YAAY,mDAAmD,gBAAgB,cAAc,SAAS,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA,yDAKrZ,cAAc,uBAAuB,mBAAmB,YAAY,cAAc,4BAA4B,OAAO;AAAA,+DAC/G,cAAc,YAAY,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAW5E,WAAW,KAAK,CAAC;AAAA;AAAA,sBAEjB,yBAAyB;AAAA,sBACzB,yBAAyB;AAAA,sBACzB,oBAAoB;AAAA;AAAA;AAAA,+DAGT,oBAAoB,WAAW,QAAQ,CAAC,CAAC;AAAA,2DACf,WAAW;AAAA,2DACX,OAAO,MAAM,kBAAkB,IAAI,WAAW,WAAW,CAAC,CAAC;AAAA,cACxG,iBAAiB;AAAA;AAAA,gDAEiB,mBAAmB,QAAQ,CAAC;AAAA,kBAC1D,gBAAgB;AAAA,kBAChB,kBAAkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA0HpC;AAzPgB;;;ACrRhB,eAAsB,qBAAqB,SAAS,KAAK,gBAAgB;AACrE,QAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,QAAM,YAAY,IAAI,aAAa,IAAI,MAAM;AAC7C,QAAM,UAAU,YAAY,YAAY,WAAW;AACnD,eAAa,OAAO;AACpB,UAAQ,IAAI,kCAAkC,OAAO,EAAE;AAEvD,MAAI;AACA,UAAM,UAAU,CAAC;AAEjB,eAAW,YAAY,gBAAgB;AACnC,cAAQ,SAAS,EAAE,IAAI,MAAM,UAAU,IAAI,SAAS,GAAG,OAAO,IAAI,SAAS,EAAE,EAAE,KAAK,CAAC;AAAA,IACzF;AAEA,UAAMC,QAAO,iCAAiC,KAAK,SAAS,SAAS,cAAc;AAEnF,WAAO,IAAI,SAASA,OAAM,EAAE,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,EAEzF,SAAS,OAAO;AACZ,YAAQ,MAAM,6BAA6B,KAAK;AAEhD,WAAO,IAAI,SAAS,4CAA4C,WAAW,MAAM,OAAO,CAAC,YAAY,WAAW,MAAM,KAAK,CAAC,UAAU;AAAA,MAClI,QAAQ;AAAA,MAAK,SAAS,EAAE,gBAAgB,2BAA2B;AAAA,IACvE,CAAC;AAAA,EACL;AACJ;AAzBsB;;;ACJf,SAAS,sCAAsC;AAClD,SAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaX;AAdgB;;;ACDT,SAAS,wCAAwC;AACpD,SAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWX;AAZgB;;;ACAT,SAAS,sCAAsC,KAAK;AACvD,SAAO;AAAA;AAAA;AAAA;AAAA;AAAA,gGAKU,IAAI,aAAa,uFAAiB,IAAI,WAAW;AAAA;AAEtE;AARgB;AAUT,SAAS,iCAAiC,KAAK;AAClD,SAAO;AAAA;AAAA;AAAA;AAAA,gGAIU,IAAI,aAAa,uFAAiB,IAAI,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBtE;AArBgB;;;ACVT,SAAS,+BAA+B;AAC3C,SAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAmCX;AApCgB;;;ACAT,SAAS,aAAa;AACzB,SAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYX;AAbgB;;;ACAT,SAAS,WAAW;AACvB,SAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBX;AAlBgB;;;ACKhB,eAAsB,cAAc,KAAK,MAAM,SAAS,OAAO,OAAO,MAAM;AACxE,QAAM,eAAe,IAAI;AACzB,QAAM,oBAAoB,IAAI;AAC9B,QAAM,mBAAmB,IAAI;AAE7B,MAAI,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,kBAAkB;AAC1D,YAAQ,MAAM,sGAAsG;AACpH,UAAM,IAAI,MAAM,+DAA+D;AAAA,EACnF;AAEA,QAAM,MAAM,gCAAgC,iBAAiB,IAAI,gBAAgB,GAAG,IAAI;AACxF,QAAM,UAAU;AAAA,IACZ,iBAAiB,UAAU,YAAY;AAAA,IACvC,UAAU;AAAA,IACV,cAAc;AAAA,EAClB;AAEA,MAAI,WAAW,SAAS,WAAW,YAAY,MAAM;AACjD,YAAQ,cAAc,IAAI;AAAA,EAC9B;AAEA,QAAM,WAAW,MAAM,MAAM,KAAK;AAAA,IAC9B;AAAA,IACA;AAAA,IACA,MAAM,OAAO,KAAK,UAAU,IAAI,IAAI;AAAA,EACxC,CAAC;AAED,MAAI,CAAC,SAAS,IAAI;AACd,UAAM,YAAY,MAAM,SAAS,KAAK;AACtC,QAAI,mBAAmB;AACvB,QAAI;AACA,YAAM,YAAY,KAAK,MAAM,SAAS;AACtC,UAAI,aAAa,UAAU,SAAS;AAChC,2BAAmB,UAAU;AAC5B,YAAI,UAAU,QAAQ;AAClB,8BAAoB,aAAa,KAAK,UAAU,UAAU,MAAM,CAAC;AAAA,QACrE;AAAA,MACL;AAAA,IACJ,SAAS,GAAG;AAAA,IAAe;AAC3B,YAAQ,MAAM,qBAAqB,SAAS,MAAM,IAAI,SAAS,UAAU,QAAQ,MAAM,IAAI,GAAG,cAAc,gBAAgB,EAAE;AAC9H,UAAM,IAAI,MAAM,yBAAyB,IAAI,YAAY,SAAS,MAAM,MAAM,gBAAgB,EAAE;AAAA,EACpG;AAEA,MAAI,SAAS,WAAW,OAAO,SAAS,QAAQ,IAAI,gBAAgB,MAAM,KAAK;AAC3E,WAAO;AAAA,EACX;AACA,SAAO,SAAS,KAAK;AACzB;AA/CsB;AAoDtB,eAAsB,iBAAiB,KAAK,UAAU;AAClD,QAAM,gBAAgB,IAAI,iBAAiB;AAC3C,MAAI;AACA,UAAM,OAAO,MAAM,cAAc,KAAK,aAAa,QAAQ,QAAQ,aAAa,EAAE;AAClF,WAAO,QAAQ,KAAK,MAAM,KAAK,MAAM;AAAA,EACzC,SAAS,OAAO;AACZ,QAAI,MAAM,QAAQ,SAAS,KAAK,KAAK,MAAM,QAAQ,YAAY,EAAE,SAAS,WAAW,GAAG;AACpF,cAAQ,IAAI,6BAA6B,QAAQ,aAAa,aAAa,GAAG;AAC9E,aAAO;AAAA,IACX;AACA,YAAQ,MAAM,yBAAyB,QAAQ,KAAK,KAAK;AACzD,UAAM;AAAA,EACV;AACJ;AAbsB;AAkBtB,eAAsB,yBAAyB,KAAK,UAAU,SAAS,eAAe,cAAc,MAAM;AACtG,QAAM,gBAAgB,IAAI,iBAAiB;AAC3C,QAAM,gBAAgB,iBAAiB,OAAO;AAE9C,QAAM,UAAU;AAAA,IACZ,SAAS;AAAA,IACT,SAAS;AAAA,IACT,QAAQ;AAAA,EACZ;AAEA,MAAI,aAAa;AACb,YAAQ,MAAM;AAAA,EAClB;AACA,SAAO,cAAc,KAAK,aAAa,QAAQ,IAAI,OAAO,OAAO;AACrE;AAdsB;AAmBtB,eAAsB,sBAAsB,KAAK,UAAU;AACvD,QAAM,gBAAgB,IAAI,iBAAiB;AAC3C,QAAM,oBAAoB,IAAI;AAC9B,QAAM,mBAAmB,IAAI;AAE7B,MAAI,CAAC,qBAAqB,CAAC,kBAAkB;AACzC,YAAQ,MAAM,wFAAwF;AACtG,UAAM,IAAI,MAAM,+DAA+D;AAAA,EACnF;AAEA,MAAI;AACA,UAAM,OAAO,MAAM,cAAc,KAAK,aAAa,QAAQ,QAAQ,aAAa,EAAE;AAClF,WAAO,iBAAiB,KAAK,OAAO;AAAA,EACxC,SAAS,OAAO;AACZ,YAAQ,MAAM,4CAA4C,QAAQ,KAAK,KAAK;AAC5E,UAAM;AAAA,EACV;AACJ;AAjBsB;AAoBtB,SAAS,iBAAiB,KAAK;AAG3B,MAAI;AACA,WAAO,KAAK,mBAAmB,GAAG,EAAE;AAAA,MAAQ;AAAA,MACxC,gCAAS,aAAa,OAAO,IAAI;AAC7B,eAAO,OAAO,aAAa,OAAO,EAAE;AAAA,MAC5C,GAFI;AAAA,IAEH,CAAC;AAAA,EACN,SAAS,GAAG;AACR,YAAQ,MAAM,0BAA0B,CAAC;AACzC,eAAW,+CAA+C,IAAI;AAC9D,WAAO;AAAA,EACX;AACJ;AAbS;AAgBT,SAAS,iBAAiB,KAAK;AAC3B,MAAI;AAEA,WAAO,mBAAmB,KAAK,GAAG,EAAE,MAAM,EAAE,EAAE,IAAI,SAAS,GAAG;AAC1D,aAAO,OAAO,OAAO,EAAE,WAAW,CAAC,EAAE,SAAS,EAAE,GAAG,MAAM,EAAE;AAAA,IAC/D,CAAC,EAAE,KAAK,EAAE,CAAC;AAAA,EACf,SAAQ,GAAG;AACP,YAAQ,MAAM,0BAA0B,CAAC;AACzC,eAAW,qDAAqD,IAAI;AACpE,WAAO;AAAA,EACX;AACJ;AAXS;;;ACnHT,eAAsB,yBAAyB,SAAS,KAAK;AACzD,MAAI;AACJ,MAAI,sBAAsB,CAAC;AAC3B,MAAI;AACJ,MAAI,gBAAgB;AAEpB,MAAI,kCAAkC;AACtC,MAAI,4BAA4B;AAChC,MAAI,0BAA0B;AAC9B,MAAI,kBAAkB;AAEtB,MAAI;AACA,eAAW,MAAM,QAAQ,SAAS;AAClC,cAAU,SAAS,IAAI,MAAM;AAC7B,0BAAsB,SAAS,OAAO,eAAe;AACrD,UAAM,aAAa,SAAS,IAAI,YAAY,MAAM;AAElD,QAAI,YAAY;AACZ,YAAM,WAAW,SAAS,OAAO;AACjC,cAAQ,IAAI,2CAAkB,QAAQ,EAAE;AACxC,UAAI;AACA,wBAAgB,MAAM,sBAAsB,KAAK,QAAQ;AACzD,YAAI,CAAC,eAAe;AAChB,gBAAM,IAAI,MAAM,0CAAiB,QAAQ,mDAAW;AAAA,QACxD;AACA,gBAAQ,IAAI,qFAAyB,cAAc,MAAM,EAAE;AAAA,MAC/D,SAAS,OAAO;AACZ,gBAAQ,MAAM,iDAAmB,KAAK,EAAE;AACxC,cAAM,YAAY,sBAAsB,KAAK,sDAAc,2EAAwC,WAAW,MAAM,OAAO,CAAC,OAAO,MAAM,QAAQ,QAAQ,WAAW,MAAM,KAAK,CAAC,WAAW,EAAE,IAAI,SAAS,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,eAAe,IAAI;AACvQ,eAAO,IAAI,SAAS,WAAW,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,MAC3G;AAAA,IACJ,OAAO;AACH,sBAAgB,SAAS,IAAI,mBAAmB;AAAA,IACpD;AAEA,QAAI,CAAC,eAAe;AAChB,YAAM,YAAY,sBAAsB,KAAK,sDAAc,wGAAwG,SAAS,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM,eAAe,IAAI;AACzO,aAAO,IAAI,SAAS,WAAW,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,IAC3G;AAGA,gCAA4B,iCAAiC,GAAG;AAChE,sCAAkC;AAClC,8BAA0B;AAE1B,YAAQ,IAAI,4DAA4D,gCAAgC,MAAM;AAC9G,QAAI;AACA,UAAI,gBAAgB,CAAC;AACrB,uBAAiB,SAAS,kBAAkB,KAAK,iCAAiC,yBAAyB,GAAG;AAC1G,sBAAc,KAAK,KAAK;AAAA,MAC5B;AACA,wBAAkB,cAAc,KAAK,EAAE;AACvC,UAAI,CAAC,mBAAmB,gBAAgB,KAAK,MAAM,GAAI,OAAM,IAAI,MAAM,sDAAsD;AAC7H,wBAAkB,wBAAwB,eAAe;AACzD,cAAQ,IAAI,gEAAgE,gBAAgB,MAAM;AAAA,IACtG,SAAS,OAAO;AACZ,cAAQ,MAAM,kDAAkD,KAAK;AACrE,YAAM,YAAY,sBAAsB,KAAK,gFAAoB,yDAAyD,WAAW,MAAM,OAAO,CAAC,OAAO,MAAM,QAAQ,QAAQ,WAAW,MAAM,KAAK,CAAC,WAAW,EAAE,IAAI,SAAS,MAAM,qBAAqB,MAAM,MAAM,2BAA2B,yBAAyB,MAAM,eAAe,IAAI;AACrV,aAAO,IAAI,SAAS,WAAW,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,IAC3G;AACA,QAAI,qBAAsB;AAAA;AAAA,IAA0C;AACpE,QAAI,yBAAyB,iBAAiB,OAAO;AAAA;AAAA;AACrD,8BAA0B;AAAA;AAAA;AAC1B,QAAI,0BAA2B,2BAA0B;AAAA;AAAA,EAAuC,yBAAyB;AAAA;AAAA;AAAA;AAGzH,QAAI,4BAA4B,sCAAsC,GAAG;AACzE,YAAQ,IAAI,4DAA4D,gCAAgC,MAAM;AAC9G,QAAI;AACA,UAAI,gBAAgB,CAAC;AACrB,uBAAiB,SAAS,kBAAkB,KAAK,iCAAiC,yBAAyB,GAAG;AAC1G,sBAAc,KAAK,KAAK;AAAA,MAC5B;AACA,wBAAkB,cAAc,KAAK,EAAE;AACvC,UAAI,CAAC,mBAAmB,gBAAgB,KAAK,MAAM,GAAI,OAAM,IAAI,MAAM,sDAAsD;AAC7H,wBAAkB,wBAAwB,eAAe;AACzD,cAAQ,IAAI,gEAAgE,gBAAgB,MAAM;AAAA,IACtG,SAAS,OAAO;AACZ,cAAQ,MAAM,kDAAkD,KAAK;AACrE,YAAM,YAAY,sBAAsB,KAAK,gFAAoB,yDAAyD,WAAW,MAAM,OAAO,CAAC,OAAO,MAAM,QAAQ,QAAQ,WAAW,MAAM,KAAK,CAAC,WAAW,EAAE,IAAI,SAAS,MAAM,qBAAqB,MAAM,MAAM,2BAA2B,yBAAyB,MAAM,eAAe,IAAI;AACrV,aAAO,IAAI,SAAS,WAAW,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,IAC3G;AACA,0BAAsB;AAAA;AAAA;AAAA;AAAA,IAAoD;AAC1E,QAAI,0BAA2B,4BAA4B;AAAA;AAAA,IAAS;AAEpE,8BAA0B;AAAA;AAAA;AAC1B,QAAI,0BAA2B,2BAA0B;AAAA;AAAA,EAAuC,yBAAyB;AAAA;AAAA;AAAA;AACzH,QAAI,wBAAyB,2BAA0B;AAAA;AAAA,EAA8C,uBAAuB;AAAA;AAAA;AAAA;AAE5H,QAAI,+BAA+B,KAAK,IAAI,aAAa,IAAI,oBAAoB,OAAO,CAAC;AAAA;AAAA,EAAO,wBAAwB,kBAAkB,CAAC;AAE3I,UAAM,cAAc;AAAA,MAChB;AAAA,MACA;AAAA,MACA,WAAW,kBAAkB;AAAA,MAC7B;AAAA,MAAS;AAAA,MAAO;AAAA,MAChB;AAAA,MAAM;AAAA;AAAA,MACN;AAAA,MAAyB;AAAA,MACzB,8BAA8B,wBAAwB,sBAAsB,CAAC;AAAA,MAC7E;AAAA;AAAA,MACA,8BAA8B,4BAA4B;AAAA,IAC9D;AACA,WAAO,IAAI,SAAS,aAAa,EAAE,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,EAEhG,SAAS,OAAO;AACZ,YAAQ,MAAM,mDAAmD,KAAK;AACtE,UAAM,mBAAmB,WAAW,WAAW;AAC/C,UAAM,wBAAwB,MAAM,QAAQ,mBAAmB,IAAI,sBAAsB,CAAC;AAC1F,UAAM,YAAY,sBAAsB,KAAK,sDAAc,yCAAyC,WAAW,MAAM,OAAO,CAAC,OAAO,MAAM,QAAQ,QAAQ,WAAW,MAAM,KAAK,CAAC,WAAW,EAAE,IAAI,kBAAkB,MAAM,uBAAuB,MAAM,MAAM,2BAA2B,uBAAuB;AAC/S,WAAO,IAAI,SAAS,WAAW,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,EAC3G;AACJ;AA/GsB;AAiHtB,eAAsB,mBAAmB,SAAS,KAAK;AACnD,MAAI;AACJ,MAAI,sBAAsB,CAAC;AAC3B,MAAI;AAEJ,MAAI,8BAA8B;AAClC,MAAI,4BAA4B;AAChC,MAAI,0BAA0B;AAC9B,MAAI,gBAAgB;AAEpB,MAAI;AACA,eAAW,MAAM,QAAQ,SAAS;AAClC,UAAM,YAAY,SAAS,IAAI,MAAM;AACrC,cAAU,YAAY,YAAY,WAAW;AAC7C,0BAAsB,SAAS,OAAO,eAAe;AAErD,QAAI,oBAAoB,WAAW,GAAG;AAClC,YAAM,YAAY,sBAAsB,KAAK,oFAAmB,gGAAgG,SAAS,MAAM,IAAI;AACnL,aAAO,IAAI,SAAS,WAAW,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,IAC3G;AAEA,YAAQ,IAAI,6BAA6B,oBAAoB,MAAM,uCAAuC,OAAO,EAAE;AAEnH,UAAM,iBAAiB,CAAC;AACxB,UAAM,gBAAgB,CAAC;AACvB,eAAW,cAAc,aAAa;AAClC,UAAI,OAAO,eAAe,KAAK,aAAa,UAAU,GAAG;AACrD,sBAAc;AAAA,UACV,UAAU,IAAI,SAAS,GAAG,OAAO,IAAI,UAAU,EAAE,EAAE,KAAK,UAAQ;AAC5D,2BAAe,UAAU,IAAI,QAAQ,CAAC;AAAA,UAC1C,CAAC;AAAA,QACL;AAAA,MACJ;AAAA,IACJ;AACA,UAAM,QAAQ,WAAW,aAAa;AAEtC,UAAM,uBAAuB,CAAC;AAC9B,QAAI,2BAA2B;AAE/B,eAAW,aAAa,qBAAqB;AACzC,YAAM,CAAC,MAAM,KAAK,IAAI,UAAU,MAAM,GAAG;AACzC,YAAM,cAAc,eAAe,IAAI;AACvC,YAAM,OAAO,cAAc,YAAY,KAAK,cAAY,OAAO,SAAS,EAAE,MAAM,KAAK,IAAI;AAEzF,UAAI,MAAM;AACN,YAAI,WAAW;AAGf,gBAAQ,KAAK,MAAM;AAAA,UACf,KAAK;AACD,uBAAW,eAAe,KAAK,KAAK;AAAA,aAAgB,KAAK,cAAc;AAAA,OAAU,KAAK,GAAG;AAAA,mBAAsB,UAAU,KAAK,QAAQ,YAAY,CAAC;AACnJ;AAAA,UACJ,KAAK;AACD,uBAAW,iBAAiB,KAAK,KAAK;AAAA,aAAgB,KAAK,cAAc;AAAA,OAAU,KAAK,GAAG;AAAA,eAAkB,KAAK,WAAW;AAAA,SAAY,KAAK,QAAQ,UAAU;AAChK;AAAA,UACJ,KAAK;AACD,uBAAW,iBAAiB,KAAK,KAAK;AAAA,aAAgB,KAAK,cAAc;AAAA,OAAU,KAAK,GAAG;AAAA,4BAA+B,UAAU,KAAK,QAAQ,YAAY,CAAC;AAC9J;AAAA,UACJ,KAAK;AACD,uBAAW,uBAAuB,KAAK,OAAO,oBAAe,KAAK,cAAc;AAAA,OAAU,KAAK,GAAG;AAAA,WAAc,UAAU,KAAK,QAAQ,YAAY,CAAC;AACpJ;AAAA,UACJ;AAEI,uBAAW,SAAS,KAAK,IAAI;AAAA,SAAY,KAAK,SAAS,KAAK;AAAA,eAAkB,KAAK,eAAe,KAAK;AAAA,OAAU,KAAK,OAAO,KAAK;AAClI,gBAAI,KAAK,eAAgB,aAAY;AAAA,aAAgB,KAAK,cAAc;AACxE,gBAAI,KAAK,OAAQ,aAAY;AAAA,UAAa,KAAK,MAAM;AACrD,gBAAI,KAAK,WAAW,KAAK,QAAQ,aAAc,aAAY;AAAA,WAAc,UAAU,KAAK,QAAQ,YAAY,CAAC;AAC7G;AAAA,QACR;AAEA,YAAI,UAAU;AACV,+BAAqB,KAAK,QAAQ;AAClC;AAAA,QACJ;AAAA,MACJ,OAAO;AACH,gBAAQ,KAAK,sCAAsC,SAAS,YAAY,OAAO,GAAG;AAAA,MACtF;AAAA,IACJ;AAEA,QAAI,6BAA6B,GAAG;AAChC,YAAM,YAAY,sBAAsB,KAAK,0FAAoB,+IAA+I,SAAS,MAAM,mBAAmB;AAClP,aAAO,IAAI,SAAS,WAAW,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,IAC3G;AAqCA,QAAI,gBAAgB;AACpB,QAAIC,6BAA4B,oCAAoC;AACpE,QAAIC,2BAA0B,mBAAiB,qBAAqB,KAAK,gBAAgB,IAAE;AAE3F,YAAQ,IAAI,kEAAkEA,yBAAwB,MAAM;AAC5G,QAAI;AACA,UAAI,kBAAkB,CAAC;AACvB,uBAAiB,SAAS,kBAAkB,KAAKA,0BAAyBD,0BAAyB,GAAG;AAClG,wBAAgB,KAAK,KAAK;AAAA,MAC9B;AACA,sBAAgB,gBAAgB,KAAK,EAAE;AACvC,UAAI,CAAC,iBAAiB,cAAc,KAAK,MAAM,GAAI,OAAM,IAAI,MAAM,8CAA8C;AACjH,sBAAgB,wBAAwB,aAAa;AACrD,cAAQ,IAAI,gEAAgE,cAAc,MAAM;AAAA,IACpG,SAAS,OAAO;AACZ,cAAQ,MAAM,wDAAwD,KAAK;AAC3E,YAAM,YAAY,sBAAsB,KAAK,8DAAiB,uEAAuE,WAAW,MAAM,OAAO,CAAC,OAAO,MAAM,QAAQ,QAAQ,WAAW,MAAM,KAAK,CAAC,WAAW,EAAE,IAAI,SAAS,MAAM,qBAAqBA,4BAA2BC,wBAAuB;AACzT,aAAO,IAAI,SAAS,WAAW,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,IAC3G;AAEA,QAAI,yBAAyB,iBAAiB,OAAO;AAAA;AAAA;AAIrD,8BAA0B;AAAA;AAAA;AAC1B,QAAID,2BAA2B,2BAA0B;AAAA;AAAA,EAAmCA,0BAAyB;AAAA;AAAA;AAAA;AACrH,QAAIC,yBAAyB,2BAA0B;AAAA;AAAA,EAA8CA,wBAAuB;AAAA;AAAA;AAAA;AAE5H,QAAI,8BAA8B,MAAM,IAAI,WAAW,IAAI,oBAAoB,OAAO,CAAC;AAAA;AAAA;AACvF,mCAA+B,OAAM,IAAI,kBAAkB;AAE3D,QAAI,4BAA4B,sCAAsC;AACtE,QAAI,0BAA0B;AAC9B,QAAI,gBAAgB;AACpB,YAAQ,IAAI,kEAAkE,wBAAwB,MAAM;AAC5G,QAAI;AACA,UAAI,kBAAkB,CAAC;AACvB,uBAAiB,SAAS,kBAAkB,KAAK,yBAAyB,yBAAyB,GAAG;AAClG,wBAAgB,KAAK,KAAK;AAAA,MAC9B;AACA,sBAAgB,gBAAgB,KAAK,EAAE;AACvC,UAAI,CAAC,iBAAiB,cAAc,KAAK,MAAM,GAAI,OAAM,IAAI,MAAM,8CAA8C;AACjH,sBAAgB,wBAAwB,aAAa;AACrD,cAAQ,IAAI,gEAAgE,cAAc,MAAM;AAAA,IACpG,SAAS,OAAO;AACZ,cAAQ,MAAM,wDAAwD,KAAK;AAC3E,YAAM,YAAY,sBAAsB,KAAK,wDAAgB,uEAAuE,WAAW,MAAM,OAAO,CAAC,OAAO,MAAM,QAAQ,QAAQ,WAAW,MAAM,KAAK,CAAC,WAAW,EAAE,IAAI,SAAS,MAAM,qBAAqB,2BAA2B,uBAAuB;AACxT,aAAO,IAAI,SAAS,WAAW,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,IAC3G;AACA,mCAA+B,kDAA8B,gBAAgB;AAC7E,QAAI,IAAI,aAAW,OAAQ,gCAA+B,SAAS,IAAG;AAAA;AAEtE,mCAA+B;AAAA;AAAA,EAAO,wBAAwB,aAAa,CAAC;AAC5E,QAAI,IAAI,eAAa,OAAQ,gCAA+B,WAAW,IAAG;AAAA;AAAA;AAE1E,UAAM,cAAc;AAAA,MAChB;AAAA,MACA;AAAA;AAAA,MACA,WAAW,2BAA2B;AAAA,MACtC;AAAA,MAAS;AAAA,MAAO;AAAA,MAChBD;AAAA,MAA2BC;AAAA,MAC3B;AAAA,MAAM;AAAA;AAAA,MACN,8BAA8B,wBAAwB,sBAAsB,CAAC;AAAA,MAC7E,8BAA8B,2BAA2B;AAAA,MACzD;AAAA;AAAA,IACJ;AACA,WAAO,IAAI,SAAS,aAAa,EAAE,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,EAEhG,SAAS,OAAO;AACZ,YAAQ,MAAM,6CAA6C,KAAK;AAChE,UAAM,mBAAmB,WAAW,WAAW;AAC/C,UAAM,wBAAwB,MAAM,QAAQ,mBAAmB,IAAI,sBAAsB,CAAC;AAC1F,UAAM,YAAY,sBAAsB,KAAK,0CAAY,yCAAyC,WAAW,MAAM,OAAO,CAAC,OAAO,MAAM,QAAQ,QAAQ,WAAW,MAAM,KAAK,CAAC,WAAW,EAAE,IAAI,kBAAkB,MAAM,uBAAuB,2BAA2B,uBAAuB;AACjS,WAAO,IAAI,SAAS,WAAW,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,EAC3G;AACJ;AAlMsB;AAoMtB,eAAsB,yBAAyB,SAAS,KAAK;AACzD,MAAI;AACJ,MAAI,8BAA8B;AAClC,MAAI,oCAAoC;AACxC,MAAI,kBAAkB;AAEtB,MAAI;AACA,UAAM,cAAc,MAAM,QAAQ,KAAK;AACvC,cAAU,YAAY,QAAQ,WAAW;AACzC,UAAM,oBAAoB,YAAY;AAEtC,QAAI,CAAC,qBAAqB,CAAC,kBAAkB,KAAK,GAAG;AACjD,aAAO,IAAI,SAAS,4EAAgB,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,4BAA4B,EAAE,CAAC;AAAA,IACjH;AAEA,kCAA8B;AAE9B,YAAQ,IAAI,0CAA0C,OAAO,4BAA4B;AACzF,wCAAoC,6BAA6B;AAEjE,YAAQ,IAAI,sDAAsD,4BAA4B,MAAM;AACpG,QAAI;AACA,UAAI,iBAAiB,CAAC;AACtB,uBAAiB,SAAS,kBAAkB,KAAK,6BAA6B,iCAAiC,GAAG;AAC9G,uBAAe,KAAK,KAAK;AAAA,MAC7B;AACA,wBAAkB,eAAe,KAAK,EAAE;AACxC,UAAI,CAAC,mBAAmB,gBAAgB,KAAK,MAAM,GAAI,OAAM,IAAI,MAAM,kDAAkD;AACzH,wBAAkB,wBAAwB,eAAe;AACzD,cAAQ,IAAI,mDAAmD,gBAAgB,MAAM;AAAA,IACzF,SAAS,OAAO;AACZ,cAAQ,MAAM,4CAA4C,KAAK;AAC/D,aAAO,IAAI,SAAS,4CAAc,WAAW,MAAM,OAAO,CAAC,IAAI,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,4BAA4B,EAAE,CAAC;AAAA,IAC5I;AAEA,WAAO,IAAI,SAAS,iBAAiB,EAAE,SAAS,EAAE,gBAAgB,4BAA4B,EAAE,CAAC;AAAA,EAErG,SAAS,OAAO;AACZ,YAAQ,MAAM,mDAAmD,KAAK;AACtE,WAAO,IAAI,SAAS,mCAAU,WAAW,MAAM,OAAO,CAAC,IAAI,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,4BAA4B,EAAE,CAAC;AAAA,EACxI;AACJ;AAzCsB;;;AC/TtB,eAAsB,qBAAqB,SAAS,KAAK;AACrD,MAAI;AACJ,MAAI;AACA,UAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,UAAM,YAAY,IAAI,aAAa,IAAI,MAAM;AAC7C,cAAU,YAAY,YAAY,WAAW;AAE7C,QAAI,8BAA8B,MAAM,IAAI,WAAW,IAAI,oBAAoB,OAAO,CAAC;AAAA;AAAA;AACvF,mCAA+B,OAAM,IAAI,kBAAkB;AAE3D,mCAA+B;AAC/B,QAAI,IAAI,aAAW,OAAQ,gCAA+B,SAAS,IAAG;AAAA;AACtE,QAAI,IAAI,eAAa,OAAQ,gCAA+B,WAAW,IAAG;AAAA;AAAA;AAE1E,UAAM,cAAc;AAAA,MAChB;AAAA,MACA;AAAA;AAAA,MACA,WAAW,2BAA2B;AAAA,MACtC;AAAA,MACA;AAAA;AAAA,MACA,CAAC;AAAA;AAAA,MACD;AAAA,MAAM;AAAA;AAAA,MACN;AAAA,MAAM;AAAA;AAAA,MACN;AAAA;AAAA,MACA,8BAA8B,2BAA2B;AAAA;AAAA,MACzD;AAAA;AAAA,MACA;AAAA;AAAA,IACJ;AACA,WAAO,IAAI,SAAS,aAAa,EAAE,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,EAEhG,SAAS,OAAO;AACZ,YAAQ,MAAM,6BAA6B,KAAK;AAChD,UAAM,mBAAmB,WAAW,WAAW;AAC/C,UAAM,YAAY,sBAAsB,KAAK,sDAAc,yCAAyC,WAAW,MAAM,OAAO,CAAC,OAAO,MAAM,QAAQ,QAAQ,WAAW,MAAM,KAAK,CAAC,WAAW,EAAE,IAAI,kBAAkB,MAAM,CAAC,CAAC;AAC5N,WAAO,IAAI,SAAS,WAAW,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,EAC3G;AACJ;AApCsB;;;ACCtB,eAAsB,qBAAqB,SAAS,KAAK;AACrD,MAAI,QAAQ,WAAW,QAAQ;AAC3B,WAAO,IAAI,SAAS,KAAK,UAAU,EAAE,QAAQ,SAAS,SAAS,qBAAqB,CAAC,GAAG,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,mBAAmB,EAAE,CAAC;AAAA,EAC5J;AACA,MAAI;AACA,UAAM,WAAW,MAAM,QAAQ,SAAS;AACxC,UAAM,UAAU,SAAS,IAAI,MAAM,KAAK,WAAW;AACnD,UAAM,UAAU,SAAS,IAAI,wBAAwB;AACrD,UAAM,YAAY,SAAS,IAAI,yBAAyB;AAGxD,UAAM,gBAAgB,CAAC;AAEvB,QAAI,SAAS;AACT,oBAAc,KAAK,EAAE,MAAM,SAAS,OAAO,OAAO,SAAS,mBAAmB,OAAO,GAAG,aAAa,qBAAqB,CAAC;AAAA,IAC/H;AACA,QAAI,WAAW;AACX,oBAAc,KAAK,EAAE,MAAM,WAAW,OAAO,OAAO,SAAS,WAAW,aAAa,sBAAsB,CAAC;AAAA,IAChH;AAEA,QAAI,cAAc,WAAW,GAAG;AAC5B,YAAM,IAAI,MAAM,iDAAiD;AAAA,IACrE;AAEA,UAAM,UAAU,CAAC;AACjB,eAAW,QAAQ,eAAe;AAC9B,UAAI;AACA,cAAM,cAAc,MAAM,iBAAiB,KAAK,KAAK,IAAI;AACzD,cAAM,gBAAgB,GAAG,cAAc,WAAW,QAAQ,IAAI,KAAK,YAAY,YAAY,CAAC,QAAQ,OAAO;AAC3G,cAAM,yBAAyB,KAAK,KAAK,MAAM,KAAK,SAAS,eAAe,WAAW;AACvF,gBAAQ,KAAK,EAAE,MAAM,KAAK,MAAM,QAAQ,WAAW,SAAS,gBAAgB,cAAc,YAAY,SAAS,IAAI,CAAC;AACpH,gBAAQ,IAAI,6BAA6B,KAAK,IAAI,EAAE;AAAA,MACxD,SAAS,KAAK;AACV,gBAAQ,MAAM,oBAAoB,KAAK,IAAI,eAAe,GAAG;AAC7D,gBAAQ,KAAK,EAAE,MAAM,KAAK,MAAM,QAAQ,UAAU,SAAS,IAAI,QAAQ,CAAC;AAAA,MAC5E;AAAA,IACJ;AAEA,WAAO,IAAI,SAAS,KAAK,UAAU,EAAE,QAAQ,WAAW,MAAM,SAAS,QAAiB,CAAC,GAAG,EAAE,SAAS,EAAE,gBAAgB,kCAAkC,EAAE,CAAC;AAAA,EAElK,SAAS,OAAO;AACZ,YAAQ,MAAM,6BAA6B,KAAK;AAChD,WAAO,IAAI,SAAS,KAAK,UAAU,EAAE,QAAQ,SAAS,SAAS,MAAM,QAAQ,CAAC,GAAG,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,kCAAkC,EAAE,CAAC;AAAA,EACpK;AACJ;AA5CsB;;;ACHtB,SAAS,WAAW,YAAY;AAC9B,MAAI,OAAO,eAAe,UAAU;AAClC,WAAO;AAAA,EACT;AAEA,SAAO,WACJ,QAAQ,UAAU,IAAI,EACtB,KAAK;AACV;AARS;AAgBT,eAAsB,UAAU,SAAS,KAAK;AAC5C,QAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,QAAM,OAAO,SAAS,IAAI,aAAa,IAAI,MAAM,CAAC,KAAK;AAEvD,QAAM,UAAU,CAAC;AACjB,QAAM,QAAQ,gBAAgB;AAE9B,WAAS,IAAI,GAAG,IAAI,MAAM,KAAK;AAC7B,UAAM,OAAO,IAAI,KAAK,KAAK;AAC3B,SAAK,QAAQ,MAAM,QAAQ,IAAI,CAAC;AAChC,UAAM,UAAU,KAAK,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC;AAC/C,UAAM,MAAM,GAAG,OAAO;AACtB,UAAMC,QAAO,MAAM,UAAU,IAAI,SAAS,GAAG;AAC7C,QAAIA,OAAM;AACR,cAAQ,KAAKA,KAAI;AAAA,IACnB;AAAA,EACF;AAGA,QAAM,OAAO,QAAQ,KAAK;AAE1B,MAAI,CAAC,QAAQ,KAAK,WAAW,GAAG;AAC9B,WAAO,IAAI,SAAS,oDAAY,EAAE,QAAQ,IAAI,CAAC;AAAA,EACjD;AAGA,MAAI,WAAW;AACf,MAAI,QAAQ,KAAK,SAAS,GAAG;AAC3B,UAAM,eAAe,CAAC;AACtB,SAAK,QAAQ,UAAQ;AACnB,YAAM,aAAa,KAAK;AACxB,YAAM,gBAAgB,IAAI,KAAK,KAAK,cAAc;AAElD,UAAI,CAAC,aAAa,UAAU,KAAK,gBAAgB,IAAI,KAAK,aAAa,UAAU,EAAE,cAAc,GAAG;AAClG,qBAAa,UAAU,IAAI;AAAA,MAC7B;AAAA,IACF,CAAC;AACD,UAAM,YAAY,OAAO,OAAO,YAAY;AAE5C,cAAU,QAAQ,UAAQ;AACxB,YAAM,UAAU,cAAc,IAAI,KAAK,KAAK,cAAc,CAAC;AAC3D,YAAM,UAAU,WAAW,KAAK,YAAY;AAC5C,YAAM,QAAQ,KAAK,SAAS;AAC5B,YAAMC,QAAO,IAAI,YAAU,KAAK,QAAQ;AACxC,YAAM,cAAc,UAAU,KAAK,YAAY,EAAE,UAAU,GAAG,GAAG;AAEjE,kBAAY;AAAA;AAAA,4BAEU,KAAK;AAAA,kBACfA,KAAI;AAAA,kBACJ,KAAK,MAAMA,KAAI;AAAA,qBACZ,OAAO;AAAA,sCACU,OAAO;AAAA,kCACX,WAAW;AAAA;AAAA;AAAA,IAGzC,CAAC;AAAA,EACH;AAEA,QAAM,UAAU;AAAA;AAAA;AAAA;AAAA,YAIN,IAAI,SAAS;AAAA,2BACH,IAAI;AAAA;AAAA,qBAEL,cAAc,CAAC;AAAA,uBACb,IAAI,MAAM;AAAA,MAC3B,QAAQ;AAAA;AAAA;AAIZ,SAAO,IAAI,SAAS,SAAS;AAAA,IAC3B,SAAS;AAAA,MACP,gBAAgB;AAAA,MAChB,iBAAiB;AAAA;AAAA,IACnB;AAAA,EACF,CAAC;AACH;AA9EsB;;;AClBf,SAAS,iCAAiC;AAC7C,SAAO;AAAA;AAAA;AAAA;AAIX;AALgB;;;ACDT,SAAS,YAAY;AACxB,SAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAyBX;AA1BgB;;;ACchB,eAAsB,yBAAyB,SAAS,KAAK;AACzD,QAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,QAAM,UAAU,IAAI,aAAa,IAAI,MAAM;AAC3C,UAAQ,IAAI,mDAAmD,OAAO,EAAE;AAExE,MAAI,CAAC,SAAS;AACV,YAAQ,MAAM,6CAA6C;AAC3D,WAAO,IAAI,SAAS,0BAA0B,EAAE,QAAQ,IAAI,CAAC;AAAA,EACjE;AAEA,MAAI;AAEA,UAAM,YAAY,SAAS,OAAO;AAClC,YAAQ,IAAI,oEAAoE,SAAS,EAAE;AAC3F,QAAI,UAAU,MAAM,sBAAsB,KAAK,SAAS;AAExD,QAAI,CAAC,SAAS;AACV,cAAQ,KAAK,6CAA6C,SAAS,kBAAkB;AACrF,aAAO,IAAI,SAAS,wBAAwB,SAAS,IAAI,EAAE,QAAQ,IAAI,CAAC;AAAA,IAC5E;AACA,YAAQ,IAAI,2DAA2D,SAAS,qBAAqB,QAAQ,MAAM,EAAE;AAErH,cAAU,6BAA6B,OAAO;AAG9C,UAAM,YAAY,MAAM,kBAAkB,KAAK,OAAO;AAGtD,UAAM,UAAU,OAAO,OAAO;AAC9B,UAAM,cAAc,MAAM,iBAAiB,KAAK,OAAO;AACvD,UAAM,gBAAgB,GAAG,cAAc,WAAW,QAAQ,oBAAoB,OAAO;AACrF,UAAM,yBAAyB,KAAK,SAAS,WAAW,eAAe,WAAW;AAClF,YAAQ,IAAI,iEAAiE,OAAO,EAAE;AAGtF,UAAM,YAAY,QAAQ,UAAU,GAAG,CAAC;AACxC,UAAM,SAAS;AAAA,MACX,aAAa;AAAA,MACb,OAAO,UAAU;AAAA,MACjB,MAAM,MAAM,YAAY,MAAM,UAAU;AAAA,MACxC,kBAAkB;AAAA,MAClB,aAAa;AAAA,MACb,gBAAgB,yBAAyB,oBAAI,KAAK,CAAC;AAAA,IACvD;AAEA,YAAQ,IAAI,qEAAqE,OAAO,qBAAqB,UAAU,MAAM,EAAE;AAE/H,WAAO,IAAI,SAAS,KAAK,UAAU,MAAM,GAAG;AAAA,MACxC,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,MAC9C,QAAQ;AAAA,IACZ,CAAC;AAAA,EACL,SAAS,OAAO;AACZ,YAAQ,MAAM,kDAAkD,MAAM,SAAS,MAAM,KAAK;AAC1F,WAAO,IAAI,SAAS,6BAA6B,MAAM,OAAO,IAAI,EAAE,QAAQ,IAAI,CAAC;AAAA,EACrF;AACJ;AAvDsB;AA+DtB,eAAsB,mBAAmB,SAAS,KAAK;AACnD,QAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,QAAM,UAAU,IAAI,aAAa,IAAI,MAAM;AAC3C,UAAQ,IAAI,6CAA6C,OAAO,EAAE;AAElE,MAAI,CAAC,SAAS;AACV,YAAQ,MAAM,uCAAuC;AACrD,WAAO,IAAI,SAAS,0BAA0B,EAAE,QAAQ,IAAI,CAAC;AAAA,EACjE;AAEA,MAAI;AAEA,UAAM,UAAU,OAAO,OAAO;AAC9B,YAAQ,IAAI,8DAA8D,OAAO,EAAE;AACnF,QAAI,UAAU,MAAM,sBAAsB,KAAK,OAAO;AAEtD,QAAI,CAAC,SAAS;AACV,cAAQ,KAAK,uCAAuC,OAAO,kBAAkB;AAC7E,aAAO,IAAI,SAAS,wBAAwB,OAAO,2CAA2C,EAAE,QAAQ,IAAI,CAAC;AAAA,IACjH;AACA,YAAQ,IAAI,qDAAqD,OAAO,qBAAqB,QAAQ,MAAM,EAAE;AAG7G,UAAM,YAAY,QAAQ,UAAU,GAAG,CAAC;AACxC,UAAM,SAAS;AAAA,MACX,aAAa;AAAA,MACb,OAAO,UAAU;AAAA,MACjB,MAAM,MAAM,YAAY,MAAM,UAAU;AAAA,MACxC,cAAc,OAAO,MAAM,mBAAmB,OAAO,CAAC;AAAA;AAAA,MAEtD,gBAAgB,yBAAyB,oBAAI,KAAK,CAAC;AAAA;AAAA,IACvD;AAEA,UAAM,QAAQ,GAAG,OAAO;AACxB,YAAQ,IAAI,wDAAwD,KAAK,oBAAoB,KAAK,UAAU,MAAM,EAAE,UAAU,GAAG,GAAG,IAAI,KAAK;AAC7I,UAAM,UAAU,IAAI,SAAS,OAAO,MAAM;AAC1C,YAAQ,IAAI,6DAA6D,KAAK,EAAE;AAEhF,WAAO,IAAI,SAAS,KAAK,UAAU,MAAM,GAAG;AAAA,MACxC,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,MAC9C,QAAQ;AAAA,IACZ,CAAC;AAAA,EACL,SAAS,OAAO;AACZ,YAAQ,MAAM,+CAA+C,MAAM,SAAS,MAAM,KAAK;AACvF,WAAO,IAAI,SAAS,gCAAgC,MAAM,OAAO,IAAI,EAAE,QAAQ,IAAI,CAAC;AAAA,EACxF;AACJ;AA9CsB;AAsDf,SAAS,6BAA6B,SAAS;AAClD,QAAM,QAAQ,QAAQ,MAAM,KAAK;AACjC,MAAI,MAAM,SAAS,GAAG;AAElB,QAAI,aAAa,QAAQ,MAAM,MAAM,CAAC,EAAE,KAAK,KAAK;AAClD,UAAM,gBAAgB,WAAW,YAAY,8CAAW;AACxD,QAAI,kBAAkB,IAAI;AACtB,mBAAa,WAAW,UAAU,GAAG,gBAAc,EAAE;AAAA,IACzD;AACA,WAAO;AAAA,EACX;AACA,SAAO;AACX;AAZgB;AAoBT,SAAS,gBAAgB,SAAS,YAAY,KAAK;AACtD,MAAI,CAAC,WAAW,QAAQ,UAAU,WAAW;AACzC,WAAO;AAAA,EACX;AAGA,MAAI,YAAY,QAAQ,UAAU,GAAG,SAAS;AAG9C,QAAM,iBAAiB,UAAU,YAAY,IAAI;AAGjD,MAAI,iBAAiB,YAAY,GAAG;AAChC,gBAAY,QAAQ,UAAU,GAAG,cAAc;AAAA,EACnD;AAGA,eAAa;AAEb,SAAO;AACX;AApBgB;AA+BhB,eAAsB,kBAAkB,KAAK,YAAY;AACrD,UAAQ,IAAI,qDAAqD,WAAW,UAAU,GAAG,GAAG,CAAC,KAAK;AAClG,MAAI;AACA,QAAI,SAAS,MAAM,YAAY,KAAK,YAAY,+BAA+B,CAAC;AAChF,YAAQ,IAAI,0DAA0D,OAAO,MAAM,EAAE;AACrF,aAAS,wBAAwB,MAAM;AAEvC,aAAS,gBAAgB,QAAQ,GAAG;AACpC,cAAU,cAAc,UAAU;AAClC,WAAO;AAAA,EACX,SAAS,OAAO;AACZ,YAAQ,MAAM,+CAA+C,MAAM,SAAS,MAAM,KAAK;AACvF,UAAM,IAAI,MAAM,kCAAkC,MAAM,OAAO,EAAE;AAAA,EACrE;AACJ;AAdsB;;;ACnLtB,IAAM,sBAAsB;AAC5B,IAAM,6BAA6B,KAAK;AAGxC,SAAS,kBAAkB,aAAa;AACpC,SAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kEA+BuD,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAkC7E;AAlES;AAqET,SAAS,iBAAiB,WAAW;AACjC,QAAM,iBAAiB,IAAI,KAAK,KAAK,IAAI,IAAI,6BAA6B,GAAI;AAC9E,SAAO,GAAG,mBAAmB,IAAI,SAAS,qBAAqB,eAAe,YAAY,CAAC;AAC/F;AAHS;AAMT,eAAe,YAAY,SAAS,KAAK;AACrC,MAAI,QAAQ,WAAW,OAAO;AAC1B,UAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,UAAM,cAAc,IAAI,aAAa,IAAI,UAAU,KAAK;AACxD,WAAO,IAAI,SAAS,kBAAkB,WAAW,GAAG;AAAA,MAChD,SAAS,EAAE,gBAAgB,2BAA2B;AAAA,IAC1D,CAAC;AAAA,EACL,WAAW,QAAQ,WAAW,QAAQ;AAClC,UAAM,WAAW,MAAM,QAAQ,SAAS;AACxC,UAAM,WAAW,SAAS,IAAI,UAAU;AACxC,UAAM,WAAW,SAAS,IAAI,UAAU;AACxC,UAAM,WAAW,SAAS,IAAI,UAAU,KAAK;AAE7C,QAAI,aAAa,IAAI,kBAAkB,aAAa,IAAI,gBAAgB;AACpE,YAAM,YAAY,OAAO,WAAW;AAGpC,YAAM,UAAU,IAAI,SAAS,WAAW,SAAS,IAAI,SAAS,0BAA0B;AAExF,YAAM,SAAS,iBAAiB,SAAS;AAEzC,aAAO,IAAI,SAAS,oBAAoB;AAAA,QACpC,QAAQ;AAAA,QACR,SAAS;AAAA,UACL,cAAc;AAAA,UACd,kBAAkB;AAAA;AAAA,QACtB;AAAA,MACJ,CAAC;AAAA,IACL,OAAO;AACH,aAAO,IAAI,SAAS,gCAAgC,EAAE,QAAQ,IAAI,CAAC;AAAA,IACvE;AAAA,EACJ;AACA,SAAO,IAAI,SAAS,sBAAsB,EAAE,QAAQ,IAAI,CAAC;AAC7D;AAjCe;AAoCf,eAAe,gBAAgB,SAAS,KAAK;AACzC,QAAM,eAAe,QAAQ,QAAQ,IAAI,QAAQ;AACjD,MAAI,CAAC,cAAc;AACf,WAAO,EAAE,eAAe,OAAO,QAAQ,KAAK;AAAA,EAChD;AAEA,QAAM,UAAU,aAAa,MAAM,GAAG,EAAE,IAAI,OAAK,EAAE,KAAK,CAAC;AACzD,QAAM,gBAAgB,QAAQ,KAAK,YAAU,OAAO,WAAW,GAAG,mBAAmB,GAAG,CAAC;AAEzF,MAAI,CAAC,eAAe;AAChB,WAAO,EAAE,eAAe,OAAO,QAAQ,KAAK;AAAA,EAChD;AAEA,QAAM,YAAY,cAAc,MAAM,GAAG,EAAE,CAAC;AAG5C,QAAM,gBAAgB,MAAM,UAAU,IAAI,SAAS,WAAW,SAAS,EAAE;AACzE,MAAI,kBAAkB,SAAS;AAC3B,WAAO,EAAE,eAAe,OAAO,QAAQ,KAAK;AAAA,EAChD;AAGA,QAAM,UAAU,IAAI,SAAS,WAAW,SAAS,IAAI,SAAS,0BAA0B;AAExF,QAAM,YAAY,iBAAiB,SAAS;AAC5C,SAAO,EAAE,eAAe,MAAM,QAAQ,UAAU;AACpD;AA1Be;AA6Bf,eAAe,aAAa,SAAS,KAAK;AACtC,QAAM,eAAe,QAAQ,QAAQ,IAAI,QAAQ;AACjD,MAAI,cAAc;AACd,UAAM,UAAU,aAAa,MAAM,GAAG,EAAE,IAAI,OAAK,EAAE,KAAK,CAAC;AACzD,UAAM,gBAAgB,QAAQ,KAAK,CAAAC,YAAUA,QAAO,WAAW,GAAG,mBAAmB,GAAG,CAAC;AACzF,QAAI,eAAe;AACf,YAAM,YAAY,cAAc,MAAM,GAAG,EAAE,CAAC;AAE5C,YAAM,IAAI,QAAQ,OAAO,WAAW,SAAS,EAAE;AAAA,IACnD;AAAA,EACJ;AAEA,QAAM,cAAc,oBAAI,KAAK,CAAC;AAC9B,QAAM,SAAS,GAAG,mBAAmB,sBAAsB,YAAY,YAAY,CAAC;AAEpF,QAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,QAAM,cAAc,IAAI,aAAa,IAAI,UAAU,KAAK;AAExD,SAAO,IAAI,SAAS,cAAc;AAAA,IAC9B,QAAQ;AAAA,IACR,SAAS;AAAA,MACL,cAAc;AAAA,MACd,YAAY;AAAA,IAChB;AAAA,EACJ,CAAC;AACL;AAzBe;;;ACvIf,IAAO,cAAQ;AAAA,EACX,MAAM,MAAM,SAAS,KAAK;AAEtB,UAAM,kBAAkB;AAAA,MACpB;AAAA,MAAW;AAAA,MAAkB;AAAA,MAAkB;AAAA,MAAwB;AAAA,MAAkB;AAAA,MACzF;AAAA,MAAgB;AAAA,MAAqB;AAAA,MAAmB;AAAA,MACxD;AAAA,MAAkB;AAAA,MAClB;AAAA,MAAgB;AAAA,MAAgB;AAAA,MAChC;AAAA,MAAqB;AAAA,MAAgB;AAAA,IACzC;AACA,YAAQ,IAAI,GAAG;AACf,UAAM,cAAc,gBAAgB,OAAO,aAAW,CAAC,IAAI,OAAO,CAAC;AAEnE,QAAI,YAAY,SAAS,GAAG;AACxB,cAAQ,MAAM,qDAAqD,YAAY,KAAK,IAAI,CAAC,EAAE;AAC3F,YAAM,YAAY;AAAA;AAAA;AAAA,8EAGgD,YAAY,KAAK,IAAI,CAAC;AAAA;AAExF,aAAO,IAAI,SAAS,WAAW,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,2BAA2B,EAAE,CAAC;AAAA,IAC3G;AAEA,UAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,UAAM,OAAO,IAAI;AACjB,YAAQ,IAAI,qBAAqB,QAAQ,MAAM,IAAI,IAAI,EAAE;AAGzD,QAAI,SAAS,UAAU;AACnB,aAAO,MAAM,YAAY,SAAS,GAAG;AAAA,IACzC,WAAW,SAAS,WAAW;AAC3B,aAAO,MAAM,aAAa,SAAS,GAAG;AAAA,IAC1C,WAAW,SAAS,iBAAiB,QAAQ,WAAW,OAAO;AAC3D,aAAO,MAAM,iBAAiB,SAAS,GAAG;AAAA,IAC9C,WAAW,KAAK,WAAW,MAAM,KAAK,QAAQ,WAAW,OAAO;AAC5D,aAAO,MAAM,UAAU,SAAS,GAAG;AAAA,IACvC,WAAW,SAAS,mBAAmB,QAAQ,WAAW,OAAO;AAC7D,aAAO,MAAM,mBAAmB,SAAS,GAAG;AAAA,IAChD,WAAW,SAAS,yBAAyB,QAAQ,WAAW,OAAO;AACnE,aAAO,MAAM,yBAAyB,SAAS,GAAG;AAAA,IACtD;AAGA,UAAM,EAAE,eAAe,QAAQ,UAAU,IAAI,MAAM,gBAAgB,SAAS,GAAG;AAC/E,QAAI,CAAC,eAAe;AAEhB,YAAM,WAAW,IAAI,IAAI,UAAU,IAAI,MAAM;AAC7C,eAAS,aAAa,IAAI,YAAY,IAAI,WAAW,IAAI,MAAM;AAC/D,aAAO,SAAS,SAAS,SAAS,SAAS,GAAG,GAAG;AAAA,IACrD;AAGA,QAAI;AACJ,QAAI;AACA,UAAI,SAAS,gBAAgB,QAAQ,WAAW,QAAQ;AACpD,mBAAW,MAAM,gBAAgB,SAAS,GAAG;AAAA,MACjD,WAAW,SAAS,qBAAqB,QAAQ,WAAW,OAAO;AAE/D,cAAM,iBAAiB,OAAO,KAAK,WAAW,EAAE,IAAI,UAAQ;AAAA,UACxD,IAAI;AAAA,UACJ,MAAM,YAAY,GAAG,EAAE;AAAA,QAC3B,EAAE;AACF,mBAAW,MAAM,qBAAqB,SAAS,KAAK,cAAc;AAAA,MACtE,WAAW,SAAS,mBAAmB,QAAQ,WAAW,QAAQ;AAC9D,mBAAW,MAAM,mBAAmB,SAAS,GAAG;AAAA,MACpD,WAAW,SAAS,yBAAyB,QAAQ,WAAW,QAAQ;AACpE,mBAAW,MAAM,yBAAyB,SAAS,GAAG;AAAA,MAC1D,WAAW,SAAS,yBAAyB,QAAQ,WAAW,QAAQ;AACpE,mBAAW,MAAM,yBAAyB,SAAS,GAAG;AAAA,MAC1D,WAAW,SAAS,qBAAqB,QAAQ,WAAW,OAAO;AAC/D,mBAAW,MAAM,qBAAqB,SAAS,GAAG;AAAA,MACtD,WAAW,SAAS,qBAAqB,QAAQ,WAAW,QAAQ;AAChE,mBAAW,MAAM,qBAAqB,SAAS,GAAG;AAAA,MACtD,OAAO;AACH,eAAO,IAAI,SAAS,MAAM,EAAE,QAAQ,KAAK,SAAS,EAAC,gBAAgB,4BAA2B,EAAE,CAAC;AAAA,MACrG;AAAA,IACJ,SAAS,GAAG;AACR,cAAQ,MAAM,qCAAqC,CAAC;AACpD,aAAO,IAAI,SAAS,0BAA0B,EAAE,OAAO,IAAI,EAAE,QAAQ,IAAI,CAAC;AAAA,IAC9E;AAGA,QAAI,WAAW;AACX,eAAS,QAAQ,OAAO,cAAc,SAAS;AAAA,IACnD;AACA,WAAO;AAAA,EACX;AACJ;;;ACjGA,IAAM,YAAwB,8BAAO,SAAS,KAAK,MAAM,kBAAkB;AAC1E,MAAI;AACH,WAAO,MAAM,cAAc,KAAK,SAAS,GAAG;AAAA,EAC7C,UAAE;AACD,QAAI;AACH,UAAI,QAAQ,SAAS,QAAQ,CAAC,QAAQ,UAAU;AAC/C,cAAM,SAAS,QAAQ,KAAK,UAAU;AACtC,eAAO,EAAE,MAAM,OAAO,KAAK,GAAG,MAAM;AAAA,QAAC;AAAA,MACtC;AAAA,IACD,SAAS,GAAG;AACX,cAAQ,MAAM,4CAA4C,CAAC;AAAA,IAC5D;AAAA,EACD;AACD,GAb8B;AAe9B,IAAO,6CAAQ;;;ACRf,SAAS,YAAY,GAAmB;AACvC,SAAO;AAAA,IACN,MAAM,GAAG;AAAA,IACT,SAAS,GAAG,WAAW,OAAO,CAAC;AAAA,IAC/B,OAAO,GAAG;AAAA,IACV,OAAO,GAAG,UAAU,SAAY,SAAY,YAAY,EAAE,KAAK;AAAA,EAChE;AACD;AAPS;AAUT,IAAM,YAAwB,8BAAO,SAAS,KAAK,MAAM,kBAAkB;AAC1E,MAAI;AACH,WAAO,MAAM,cAAc,KAAK,SAAS,GAAG;AAAA,EAC7C,SAAS,GAAQ;AAChB,UAAM,QAAQ,YAAY,CAAC;AAC3B,WAAO,SAAS,KAAK,OAAO;AAAA,MAC3B,QAAQ;AAAA,MACR,SAAS,EAAE,+BAA+B,OAAO;AAAA,IAClD,CAAC;AAAA,EACF;AACD,GAV8B;AAY9B,IAAO,2CAAQ;;;ACzBJ,IAAM,mCAAmC;AAAA,EAE9B;AAAA,EAAyB;AAC3C;AACA,IAAO,sCAAQ;;;ACcnB,IAAM,wBAAsC,CAAC;AAKtC,SAAS,uBAAuB,MAAqC;AAC3E,wBAAsB,KAAK,GAAG,KAAK,KAAK,CAAC;AAC1C;AAFgB;AAShB,SAAS,uBACR,SACA,KACA,KACA,UACA,iBACsB;AACtB,QAAM,CAAC,MAAM,GAAG,IAAI,IAAI;AACxB,QAAM,gBAAmC;AAAA,IACxC;AAAA,IACA,KAAK,YAAY,QAAQ;AACxB,aAAO,uBAAuB,YAAY,QAAQ,KAAK,UAAU,IAAI;AAAA,IACtE;AAAA,EACD;AACA,SAAO,KAAK,SAAS,KAAK,KAAK,aAAa;AAC7C;AAfS;AAiBF,SAAS,kBACf,SACA,KACA,KACA,UACA,iBACsB;AACtB,SAAO,uBAAuB,SAAS,KAAK,KAAK,UAAU;AAAA,IAC1D,GAAG;AAAA,IACH;AAAA,EACD,CAAC;AACF;AAXgB;;;AC3ChB,IAAM,iCAAN,MAAM,gCAA8D;AAAA,EAGnE,YACU,eACA,MACT,SACC;AAHQ;AACA;AAGT,SAAK,WAAW;AAAA,EACjB;AAAA,EArBD,OAYoE;AAAA;AAAA;AAAA,EAC1D;AAAA,EAUT,UAAU;AACT,QAAI,EAAE,gBAAgB,kCAAiC;AACtD,YAAM,IAAI,UAAU,oBAAoB;AAAA,IACzC;AAEA,SAAK,SAAS;AAAA,EACf;AACD;AAEA,SAAS,oBAAoB,QAA0C;AAEtE,MACC,qCAAqC,UACrC,iCAAiC,WAAW,GAC3C;AACD,WAAO;AAAA,EACR;AAEA,aAAW,cAAc,kCAAkC;AAC1D,wBAAoB,UAAU;AAAA,EAC/B;AAEA,QAAM,kBAA+C,gCACpD,SACA,KACA,KACC;AACD,QAAI,OAAO,UAAU,QAAW;AAC/B,YAAM,IAAI,MAAM,6CAA6C;AAAA,IAC9D;AACA,WAAO,OAAO,MAAM,SAAS,KAAK,GAAG;AAAA,EACtC,GATqD;AAWrD,SAAO;AAAA,IACN,GAAG;AAAA,IACH,MAAM,SAAS,KAAK,KAAK;AACxB,YAAM,aAAyB,gCAAU,MAAM,MAAM;AACpD,YAAI,SAAS,eAAe,OAAO,cAAc,QAAW;AAC3D,gBAAM,aAAa,IAAI;AAAA,YACtB,KAAK,IAAI;AAAA,YACT,KAAK,QAAQ;AAAA,YACb,MAAM;AAAA,YAAC;AAAA,UACR;AACA,iBAAO,OAAO,UAAU,YAAY,KAAK,GAAG;AAAA,QAC7C;AAAA,MACD,GAT+B;AAU/B,aAAO,kBAAkB,SAAS,KAAK,KAAK,YAAY,eAAe;AAAA,IACxE;AAAA,EACD;AACD;AAxCS;AA0CT,SAAS,qBACR,OAC8B;AAE9B,MACC,qCAAqC,UACrC,iCAAiC,WAAW,GAC3C;AACD,WAAO;AAAA,EACR;AAEA,aAAW,cAAc,kCAAkC;AAC1D,wBAAoB,UAAU;AAAA,EAC/B;AAGA,SAAO,cAAc,MAAM;AAAA,IAC1B,mBAAyE,wBACxE,SACA,KACA,QACI;AACJ,WAAK,MAAM;AACX,WAAK,MAAM;AACX,UAAI,MAAM,UAAU,QAAW;AAC9B,cAAM,IAAI,MAAM,sDAAsD;AAAA,MACvE;AACA,aAAO,MAAM,MAAM,OAAO;AAAA,IAC3B,GAXyE;AAAA,IAazE,cAA0B,wBAAC,MAAM,SAAS;AACzC,UAAI,SAAS,eAAe,MAAM,cAAc,QAAW;AAC1D,cAAM,aAAa,IAAI;AAAA,UACtB,KAAK,IAAI;AAAA,UACT,KAAK,QAAQ;AAAA,UACb,MAAM;AAAA,UAAC;AAAA,QACR;AACA,eAAO,MAAM,UAAU,UAAU;AAAA,MAClC;AAAA,IACD,GAT0B;AAAA,IAW1B,MAAM,SAAwD;AAC7D,aAAO;AAAA,QACN;AAAA,QACA,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,MACN;AAAA,IACD;AAAA,EACD;AACD;AAnDS;AAqDT,IAAI;AACJ,IAAI,OAAO,wCAAU,UAAU;AAC9B,kBAAgB,oBAAoB,mCAAK;AAC1C,WAAW,OAAO,wCAAU,YAAY;AACvC,kBAAgB,qBAAqB,mCAAK;AAC3C;AACA,IAAO,kCAAQ;",
  "names": ["options", "html", "options", "html", "fullPromptForCall2_System", "fullPromptForCall2_User", "data", "link", "cookie"]
}
